webpackJsonp([0],[function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(1),i=n(r),s=a(2),o=n(s),l=a(3),c=n(l),u=a(5),d=n(u),p=a(6),h=n(p),v=a(7),f=n(v),g=a(8),m=n(g),b=a(109),y=n(b);c.default.module("app",[d.default,h.default,f.default,m.default.name]).config(["$translateProvider",function(e){e.translations("en",i.default),e.translations("fr",o.default),e.preferredLanguage("en"),e.useSanitizeValueStrategy("escape"),e.useMissingTranslationHandlerLog()}]).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob):/)}]).directive("onReadFile",["$parse",function(e){return{restrict:"A",scope:!1,link:function(t,a,n){var r=e(n.onReadFile);a.on("change",function(e){var a=new FileReader;a.onload=function(e){t.$apply(function(){r(t,{$fileContent:e.target.result})})},a.readAsText((e.srcElement||e.target).files[0])})}}}]).directive("app",y.default)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={Add:"Add",Administration:"Administration",AdventureAlreadyExists:"The adventure already exists with id '{{ adventure }}'",AdventureDownloaded:"Adventure '{{ adventure }}' is downloaded",Adventure:"Adventure",Adventures:"Adventures","All existing application's data will be erased during the import. Are you sure to import the application data?":"All existing application's data will be erased during the import. Are you sure to import the application data?","Application's data":"Application's data","Application's version":"Application's version","application.description":"ease the resolution of gamebooks","Are you sure to clear the application data?":"Are you sure to clear the application data?","Are you sure to download the selected adventure? Existing games could be non-playable after the update if the new version is not retro-compatible":"Are you sure to download the selected adventure? Existing games could be non-playable after the update if the new version is not retro-compatible","Are you sure to restart the selected game?":"Are you sure to restart the selected game?","Are you sure to remove the character?":"Are you sure to remove the character?","Are you sure to remove the selected adventure?":"Are you sure to remove the selected adventure?","Are you sure to remove the selected game?":"Are you sure to remove the selected game?",attributValueGenerationRule:"{{ dicesQuantity}} dices[{{ min }},{{ max }}] + {{ constant }}","Author(s)":"Author(s)",Back:"Back",Battle:"Battle",Cancel:"Cancel",CannotImportProjectAon:"Cannot import project aon book with url '{{ url }}'","Cannot import adventure":"Cannot import adventure","Cannot import game":"Cannot import game","Change language to en":"Change language to english","Change language to fr":"Changez la langue en français",Characters:"Characters","Choose an action":"Choose an action",Clear:"Clear",Collapse:"Collapse",Constant:"Constant",Continue:"Continue",Create:"Create","Create an adventure":"Create an adventure","Create a game":"Create a game",Credits:"Credits",credit_description_javascript:"language",credit_description_map_image:"map image used as favicon",credit_description_estawebjs:"development stack",credit_description_angularjs:"framework",credit_description_bootstrap:"framework",credit_description_webpack:"module bundler",credit_description_gulp:"build system",credit_description_nodejs:"JavaScript runtime",credit_description_npm:"package manager for nodejs",credit_description_browsersync:"time-saving synchronised browser testing","credit_description_angular-translate":"i18n for AngularJS","credit_description_angular-ui-router":"flexible routing with nested views in AngularJS",credit_description_babel:"JavaScript compiler",credit_description_realfavicongenerator:"favicon generator",credit_description_github:"Online project hosting using Git",credit_description_article_sticky_footer:"article",credit_description_article_responsive_navigation_patterns:"article",Current:"Current","Decrease tree":"Decrease tree",DecrementStatsTitle:"Decrement '{{ stats }}'","Delete application's data":"Delete application's data",Description:"Description","description.syntax":"Surround paragraph number with § to add a choice (e.g. §123§)",Detail:"Detail",Dices:"Dices",dicesQuantity:"Quantity of dices[{{ min }},{{ max }}]",Display:"Display","Display actions":"Display actions","Display more paragraphs":"Display more paragraphs",Download:"Download","Download URL":"Download URL",downloadable_in_list:" (downloadable)",DupplicateParagraph:"The paragraph '{{paragraphNr}}' already exist",Edit:"Edit",en:"English",English:"English","Enable characters with stats":"Enable characters with stats","Enable dices":"Enable dices","Enable map":"Enable map","Enable Go to paragraph":"Enable Go to paragraph",Enemy:"Enemy",Expand:"Expand",Export:"Export",Features:"Features","First paragraph":"First paragraph",fr:"Français","Français":"Français",Game:"Game","Game's rules":"Game's rules","Game's rules paragraph":"Game's rules paragraph",GameAlreadyExists:"The game already exists with id '{{ gameId }}'",General:"General","Go to":"Go to","Go to paragraph":"Go to paragraph",Homepage:"Homepage",Home:"Home",Import:"Import","Imported data":"Imported data",ImportGameFailedMissingFields:"Cannot import game because of missing mandatory fields: '{{ missingMandatoryFields }}'","Increase tree":"Increase tree",IncrementStatsTitle:"Increment '{{ stats }}'",Initial:"Initial",ISBN:"ISBN","Keep on restart":"Keep on restart",Language:"Language",link:"link",Lists:"Lists",Map:"Map","Minimal dice's value":"Minimal dice's value","missing-adventure":"Missing adventure '{{ name }}'","MIT License":"MIT License","Maximal dice's value":"Maximal dice's value",Name:"Name","New character":"New character","New entry":"New entry","New stats":"New stats",Next:"Next",No:"No","No adventure available":"No adventure available","No way further":"No way further",Ok:"Ok",Paragraph:"Paragraph","Paragraph link":"Paragraph link","Paragraph not played yet":"Paragraph not played","Paste the application's data copied from another browser":"Paste the application's data copied from another browser","Please complete mandatory fields":"Please complete mandatory fields","Please fill a value":"Please fill a value","Please fill the name":"Please fill the name","Please fill the name of the stats":"Please fill the name of the stats","Please fill the name of the game":"Please fill the name of the game","Remaining Local's Storage":"Remaining Local's Storage",Remove:"Remove","Remove the character":"Remove the character","Remove the stats":"Remove the stats",Restart:"Restart","Roll dice":"Roll dice",Save:"Save","Save changes":"Save changes",Serie:"Serie","sorted alphabetically":"sorted alphabetically","Sum of dices value":"Sum of dices value",Tag:"Tag","The adventure is not available":"The adventure is not available","The application cannot be used because the version of the browser is too old or because it is not possible to save data in 'localStorage'.":"The application cannot be used because the version of the browser is too old or because it is not possible to save data in 'localStorage'.","Used Local's Storage":"Used Local's Storage","Used Local's Storage in Percent":"Used Local's Storage in Percent",Version:"Version","Visible sections":"Visible sections","What must be imported?":"What must be imported?",Yes:"Yes"};t.default=a},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={Add:"Ajoute",Administration:"Administration",AdventureAlreadyExists:"Une aventure existe déjà avec l'id '{{ adventure }}'",AdventureDownloaded:"L'aventure '{{ adventure }}' est téléchargée",Adventure:"Aventure",Adventures:"Aventures","All existing application's data will be erased during the import. Are you sure to import the application data?":"Toutes les données de l'application seront supprimées durant l'importation. Etes-vous certain(e) de vouloir importer les données?","Application's data":"Données de l'application","Application's version":"Version de l'application","application.description":"facilite la résolution de livres-jeux","Are you sure to clear the application data?":"Etes-vous certain(e) de vouloir supprimer les données de l'application?","Are you sure to download the selected adventure? Existing games could be non-playable after the update if the new version is not retro-compatible":"Etes-vous certain(e) de vouloir télécharger l'aventure sélectionnée? Les parties existantes pourraient ne plus être jouable suite à la mise-à-jour si celle-ci ne supporte pas de retro-compatibilité","Are you sure to restart the selected game?":"Etes-vous certain(e) de vouloir recommencer la partie séléectionnée?","Are you sure to remove the character?":"Etes-vous certain(e) de vouloir supprimer le personnage?","Are you sure to remove the selected adventure?":"Etes-vous certain(e) de vouloir supprimer l'aventure sélectionnée?","Are you sure to remove the selected game?":"Etes-vous certain(e) de vouloir supprimer la partie sélectionnée?",attributValueGenerationRule:"{{ dicesQuantity}} dés[{{ min }},{{ max }}] + {{ constant }}","Author(s)":"Auteur(s)",Back:"Retour",Battle:"Combat",Cancel:"Annule",CannotImportProjectAon:"Impossible d'importer le livre du projet aon à l'adresse '{{ url }}'","Cannot import adventure":"Impossible d'importer l'aventure","Cannot import game":"Impossible d'importer la partie","Change language to en":"Change language to english","Change language to fr":"Changez la langue en français",Characters:"Personnages",ChoiceGame:"Sélectionne  le jeu '{{ adventureName }}' du joueur '{{ playerName }}'","Choose an action":"Choisissez une action",ChoosenGame:"Le jeu '{{ adventureName }}' du joueur '{{ playerName }}' est choisi",Clear:"Efface",Collapse:"Collapse",Constant:"Constant",Continue:"Poursuivre",Create:"Crée","Create an adventure":"Crée une aventure","Create a game":"Crée une partie",Credits:"Crédits",credit_description_javascript:"langage",credit_description_map_image:"image de carte utilisée comme favicon",credit_description_estawebjs:"pile de développement",credit_description_angularjs:"framework",credit_description_bootstrap:"framework",credit_description_webpack:"module bundler",credit_description_gulp:"build system",credit_description_nodejs:"JavaScript runtime",credit_description_npm:"package manager pour nodejs",credit_description_browsersync:"time-saving synchronised browser testing","credit_description_angular-translate":"i18n pour AngularJS","credit_description_angular-ui-router":"flexible routing with nested views in AngularJS",credit_description_babel:"compilateur JavaScript",credit_description_realfavicongenerator:"générateur de favicon",credit_description_github:"Online project hosting using Git",credit_description_article_sticky_footer:"article",credit_description_article_responsive_navigation_patterns:"article",Current:"Actuel","Decrease tree":"Réduit l'arborescence",DecrementStatsTitle:"Décrémente '{{ stats }}'","Delete application's data":"Supprime les données de l'application",Description:"Description","description.syntax":"Délimiter un numéro de paragraphe avec § afin de l'ajouter comme choix (p.ex. §123§)",Detail:"Détail",Dices:"Dés",dicesQuantity:"Quantité de dés[{{ min }},{{ max }}]",Display:"Affiche","Display actions":"Affiche actions","Display more paragraphs":"Affiche plus de paragraphes",Download:"Download","Download URL":"URL de download",downloadable_in_list:" (téléchargeable)",DupplicateParagraph:"Le pagraphe '{{paragraphNr}}' existe déjà",Edit:"Edite",en:"English",English:"English","Enable characters with stats":"Active les personnages avec attributs","Enable dices":"Active les dés","Enable Go to paragraph":"Active les sauts de paragraphe","Enable map":"Active la carte",Enemy:"Enemi",Export:"Exporte",Expand:"Expand",Features:"Fonctionnalitées","First paragraph":"Premier paragraphe",fr:"Français","Français":"Français",Game:"Partie","Game's rules":"Règles de jeu","Game's rules paragraph":"Paragraphe des règles du jeu",GameAlreadyExists:"Le jeu existe déjà avec l'id '{{ gameId }}'",General:"Générale","Go to":"Aller au","Go to paragraph":"Aller au paragraphe",Home:"Accueil",Homepage:"Page d'accueil",Import:"Importe","Imported data":"Données importées",ImportGameFailedMissingFields:"Impossible d'importer le jeu car il manque les champs obligatoires suivants: '{{ missingMandatoryFields }}'","Increase tree":"Augmente l'arborescence",IncrementStatsTitle:"Incrémente '{{ stats }}'",Initial:"Initiale",ISBN:"ISBN","Keep on restart":"Garder lors de recommencement",Language:"Langue",link:"lien",Lists:"Listes",Map:"Carte","Minimal dice's value":"Valeur de dé minimale","missing-adventure":"Aventure '{{ name }}' manquante","MIT License":"License MIT","Maximal dice's value":"Valeur de dé maximale",Name:"Nom","New character":"Nouveau personnage","New entry":"Nouvelle entrée","New stats":"Nouvel attribut",Next:"Suivant",No:"Non","No adventure available":"Aucune aventure disponible","No way further":"Cul-de-sac",Ok:"Ok",Paragraph:"Paragraphe","Paragraph link":"Liens du paragraphe","Paragraph not played yet":"Le paragraphe n'a pas encore été jouée","Paste the application's data copied from another browser":"Collez les données de l'application précédent copié depuis une autre navigateur","Please complete mandatory fields":"Veuilliez compléter les champs obligatoires","Please fill a value":"Veuilliez saisir une valeur","Please fill the name":"Veuilliez saisir le nom","Please fill the quantity of dices used to generate a value for this stats":"Veuilliez saisir la quantié de dés utilisée pour générer la valeu de cet attribut","Please fill the name of the stats":"Veuilliez saisir le nom de cet attribut","Please fill a default value of this stats for characters":"Veuilliez saisir une valeur par défaut pour les personnages","Please do not fill a default value as this stats is not available for characters":"Veuilliez ne pas saisir une valeur par défaut pour les ennemis comme cet attribut n'est pas disponible pour les personnages","Please fill the name of the game":"Veuilliez saisir le nom de la partie","Remaining Local's Storage":"Local's Storage disponible",Remove:"Supprime","Remove the character":"Supprime le caractère","Remove the stats":"Supprime l'attribut",Restart:"Recommence","Roll dice":"Lance un dé",Save:"Sauvegarde","Save changes":"Sauvegarde les changements",Serie:"Série","sorted alphabetically":"triés alphabétiquement","Sum of dices value":"Somme des dés",Tag:"Tag","The adventure is not available":"L'aventure n'est pas disponible","The application cannot be used because the version of the browser is too old or because it is not possible to save data in 'localStorage'.":"L'application ne peut pas être utilisée car la version du navigateur est trop ancien ou qu'il n'est pas possible de sauver dans le 'localStorage'.","Used Local's Storage":"Local's Storage utilisé","Used Local's Storage in Percent":"Local's Storage utilisé en pourcent","Visible sections":"Sections visibles",Version:"Version","What must be imported?":"Qu'est-ce qui doit être importé?",Yes:"Oui"};t.default=a},,,,,function(e,t,a){var n,r;/*!
	 * angular-translate - v2.13.1 - 2016-12-06
	 * 
	 * Copyright (c) 2016 The angular-translate team, Pascal Precht; Licensed MIT
	 */
!function(a,i){n=[],r=function(){return i()}.apply(t,n),!(void 0!==r&&(e.exports=r))}(this,function(){function e(e){"use strict";return function(t){e.warn("Translation for "+t+" doesn't exist")}}return e.$inject=["$log"],angular.module("pascalprecht.translate").factory("$translateMissingTranslationHandlerLog",e),e.displayName="$translateMissingTranslationHandlerLog","pascalprecht.translate"})},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(9),o=n(s),l=a(89),c=n(l),u=a(108),d=n(u),p=i.default.module("app.components",[d.default.name,c.default.name,o.default.name]);t.default=p},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(10),o=n(s),l=a(65),c=n(l),u=i.default.module("app.components.gui",[o.default.name,c.default.name]);t.default=u},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(11),o=n(s),l=a(14),c=n(l),u=a(18),d=n(u),p=a(22),h=n(p),v=a(25),f=n(v),g=a(29),m=n(g),b=a(32),y=n(b),S=a(39),P=n(S),k=a(42),w=n(k),$=a(45),_=n($),C=a(48),A=n(C),x=a(51),D=n(x),I=a(54),M=n(I),j=a(57),O=n(j),E=a(62),G=n(E),N=i.default.module("app.components.gui.components",[o.default.name,c.default.name,d.default.name,h.default.name,f.default.name,m.default.name,y.default.name,P.default.name,w.default.name,_.default.name,A.default.name,D.default.name,M.default.name,O.default.name,G.default.name]);t.default=N},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(12),o=n(s),l=a(13),c=n(l),u=i.default.module("app.components.gui.components.dices",[]).component("dices",{template:o.default,controller:c.default,bindings:{gameId:"@"}});t.default=u},function(e,t){e.exports='<div class="row">\n    <div class="col-lg-12">\n        <div class="input-group">\n            <span class="input-group-btn">\n                <button class="btn btn-default"\n                        ng-click="$ctrl.rollDice()"\n                        aria-label="{{ \'Roll dice\' | translate }}"\n                        title="{{ \'Roll dice\' | translate }}">\n                    {{ \'Roll dice\' | translate }} {{ \'[\' + $ctrl.min + \',\' + $ctrl.max + \']\' }}\n                </button>\n                <button type="button"\n                        class="btn btn-default"\n                        ng-click="$ctrl.clear()">\n                    {{ \'Clear\' | translate }}\n                </button>\n            </span>\n            <label class="form-control" >{{ $ctrl.dicesValue }}</label>\n        </div>\n    </div>\n</div>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r){a(this,e),this.dicesService=t,this.gamePersistenceService=n,this.adventurePersistenceService=r,this.initData(),this.clear()}return e.$inject=["dicesService","gamePersistenceService","adventurePersistenceService"],n(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(decodeURIComponent(this.gameId)),t=this.adventurePersistenceService.getAdventure(e.adventureId);t.dice&&(this.min=t.dice.min,this.max=t.dice.max)}},{key:"rollDice",value:function(){this.appendToResult(this.dicesService.rollDices(1,this.min,this.max))}},{key:"clear",value:function(){this.dicesValue=""}},{key:"appendToResult",value:function(e){""!==this.dicesValue&&(this.dicesValue=this.dicesValue+","),this.dicesValue=this.dicesValue+e}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(15),o=n(s),l=a(16),c=n(l),u=a(17),d=n(u),p=i.default.module("app.components.gui.components.messages",[]).service("messagesService",o.default).component("messages",{template:c.default,controller:d.default});t.default=p},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n){a(this,e),this.$rootScope=t,this.$translate=n,this.$rootScope.messages||(this.$rootScope.messages=[])}return e.$inject=["$rootScope","$translate"],n(e,[{key:"getMessages",value:function(){return this.$rootScope.messages||[]}},{key:"clearMessages",value:function(){this.$rootScope.messages.forEach(function(e,t,a){e.keepAfterLocationChange||a.splice(t,1)})}},{key:"removeMessage",value:function(e){this.$rootScope.messages.splice(e,1)}},{key:"successMessage",value:function(e,t){this._addMessage(e,"success",t)}},{key:"errorMessage",value:function(e,t){this._addMessage(e,"error",t)}},{key:"infoMessage",value:function(e,t){this._addMessage(e,"info",t)}},{key:"_addMessage",value:function(e,t,a){this._hasMessage(e,t)||this.$rootScope.messages.push({message:e,type:t,keepAfterLocationChange:a})}},{key:"_hasMessage",value:function(e,t){for(var a=!1,n=0;n<this.$rootScope.messages.length;n++)if(this.$rootScope.messages[n].message===e&&this.$rootScope.messages[n].type===t){a=!0;break}return a}}]),e}();t.default=r},function(e,t){e.exports='<div ng-repeat="msg in $ctrl.messages">\n    <div class="alert alert-{{ msg.type === \'error\' ? \'danger\' : msg.type }}">\n        {{ msg.message }}\n        <a class="close" ng-click="$ctrl.removeMessage($index)">&times;</a>\n    </div>\n</div>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n){var r=this;a(this,e),this.messagesService=t,n.$on("$locationChangeStart",function(){return r.messagesService.clearMessages()}),this.messages=t.getMessages()}return e.$inject=["messagesService","$rootScope"],n(e,[{key:"removeMessage",value:function(e){this.messagesService.removeMessage(e)}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(19),o=n(s),l=a(20),c=n(l),u=a(21),d=n(u),p=i.default.module("app.components.gui.components.popup",[]).component("popup",{template:o.default,controller:c.default,bindings:{config:"@"}}).service("popupService",d.default);t.default=p},function(e,t){e.exports='<div id="{{$ctrl.cfg.id}}" class="modal">\n    <div class="modal-content">\n        <p>{{ $ctrl.cfg.textToDisplay }}</p>\n        <div class="form-group" ng-show="!!$ctrl.cfg.withText">\n            <input type="text" class="form-control" id="text" ng-model="$ctrl.text" ng-required="!!$ctrl.cfg.textRequired">\n        </div>\n        <span ng-repeat="choice in $ctrl.cfg.choices">\n            <button type="button" class="btn btn-default" ng-click="$ctrl.select(choice, $ctrl.text)">{{ choice | translate }}</button>&nbsp;\n        </span>\n    </div>\n</div>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r){a(this,e),this.cfg=JSON.parse(this.config),this.constants=r,this.popupService=t,this.cfg.withoutTranslate?this.cfg.textToDisplay=this.cfg.text:this.cfg.textToDisplay=n.instant(this.cfg.text)}return e.$inject=["popupService","$translate","constants"],n(e,[{key:"select",value:function(e,t){this.cfg.withText&&!t&&e!==this.constants.choices.cancel||this.close(e,t)}},{key:"close",value:function(e,t){this.popupService.close(this.cfg.id,e,t)}}]),e}();t.default=r},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(){a(this,e),this.popups={}}return n(e,[{key:"show",value:function(e,t){var a=window.document.getElementById(e);a.style.display="block",this.popups[e]=t}},{key:"close",value:function(e,t,a){var n=window.document.getElementById(e);n.style.display="none";var r=this.popups[e];r&&r(e,t,a),delete this.popups[e]}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(23),o=n(s),l=a(24),c=n(l),u=i.default.module("app.components.gui.components.back-button",[]).component("backButton",{template:o.default,controller:c.default});t.default=u},function(e,t){e.exports='<button type="button"\n        class="btn btn-default"\n        aria-label="{{ \'Back\' | translate }}"\n        title="{{ \'Back\' | translate }}"\n        ng-click="$ctrl.back()"\n        ng-disabled="$ctrl.isBackDisabled()">\n    {{ \'Back\' | translate }}\n</button>'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n){a(this,e),this.$location=t,this.constants=n}return e.$inject=["$location","constants"],n(e,[{key:"back",value:function(){this.$location.url(this.constants.url.games)}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(26),o=n(s),l=a(27),c=n(l),u=a(28),d=n(u),p=i.default.module("app.components.gui.components.import-data-popup",[]).component("importDataPopup",{template:o.default,controller:c.default,bindings:{config:"<"}}).service("importDataPopupService",d.default);t.default=p},function(e,t){e.exports='<form name="importDataForm" novalidate="novalidate">\n    <div id="{{$ctrl.config.id}}" class="modal">\n        <div class="modal-content">\n            <div class="form-group">\n                <input id="importUpload" type="file" ng-model="$ctrl.uploadFile" on-read-file="$ctrl.showContent($fileContent)" />\n            </div>\n\n            <span ng-repeat="choice in $ctrl.choices">\n                <button type="button" class="btn btn-default" ng-click="$ctrl.select(choice, importDataForm)">{{ choice | translate }}</button>&nbsp;\n            </span>\n        </div>\n    </div>\n</form>'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r){a(this,e),this.constants=n,this.importDataPopupService=t,this.$window=r,this.choices=[n.choices.cancel,n.choices.ok]}return e.$inject=["importDataPopupService","constants","$window"],n(e,[{key:"select",value:function(e,t){if(e===this.constants.choices.cancel)this.close(e);else if(e===this.constants.choices.ok){var a=this.importUploadData;this.close(e,a),this.importUploadData=null}}},{key:"close",value:function(e,t){this.importDataPopupService.close(this.config.id,e,t)}},{key:"showContent",value:function(e){this.importUploadData=e}}]),e}();t.default=r},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t){a(this,e),this.constants=t,this.popups={}}return e.$inject=["constants"],n(e,[{key:"show",value:function(e,t){var a=window.document.getElementById(e);a.style.display="block",this.popups[e]=t}},{key:"close",value:function(e,t,a){var n=window.document.getElementById(e);n.style.display="none";var r=this.popups[e];r&&t===this.constants.choices.ok&&r(e,a),delete this.popups[e]}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(30),o=n(s),l=a(31),c=n(l),u=i.default.module("app.components.gui.components.nodes",[]).component("nodes",{template:o.default,controller:c.default,bindings:{gameId:"<",adventureId:"<",rootParagraphNr:"<"}});t.default=u},function(e,t){e.exports='<ul>\n    <li class="node" ng-if="$ctrl.isDisplayMoreParagraphsButtonAvailable()">\n        <button type="button"\n                class="btn btn-xs btn-default"\n                aria-label="{{ \'Display more paragraphs\' | translate}}"\n                title="{{ \'Display more paragraphs\' | translate}}"\n                ng-click="$ctrl.displayMoreParagraphs()">\n            <span aria-hidden="true">...</span>\n        </button>\n    </li>\n    <li class="node" ng-repeat="path in $ctrl.path">\n        <button type="button" class="btn btn-xs btn-default" ng-click="$ctrl.setRootParagraphNr(path.value)">{{ path.value + (!!path.tag ? \' (\' + path.tag + \')\': \'\') }}</button>\n    </li>\n</ul>\n<ul>\n    <node data="$ctrl.rootNode" root-node="$ctrl.rootNode"></node>\n</ul>\n<li class="node">\n    <button type="button" class="btn btn-xs btn-default"\n            ng-click="$ctrl.increaseTree()">\n        <span aria-hidden="true">{{ \'Increase tree\' | translate }}</span>\n    </button>\n    <button type="button" class="btn btn-xs btn-default"\n            ng-click="$ctrl.decreaseTree()">\n        <span aria-hidden="true">{{ \'Decrease tree\' | translate }}</span>\n    </button>\n</li>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r){a(this,e),this.mapPersistenceService=t,this.gamePersistenceService=n,this.adventurePersistenceService=r,this.initData()}return e.$inject=["mapPersistenceService","gamePersistenceService","adventurePersistenceService"],n(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(this.gameId);0===e.expandedTreeLevels||e.expandedTreeLevels?this.expandedTreeLevels=e.expandedTreeLevels:this.expandedTreeLevels=5,this.setRootParagraphNr(this.rootParagraphNr)}},{key:"getExpandedTreeLevels",value:function(){}},{key:"displayMoreParagraphs",value:function(){this.displayedLastParagraphCount=this.displayedLastParagraphCount+3,this.computeDisplayedLastParagraphs()}},{key:"isDisplayMoreParagraphsButtonAvailable",value:function(){return this.lastParagraphCount-2>=this.displayedLastParagraphCount}},{key:"computeDisplayedLastParagraphs",value:function(){var e=this.gamePersistenceService.getGame(this.gameId);if(this.lastParagraphCount=0,e.path&&e.path.length&&(this.lastParagraphCount=e.path.length-1),this.path=[],!!this.lastParagraphCount>0){var t=0,a=e.path.length-2;this.displayedLastParagraphCount<a&&(t=a-this.displayedLastParagraphCount+1);for(var n=t;n<=a;n++){var r={value:e.path[n]},i=this.adventurePersistenceService.getParagraph(this.adventureId,e.path[n]);i.tag&&(r.tag=i.tag),this.path.push(r)}}}},{key:"collapseAll",value:function(e){this.collapse(e,-1)}},{key:"collapse",value:function(e,t){this.setCollapse(e,t,!0)}},{key:"expand",value:function(e,t){this.setCollapse(e,t,!1)}},{key:"setCollapse",value:function(e,t,a){if(e.children&&(e.collapsed=a,0!==t))for(var n=0;n<e.children.length;n++)this.setCollapse(e.children[n],t-1,a)}},{key:"setRootParagraphNr",value:function(e){this.rootParagraphNr=e,this.displayedLastParagraphCount=5,this.computeDisplayedLastParagraphs(),this.rootNode=this.mapPersistenceService.getMap(this.adventureId,this.rootParagraphNr),this.collapseAll(this.rootNode),this.expand(this.rootNode,this.expandedTreeLevels)}},{key:"increaseTree",value:function(){this.expandedTreeLevels=this.expandedTreeLevels+1,this.setRootParagraphNr(this.rootParagraphNr),this.saveExpandedTreeLevel()}},{key:"decreaseTree",value:function(){this.expandedTreeLevels=this.expandedTreeLevels-1,this.expandedTreeLevels<0&&(this.expandedTreeLevels=0),this.setRootParagraphNr(this.rootParagraphNr),this.saveExpandedTreeLevel()}},{key:"saveExpandedTreeLevel",value:function(){var e=this.gamePersistenceService.getGame(this.gameId);e.expandedTreeLevels=this.expandedTreeLevels,this.gamePersistenceService.updateGame(e)}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(33),o=n(s),l=a(34),c=n(l);a(35);var u=i.default.module("app.components.gui.components.node",[]).component("node",{template:o.default,controller:c.default,bindings:{data:"<",rootNode:"<"}});t.default=u},function(e,t){e.exports='<div id="{{$ctrl.data.id}}" ng-click="$ctrl.click()">\n    <span>\n        {{ $ctrl.data.name + (!!$ctrl.data.tag ? \' (\' + $ctrl.data.tag + \')\': \'\') }}\n    </span>\n    <span class="glyphicon glyphicon-link"\n          aria-label="{{ \'Paragraph link\' | translate }}"\n          title="{{ \'Paragraph link\' | translate }}"\n          ng-show="!!$ctrl.data.linkNodeId">\n    </span>\n    <span class="glyphicon glyphicon-question-sign"\n          aria-label="{{ \'Paragraph not played yet\' | translate }}"\n          title="{{ \'Paragraph not played yet\' | translate }}"\n          ng-show="!!$ctrl.data.unknown">\n    </span>\n    <span class="glyphicon glyphicon-minus-sign"\n          aria-label="{{ \'No way further\' | translate }}"\n          title="{{ \'No way further\' | translate }}"\n          ng-show="!$ctrl.data.children && !!$ctrl.data.linkNodeId && !!$ctrl.data.unknown">\n    </span>\n    <button type="button"\n            class="btn btn-xs btn-default"\n            ng-click="$ctrl.toogleCollapse()"\n            ng-show="!!$ctrl.data.children">\n        {{ (!!$ctrl.data.collapsed ? \'Expand\': \'Collapse\') | translate }}\n    </button>\n</div>\n<div ng-if="!!$ctrl.data.children && !$ctrl.data.collapsed">\n    <ul>\n        <li class="node" ng-repeat="childNode in $ctrl.data.children">\n            <node data="childNode" root-node="$ctrl.rootNode"></node>\n        </li>\n    </ul>\n</div>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(){a(this,e)}return n(e,[{key:"click",value:function(){this.data.children?this.toggleCollapse(this.data):this.data.linkNodeId&&this.expandUpTo(this.data.linkNodeId)}},{key:"expandUpTo",value:function(e){var t=[];this.findNode(this.rootNode,e,t);for(var a=0;a<t.length;a++)t[a].collapsed=!1}},{key:"toggleCollapse",value:function(e){e.children&&(e.collapsed?e.collapsed=!e.collapsed:e.collapsed=!0)}},{key:"findNode",value:function(e,t,a){if(a.push(e),t===e.id)return e;if(e.children)for(var n=0;n<e.children.length;n++){var r=this.findNode(e.children[n],t,a);if(r)return r}var i=a.indexOf(e);return a.splice(i,1),null}}]),e}();t.default=r},function(e,t,a){var n=a(36);"string"==typeof n&&(n=[[e.id,n,""]]);a(38)(n,{});n.locals&&(e.exports=n.locals)},function(e,t,a){t=e.exports=a(37)(),t.push([e.id,"li.node{display:block}",""])},,,function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(40),o=n(s),l=a(41),c=n(l),u=i.default.module("app.components.gui.components.characters",[]).component("characters",{template:o.default,controller:c.default,bindings:{gameId:"<"}});t.default=u},function(e,t){e.exports='<ul>\n    <li ng-repeat="entry in $ctrl.characters">\n        <span ng-show="!entry.edited">{{ entry.name }}</span>\n        <button type="button"\n                class="btn btn-xs btn-default"\n                ng-click="$ctrl.editEntry(entry)"\n                ng-show="!entry.edited">\n            {{ \'Edit\' | translate }}\n        </button>\n        <form name="formCharacter" ng-show="!!entry.edited">\n            <div class="form-group" ng-if="!$ctrl.adventure.id">\n                <label for="name">{{ "Name" | translate }}</label>\n                <input type="text" class="form-control" id="name" ng-model="entry.name" required>\n                <div class="error" ng-show="!entry.name">\n                    {{ \'Please fill the name\' | translate }}\n                </div>\n            </div>\n            <div ng-repeat="stats in entry.stats">\n                <div class="form-group">\n                    <input type="text" class="form-control" ng-model="stats.name" id="{{ stats.name }}" required>\n                    <div class="error" ng-show="!stats.name">\n                        {{ \'Please fill the name of the stats\' | translate }}\n                    </div>\n                    <div class="row">\n                        <div class="col-lg-12">\n                            <div class="input-group">\n                                <input type="number" class="form-control" ng-model="stats.current" id="{{ stats.name }}" required>\n                              <span class="input-group-addon">\n                                <label>/</label>\n                              </span>\n                                <input type="number" class="form-control" ng-model="stats.initial" required>\n                            </div>\n                            <div class="error" ng-show="!stats.current || !stats.initial">\n                                {{ \'Please fill a value\' | translate }}\n                            </div>\n                        </div>\n                    </div>\n                    <button type="button"\n                            class="btn btn-xs btn-danger"\n                            aria-label="{{ \'Remove the stats\' | translate }}"\n                            title="{{ \'Remove the stats\' | translate }}"\n                            ng-click="$ctrl.removeStats(entry, stats)">\n                        {{ \'Remove\' | translate }}\n                    </button>\n                </div>\n            </div>\n        </form>\n        <button type="button"\n                class="btn btn-xs btn-success"\n                ng-click="$ctrl.saveChanges(entry, formCharacter)"\n                ng-show="!!entry.edited">\n            {{ \'Save\' | translate }}\n        </button>\n        <button type="button"\n                class="btn btn-xs btn-danger"\n                ng-click="$ctrl.abortChanges(entry)"\n                ng-show="!!entry.edited">\n            {{ \'Cancel\' | translate }}\n        </button>\n        <button type="button"\n                class="btn btn-xs btn-danger"\n                aria-label="{{ \'Remove the character\' | translate }}"\n                title="{{ \'Remove the character\' | translate }}"\n                ng-click="$ctrl.displayRemovePopup(entry)"\n                ng-show="!!entry.edited">\n            {{ \'Remove\' | translate }}\n        </button>\n\n        <ul>\n            <li ng-repeat="stats in entry.stats">\n                {{ stats.name + \' [\' + stats.current + \'/\' + stats.initial + \']\' }}\n                <button type="button" class="btn btn-xs btn-default"\n                        aria-label="{{ \'IncrementStatsTitle\' | translate: {stats: stats.name} }}"\n                        title="{{ \'IncrementStatsTitle\' | translate: {stats: stats.name} }}"\n                        ng-click="$ctrl.increment(stats)">\n                    <span aria-hidden="true"><b>+</b></span>\n                </button>\n                <button type="button" class="btn btn-xs btn-default"\n                        aria-label="{{ \'DecrementStatsTitle\' | translate: {stats: stats.name} }}"\n                        title="{{ \'DecrementStatsTitle\' | translate: {stats: stats.name} }}"\n                        ng-click="$ctrl.decrement(stats)">\n                    <span aria-hidden="true"><b>-</b></span>\n                </button>\n            </li>\n            <li ng-show="!entry.edited">\n                <input id="newStats" type="text" placeholder="{{ \'New stats\' | translate }}" ng-model="entry.newStats"/>\n                <button type="button"\n                        class="btn btn-xs btn-success"\n                        ng-click="$ctrl.addStats(entry)"\n                        ng-show="!!entry.newStats">\n                    {{ \'Add\' | translate }}\n                </button>\n            </li>\n        </ul>\n    </li>\n    <li>\n        <input id="newEntry" type="text" placeholder="{{ \'New character\' | translate }}" ng-model="$ctrl.newEntry"/>\n        <button type="button"\n                class="btn btn-xs btn-success"\n                ng-click="$ctrl.addEntry()"\n                ng-show="!!$ctrl.newEntry">\n            {{ \'Add\' | translate }}\n        </button>\n    </li>\n</ul>\n\n<popup config="{{ $ctrl.popupDeleteCharacterConfig }}"></popup>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r,i){a(this,e),this.gamePersistenceService=t,this.adventurePersistenceService=n,this.popupService=r,this.constants=i,this.initData(),this.popupDeleteCharacterConfig={id:"popupDeleteCharacter",text:"Are you sure to remove the character?",choices:[i.choices.yes,i.choices.no]}}return e.$inject=["gamePersistenceService","adventurePersistenceService","popupService","constants"],n(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(decodeURIComponent(this.gameId));e.characters?this.characters=e.characters:this.characters=[]}},{key:"addEntry",value:function(){var e=this.createCharacter(this.newEntry);this.characters.push(e),this.newEntry=null,this.save(),this.editEntry(e)}},{key:"addStats",value:function(e){e.stats||(e.stats=[]),e.stats.push({name:e.newStats}),this.editEntry(e)}},{key:"createCharacter",value:function(e){var t={name:e};return t.stats=[],t}},{key:"editEntry",value:function(e){e.edited||(e.edited=!0,e.originalValues={},this.copyCharacter(e,e.originalValues))}},{key:"displayRemovePopup",value:function(e){this.rowToBeRemoved=e;var t=this;this.popupService.show(this.popupDeleteCharacterConfig.id,function(e,a){a===t.constants.choices.yes&&t.removeEntry(t.rowToBeRemoved),t.rowToBeRemoved=null})}},{key:"removeEntry",value:function(e){var t=this.characters.indexOf(e);this.characters.splice(t,1),this.save()}},{key:"removeStats",value:function(e,t){var a=e.stats.indexOf(t);e.stats.splice(a,1)}},{key:"saveChanges",value:function(e,t){t.$invalid||(this.clearEdition(e),this.save())}},{key:"abortChanges",value:function(e){if(this.copyCharacter(e.originalValues,e),e.newStats){for(var t=-1,a=0;a<e.stats.length;a++)if(e.newStats==e.stats[a].name){t=a;break}t!==-1&&e.stats.splice(t,1)}this.clearEdition(e)}},{key:"copyCharacter",value:function(e,t){if(t.name=e.name,e.stats){t.stats=[];for(var a=0;a<e.stats.length;a++)t.stats.push({name:e.stats[a].name,current:e.stats[a].current,initial:e.stats[a].initial})}}},{key:"clearEdition",value:function(e){delete e.originalValues,delete e.edited,e.newStats=null}},{key:"increment",value:function(e){e.current=e.current+1,this.save()}},{key:"decrement",value:function(e){e.current=e.current-1,this.save()}},{key:"save",value:function(){var e=this.gamePersistenceService.getGame(decodeURIComponent(this.gameId));e.characters=this.characters,this.gamePersistenceService.updateGame(e)}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(43),o=n(s),l=a(44),c=n(l),u=i.default.module("app.components.gui.components.list",[]).component("list",{template:o.default,controller:c.default,bindings:{entries:"<",onSave:"&"}});t.default=u},function(e,t){e.exports='<ul>\n    <li ng-repeat="entry in $ctrl.innerEntries">\n        <span ng-show="!entry.edited">{{ entry.value }}</span>\n        <input type="text" ng-model="entry.value" ng-show="!!entry.edited"/>\n        <button type="button"\n                class="btn btn-xs btn-default"\n                ng-click="$ctrl.editEntry(entry)"\n                ng-show="!entry.edited">\n            {{ \'Edit\' | translate }}\n        </button>\n        <button type="button"\n                class="btn btn-xs btn-success"\n                ng-click="$ctrl.saveChanges(entry)"\n                ng-show="!!entry.edited">\n            {{ \'Save\' | translate }}\n        </button>\n        <button type="button"\n                class="btn btn-xs btn-danger"\n                ng-click="$ctrl.abortChanges(entry)"\n                ng-show="!!entry.edited">\n            {{ \'Cancel\' | translate }}\n        </button>\n        <button type="button"\n                class="btn btn-xs btn-danger"\n                ng-click="$ctrl.removeEntry(entry)"\n                ng-show="!!entry.edited">\n            {{ \'Remove\' | translate }}\n        </button>\n    </li>\n    <li>\n        <input id="newEntry" type="text" placeholder="{{ \'New entry\' | translate }}" ng-model="$ctrl.newEntry"/>\n        <button type="button"\n                class="btn btn-xs btn-success"\n                ng-click="$ctrl.addEntry()"\n                ng-show="!!$ctrl.newEntry">\n            {{ \'Add\' | translate }}\n        </button>\n    </li>\n</ul>'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){
for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(){if(a(this,e),this.innerEntries=[],this.entries)for(var t=0;t<this.entries.length;t++)this.innerEntries.push({value:this.entries[t]})}return n(e,[{key:"addEntry",value:function(){this.innerEntries.push({value:this.newEntry}),this.newEntry=null,this.save()}},{key:"editEntry",value:function(e){e.edited||(e.edited=!0,e.originalValue=e.value)}},{key:"removeEntry",value:function(e){var t=this.innerEntries.indexOf(e);this.innerEntries.splice(t,1),this.save()}},{key:"saveChanges",value:function(e){this.clearEdition(e),this.save()}},{key:"abortChanges",value:function(e){e.value=e.originalValue,this.clearEdition(e)}},{key:"clearEdition",value:function(e){delete e.originalValue,delete e.edited}},{key:"save",value:function(){var e=[];if(this.innerEntries)for(var t=0;t<this.innerEntries.length;t++)e.push(this.innerEntries[t].value);this.onSave({entries:e})}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(46),o=n(s),l=a(47),c=n(l),u=i.default.module("app.components.gui.components.description",[]).component("description",{template:o.default,controller:c.default,bindings:{gameId:"<",paragraph:"<"}});t.default=u},function(e,t){e.exports='<div class="row">\n    <div class="col-md-11">\n        <textarea id="inputCurrentDescription" class="form-control" ng-model="$ctrl.paragraph.description" ng-if="!!$ctrl.isDescriptionEditable()" title="{{ \'description.syntax\' | translate }}"></textarea>\n        <div ng-if="!$ctrl.isDescriptionEditable()">\n            <div ng-repeat="paragraph in $ctrl.paragraphs">\n                <ng-repeat ng-repeat="paragraphElement in paragraph">\n                    <button class="btn btn-xs btn-default" ng-if="!!paragraphElement.choice && !!$ctrl.isAlreadyChoosen(paragraphElement.text)" ng-click="$ctrl.goTo(paragraphElement.text)">\n                        {{ paragraphElement.text }}\n                    </button>\n                    <button class="btn btn-xs btn-default" ng-if="!!paragraphElement.choice && !$ctrl.isAlreadyChoosen(paragraphElement.text)" ng-click="$ctrl.goTo(paragraphElement.text)">\n                        <strong>{{ paragraphElement.text }}</strong>\n                    </button>\n                    <ng-if ng-if="!paragraphElement.choice">\n                        {{ paragraphElement.text }}\n                    </ng-if>\n                    <br ng-if="!paragraphElement.text && !paragraphElement.choice" />\n                </ng-repeat>\n            </div>\n        </div>\n    </div>\n    <div class="col-md-1">\n        <button type="button"\n                class="btn btn-xs btn-default"\n                ng-click="$ctrl.editDescription()"\n                ng-show="!$ctrl.isDescriptionEditable()">\n            {{ \'Edit\' | translate }}\n        </button>\n        <button type="button"\n                class="btn btn-xs btn-success"\n                ng-click="$ctrl.saveDescriptionChanges()"\n                ng-show="$ctrl.isDescriptionEditable()">\n            {{ \'Save\' | translate }}\n        </button>\n        <button type="button"\n                class="btn btn-xs btn-danger"\n                ng-click="$ctrl.abortDescriptionChanges()"\n                ng-show="$ctrl.isDescriptionEditable()">\n            {{ \'Cancel\' | translate }}\n        </button>\n    </div>\n</div>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r){a(this,e),this.gamePersistenceService=t,this.adventurePersistenceService=n,this.$location=r,this.initData()}return e.$inject=["gamePersistenceService","adventurePersistenceService","$location"],n(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(this.gameId);this.adventureId=e.adventureId,this.descriptionEditable=!1,this.alreadyChoosen=this.gamePersistenceService.getChoosenChoices(this.gameId,this.paragraph.paragraphNr),this.paragraphs=this.adventurePersistenceService.getDescriptionParagraphs(this.paragraph.description)}},{key:"editDescription",value:function(){this.descriptionEditable=!0,this.originalDescription=this.paragraph.description}},{key:"isDescriptionEditable",value:function(){return this.descriptionEditable}},{key:"saveDescriptionChanges",value:function(){this.originalDescription=null,this.descriptionEditable=!1,this.adventurePersistenceService.updateParagraph(this.adventureId,this.paragraph),this.paragraphs=this.adventurePersistenceService.getDescriptionParagraphs(this.paragraph.description)}},{key:"abortDescriptionChanges",value:function(){this.paragraph.description=this.originalDescription,this.originalDescription=null,this.descriptionEditable=!1}},{key:"goTo",value:function(e){this.gamePersistenceService.setCurrentParagraphNrOfGame(this.gameId,this.paragraph.paragraphNr,e);var t=this.gamePersistenceService.getUrlOfGame(this.gameId);this.$location.url(t)}},{key:"isAlreadyChoosen",value:function(e){return this.alreadyChoosen.indexOf(e)!==-1}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(49),o=n(s),l=a(50),c=n(l),u=i.default.module("app.components.gui.components.goto",[]).component("goto",{template:o.default,controller:c.default,bindings:{gameId:"<",paragraph:"<"}});t.default=u},function(e,t){e.exports='<div class="row" ng-if="!!$ctrl.gotoAvailable">\n    <div class="col-lg-12">\n        <div class="input-group">\n            <span class="input-group-btn">\n                <button class="btn btn-default"\n                        aria-label="{{ \'Go to paragraph\' | translate }}"\n                        title="{{ \'Go to paragraph\' | translate }}"\n                        ng-click="$ctrl.goTo($ctrl.paragraphNrChoice)"\n                        ng-disabled="!$ctrl.paragraphNrChoice">\n                    {{ \'Go to paragraph\' | translate }}\n                </button>\n            </span>\n            <input id="goToParagraphNr" type="text" class="form-control" ng-model="$ctrl.paragraphNrChoice">\n        </div>\n    </div>\n</div>'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r){a(this,e),this.gamePersistenceService=t,this.adventurePersistenceService=n,this.$location=r,this.initData()}return e.$inject=["gamePersistenceService","adventurePersistenceService","$location"],n(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(this.gameId),t=this.adventurePersistenceService.getAdventure(e.adventureId);this.gotoAvailable=!!t.toggles.goto}},{key:"goTo",value:function(e){this.gamePersistenceService.setCurrentParagraphNrOfGame(this.gameId,this.paragraph.paragraphNr,e);var t=this.gamePersistenceService.getUrlOfGame(this.gameId);this.$location.url(t)}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(52),o=n(s),l=a(53),c=n(l),u=i.default.module("app.components.gui.components.collapse",[]).component("collapse",{template:o.default,controller:c.default,transclude:!0,bindings:{title:"@",flag:"@"}});t.default=u},function(e,t){e.exports='<h2>\n    {{ $ctrl.title }}\n    <button type="button"\n            class="btn btn-xs btn-default"\n            ng-click="$ctrl.toogleCollapse()">\n        {{ (!!$ctrl.collapsed ? \'Expand\': \'Collapse\') | translate }}\n    </button>\n</h2>\n<div ng-if="!$ctrl.collapsed" ng-transclude>\n</div>'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r={},i=function(){function e(){a(this,e),r[this.flag]||(r[this.flag]=!1),this.collapsed=!!r[this.flag]}return n(e,[{key:"toogleCollapse",value:function(){this.collapsed=!this.collapsed,r[this.flag]=this.collapsed}}]),e}();t.default=i},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(55),o=n(s),l=a(56),c=n(l),u=i.default.module("app.components.gui.components.selectable-list",[]).component("selectableList",{template:o.default,controller:c.default,bindings:{entries:"="}});t.default=u},function(e,t){e.exports='<ul class="list-unstyled">\n    <li ng-repeat="entry in $ctrl.entries">\n        <div class="checkbox">\n            <label>\n                <input type="checkbox" ng-model="entry.checked">{{ entry.value }}\n            </label>\n        </div>\n    </li>\n</ul>'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function e(){a(this,e)};t.default=n},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(58),o=n(s),l=a(59),c=n(l);a(60);var u=i.default.module("app.components.gui.components.footnote",[]).component("footnote",{template:o.default,controller:c.default});t.default=u},function(e,t){e.exports='<br>\n<footer role="contentinfo">\n    <div class="container">\n        <p class="text-muted">\n            <a href="http://morarupasukaru.github.io/gamebooks-assistant/#">\n                {{ \'Home\' | translate}}\n            </a>\n            -\n            <a ui-sref="credits">\n                {{ \'Credits\' | translate}}\n            </a>\n            -\n            <a href="https://opensource.org/licenses/MIT">\n                {{ \'MIT License\' | translate}}\n            </a>\n            -\n            <a ng-repeat="language in $ctrl.supportedLanguages"\n               href ng-click="$ctrl.changeLanguage(language.code)"\n               aria-label="{{ \'Change language to \' + language.code | translate}}"\n               title="{{ \'Change language to \' + language.code | translate}}">\n                {{ language.code }}\n            </a>\n        </p>\n    </div>\n</footer>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t){a(this,e),this.languagePickerService=t,this.initData()}return e.$inject=["languagePickerService"],n(e,[{key:"initData",value:function(){this.supportedLanguages=this.languagePickerService.getSupportedLanguages(),this.changeLanguage(this.languagePickerService.getSelectedLanguage())}},{key:"changeLanguage",value:function(e){this.language=e,this.languagePickerService.changeLanguage(e)}}]),e}();t.default=r},function(e,t,a){var n=a(61);"string"==typeof n&&(n=[[e.id,n,""]]);a(38)(n,{});n.locals&&(e.exports=n.locals)},function(e,t,a){t=e.exports=a(37)(),t.push([e.id,"html{position:relative;min-height:100%}body{margin:0 0 100px}footer{position:absolute;left:0;bottom:0;height:100px;width:100%}",""])},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(5),o=(n(s),a(63)),l=n(o),c=a(64),u=n(c),d=i.default.module("app.components.gui.components.about",[]).component("about",{template:l.default,controller:u.default});t.default=d},function(e,t){e.exports='<div class="container bg-white" role="main">\n    <h1 class="text-center">Gamebooks Assistant</h1>\n    <div class="text-muted text-center">{{ \'application.description\' | translate }}</div>\n</div>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function e(){a(this,e)};t.default=n},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(66),o=n(s),l=a(69),c=n(l),u=a(76),d=n(u),p=a(79),h=n(p),v=a(82),f=n(v),g=a(86),m=n(g),b=i.default.module("app.components.gui.screens",[o.default.name,c.default.name,d.default.name,f.default.name,m.default.name,h.default.name]);t.default=b},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(5),o=n(s),l=a(67),c=n(l),u=a(68),d=n(u),p=i.default.module("app.components.gui.screen.home",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,a){t.otherwise("/"),e.state("home",{url:"/",template:"<home></home>"})}]).component("home",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports="<messages></messages>\n<main></main>\n<footnote></footnote>\n"},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=["$location","constants",function e(t,n){a(this,e),t.url(n.url.games)}];t.default=n},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(70),o=n(s),l=a(73),c=n(l),u=i.default.module("app.components.gui.screens.games",[o.default.name,c.default.name]);t.default=u},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(5),o=n(s),l=a(71),c=n(l),u=a(72),d=n(u),p=i.default.module("app.components.gui.screen.games.list",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,a){t.otherwise("/"),e.state("gamesList",{url:a.url.games+"?importGame&importAdventure",template:"<games-list></games-list>"})}]).component("gamesList",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\n<about></about>\n<main>\n    <div class="container bg-white" role="main">\n        <h2>{{ \'Adventures\' | translate }}</h2>\n\n        <ul>\n            <li ng-repeat="adventure in $ctrl.adventures">\n                <span>\n                    {{ (!!adventure.serie ? adventure.serie + \': \': \'\') +  adventure.name }} {{ ($ctrl.hasAdventureToBeDownloaded(adventure) ? \'downloadable_in_list\' : \'\') | translate }}\n                </span>\n                <button type="button"\n                        class="btn btn-xs btn-default"\n                        aria-label="{{ \'Display actions\' | translate}}"\n                        title="{{ \'Display actions\' | translate}}"\n                        ng-if="!adventure.missingAdventure"\n                        ng-click="$ctrl.displaySelectedAdventureActions(adventure)">\n                    <span aria-hidden="true">{{ \'Display actions\' | translate }}</span>\n                </button>\n\n                <ul>\n                    <li ng-repeat="game in adventure.games">\n                        <span>\n                            {{ game.name + \' (\' + game.time + \')\' }}\n                        </span>\n                        <button type="button"\n                                class="btn btn-xs btn-default"\n                                aria-label="{{ \'Display actions\' | translate}}"\n                                title="{{ \'Display actions\' | translate}}"\n                                ng-click="$ctrl.displaySelectedGameActions(game)">\n                            <span aria-hidden="true">{{ \'Display actions\' | translate }}</span>\n                        </button>\n                    </li>\n                </ul>\n            </li>\n        </ul>\n\n        <button type="button" class="btn btn-default"\n                aria-label="{{ \'Create an adventure\' | translate }}"\n                title="{{ \'Create an adventure\' | translate }}"\n                ng-click="$ctrl.createAdventure()">{{ \'Create an adventure\' | translate }}</button>\n        <button type="button" class="btn btn-default"\n                aria-label="{{ \'Import\' | translate }}"\n                title="{{ \'Import\' | translate }}"\n                ng-click="$ctrl.displayImportActions()">{{ \'Import\' | translate }}</button>\n    </div>\n</main>\n<footnote></footnote>\n\n<a id="linkDownloadExportAdventure" ng-show="false" ng-href="{{$ctrl.exportDownloadBlobUrl}}" download="exportAdventure.txt">download adventure (link hidden)</a>\n<a id="linkDownloadExportGame" ng-show="false" ng-href="{{$ctrl.exportDownloadBlobUrl}}" download="exportGame.txt">download game (link hidden)</a>\n\n<popup config="{{ $ctrl.popupDeleteAdventureConfig }}"></popup>\n<popup config="{{ $ctrl.popupDownloadAdventureConfig }}"></popup>\n<popup config="{{ $ctrl.popupDeleteGameConfig }}"></popup>\n<popup config="{{ $ctrl.popupRestartGameConfig }}"></popup>\n<popup config="{{ $ctrl.popupDisplaySelectedAdventureActionsConfig }}"></popup>\n<popup config="{{ $ctrl.popupDisplaySelectedGameActionsConfig }}"></popup>\n<popup config="{{ $ctrl.popupDisplayImportActionsConfig }}"></popup>\n<popup config="{{ $ctrl.popupStartGameConfig }}"></popup>\n<import-data-popup config="$ctrl.popupImportAdventureConfig"></import-data-popup>\n<import-data-popup config="$ctrl.popupImportGameConfig"></import-data-popup>'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r,i,s,o,l,c,u,d,p){a(this,e),this.constants=n,this.$location=t,this.gamePersistenceService=r,this.adventurePersistenceService=i,this.messagesService=s,this.$translate=o,this.popupService=l,this.importDataPopupService=c,this.$stateParams=u,this.$window=d,this.$timeout=p,this.popupStartGameConfig={id:"popupStartGame",text:"Please fill the name of the game",withText:!0,textRequired:!0,choices:[n.choices.ok,n.choices.cancel]},this.popupDeleteGameConfig={id:"popupDeleteGame",text:"Are you sure to remove the selected game?",choices:[n.choices.yes,n.choices.no]},this.popupRestartGameConfig={id:"popupRestartGame",text:"Are you sure to restart the selected game?",choices:[n.choices.yes,n.choices.no]},this.popupDeleteAdventureConfig={id:"popupDeleteAdventure",text:"Are you sure to remove the selected adventure?",choices:[n.choices.yes,n.choices.no]},this.popupDownloadAdventureConfig={id:"popupDownloadAdventure",text:"Are you sure to download the selected adventure? Existing games could be non-playable after the update if the new version is not retro-compatible",choices:[n.choices.yes,n.choices.no]},this.popupDisplaySelectedGameActionsConfig={id:"popupDisplaySelectedGameActions",text:"Choose an action",choices:[n.choices.continue,n.choices.restart,n.choices.remove,n.choices.export,n.choices.cancel]},this.popupDisplaySelectedAdventureActionsConfig={id:"popupDisplaySelectedAdventureActions",text:"Choose an action",choices:[n.choices.display,n.choices.remove,n.choices.createGame,n.choices.export,n.choices.download,n.choices.cancel]},this.popupDisplayImportActionsConfig={id:"popupDisplayImportActions",text:"What must be imported?",choices:[n.choices.adventure,n.choices.game,n.choices.cancel]},this.popupImportGameConfig={id:"popupImportGame"},this.popupImportAdventureConfig={id:"popupImportAdventure"},u.importGame?this.importGameFromUrl(u.importGame):u.importAdventure&&this.importAdventureFromUrl(u.importAdventure),this.initData()}return e.$inject=["$location","constants","gamePersistenceService","adventurePersistenceService","messagesService","$translate","popupService","importDataPopupService","$stateParams","$window","$timeout"],n(e,[{key:"initData",value:function(){this.adventures=this.adventurePersistenceService.getAdventuresOverview(),this.adventures.sort(this.compareAdventure);for(var e=this.getGamesData(),t=this.createMissingAdventures(this.getMissingAdventureIds(this.adventures,e)),a=0;a<t.length;a++)this.adventures.push(t[a]);for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<this.adventures.length;i++){var s=this.adventures[i];if(r.adventureId==s.id){s.games||(s.games=[]),s.games.push(r);break}}for(var o=0;o<this.adventures.length;o++)this.adventures[o].games&&this.adventures[o].games.sort(this.compareGame)}},{key:"getMissingAdventureIds",value:function(e,t){for(var a=[],n=0;n<t.length;n++){for(var r=t[n],i=!1,s=0;s<e.length;s++){var o=e[s];if(r.adventureId==o.id){i=!0;break}}i||a.indexOf(r.adventureId)!==-1||a.push(r.adventureId)}return a}},{key:"createMissingAdventures",value:function(e){for(var t=[],a=0;a<e.length;a++){var n={id:e[a],name:this.$translate.instant("missing-adventure",{name:e[a]}),games:[],missingAdventure:!0};t.push(n)}return t.sort(this.compareAdventure),t}},{key:"compareAdventure",value:function(e,t){if(e||t){if(e){if(t){var a="",n="";return a=e.serie?a+"Z"+e.serie:"A",e.name&&(a+=e.name),n=t.serie?n+"Z"+t.serie:"A",t.name&&(n+=t.name),a.localeCompare(n)}return-1}return 1}return 0}},{key:"compareGame",value:function(e,t){return e||t?e?t?e.name||t.name?e.name?t.name?e.name.localeCompare(t.name):-1:1:0:-1:1:0}},{key:"getGamesData",value:function(){for(var e=this.gamePersistenceService.getGamePersistenceKeys(),t=[],a=0;a<e.length;a++){var n=this.gamePersistenceService.getGame(e[a]),r=this.adventurePersistenceService.getAdventure(n.adventureId);if(r){var i=this.adventurePersistenceService.getParagraph(n.adventureId,n.currentParagraphNr);i&&(n.paragraphTag=i.tag)}else n.adventureName=n.adventureId;t.push(n)}return t}},{key:"displaySelectedAdventureActions",value:function(e){var t=this;this.popupService.show(this.popupDisplaySelectedAdventureActionsConfig.id,function(a,n){n===t.constants.choices.display?t.displayAdventure(e):n===t.constants.choices.remove?t.displayRemoveAdventurePopup(e):n===t.constants.choices.export?t.exportAdventure(e.id):n===t.constants.choices.download?t.downloadAdventure(e):n===t.constants.choices.createGame&&t.displayStartGamePopup(e)})}},{key:"displayAdventure",value:function(e){this.$location.url(this.constants.url.adventureDetail+"/"+e.id)}},{key:"displayRemoveAdventurePopup",value:function(e){var t=this;this.popupService.show(this.popupDeleteAdventureConfig.id,function(a,n){n===t.constants.choices.yes&&t.deleteAdventure(e)})}},{key:"displayStartGamePopup",value:function(e){var t=this;this.popupService.show(this.popupStartGameConfig.id,function(a,n,r){n===t.constants.choices.ok&&t.startGame(e.id,r)})}},{key:"deleteAdventure",value:function(e){this.adventurePersistenceService.deleteAdventureAndParagraphs(e.id),this.initData()}},{key:"exportAdventure",value:function(e){var t=JSON.stringify(this.adventurePersistenceService.exportAdventure(e));this.exportDownloadBlobUrl=this.createDownloadBlobUrl(t),this.$timeout(function(){var e=window.document.getElementById("linkDownloadExportAdventure");e.click()})}},{key:"displayDownloadAdventurePopup",value:function(e){var t=this;this.popupService.show(this.popupDownloadAdventureConfig.id,function(a,n){n===t.constants.choices.yes&&t.downloadAdventure(e)})}},{key:"downloadAdventure",value:function(e){var t=this,a=this.adventurePersistenceService.downloadAdventureWithId(e.id);a.then(function(e){t.initData()},function(e){t.initData()})}},{key:"displayImportActions",value:function(){var e=this;this.popupService.show(this.popupDisplayImportActionsConfig.id,function(t,a){a===e.constants.choices.game?e.displayImportGamePopup():a===e.constants.choices.adventure&&e.displayImportAdventurePopup()})}},{key:"displaySelectedGameActions",value:function(e){var t=this;this.popupService.show(this.popupDisplaySelectedGameActionsConfig.id,function(a,n){n===t.constants.choices.continue?t.continueGame(e):n===t.constants.choices.restart?t.displayRestartGamePopup(e):n===t.constants.choices.remove?t.displayRemoveGamePopup(e):n===t.constants.choices.export&&t.exportGame(e.id)})}},{key:"displayRestartGamePopup",value:function(e){var t=this;this.popupService.show(this.popupRestartGameConfig.id,function(a,n){n===t.constants.choices.yes&&t.restartGame(e)})}},{key:"startGame",value:function(e,t){var a=this.adventurePersistenceService.getAdventure(e);a?this.continueGame(this.gamePersistenceService.startGame(e,t)):this.messagesService.errorMessage(this.$translate.instant("CannotFindAdventure",{adventure:game.adventureId}),!1)}},{key:"restartGame",value:function(e){var t=this.adventurePersistenceService.getAdventure(e.adventureId);t?(this.gamePersistenceService.restart(e.id),e=this.gamePersistenceService.getGame(e.id),this.continueGame(e)):this.messagesService.errorMessage(this.$translate.instant("CannotFindAdventure",{adventure:e.adventureId}),!1)}},{key:"continueGame",value:function(e){var t=this.adventurePersistenceService.getAdventure(e.adventureId);if(t)if(t.downloadUrl&&!t.downloaded){var a=this,n=this.adventurePersistenceService.downloadAdventureWithId(t.id);n.then(function(t){var n=a.gamePersistenceService.getUrlOfGame(e.id);a.$location.url(n)},function(e){a.initData()})}else{var r=this.gamePersistenceService.getUrlOfGame(e.id);this.$location.url(r)}else this.messagesService.errorMessage(this.$translate.instant("CannotFindAdventure",{adventure:e.adventureId}),!1)}},{key:"displayRemoveGamePopup",value:function(e){var t=this;this.popupService.show(this.popupDeleteGameConfig.id,function(a,n){n===t.constants.choices.yes&&t.deleteGame(e)})}},{key:"deleteGame",value:function(e){this.gamePersistenceService.deleteGame(e.id),this.initData()}},{key:"exportGame",value:function(e){var t=JSON.stringify(this.gamePersistenceService.exportGame(e));this.exportDownloadBlobUrl=this.createDownloadBlobUrl(t),this.$timeout(function(){var e=window.document.getElementById("linkDownloadExportGame");e.click()})}},{key:"createDownloadBlobUrl",value:function(e){var t=new Blob([e],{type:"text/plain"}),a=this.$window.URL||this.$window.webkitURL;return a.createObjectURL(t)}},{key:"displayImportGamePopup",value:function(){var e=this;this.importDataPopupService.show(this.popupImportGameConfig.id,function(t,a){e.gamePersistenceService.importGame(a),e.initData()})}},{key:"displayImportAdventurePopup",value:function(){var e=this;this.importDataPopupService.show(this.popupImportAdventureConfig.id,function(t,a){e.adventurePersistenceService.importAdventure(a),e.initData()})}},{key:"importGameFromUrl",value:function(e){var t=this,a=this.gamePersistenceService.downloadGame(e);a.then(function(e){t.initData(),t.clearUrl()},function(e){t.messagesService.errorMessage(e,!1)})}},{key:"importAdventureFromUrl",value:function(e){var t=this,a=this.adventurePersistenceService.downloadAdventure(null,e);a.then(function(e){t.initData(),t.clearUrl()},function(e){t.messagesService.errorMessage(e,!1)})}},{key:"clearUrl",value:function(){this.$location.url(this.constants.url.games)}},{key:"createAdventure",value:function(){this.$location.url(this.constants.url.adventureDetail+"/create")}},{key:"hasAdventureToBeDownloaded",value:function(e){return!!e.downloadUrl&&!e.downloaded}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(5),o=n(s),l=a(74),c=n(l),u=a(75),d=n(u),p=i.default.module("app.components.gui.screen.games.detail",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,a){t.otherwise("/"),e.state("game-detail",{url:a.url.gameDetail,template:"<game-detail></game-detail>"})}]).component("gameDetail",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\n<main>\n    <div class="container bg-white" role="main">\n        <div class="page-header">\n            <h1>\n                {{ \'Paragraph\' | translate }} {{ $ctrl.paragraph.paragraphNr }}\n                {{ !!$ctrl.paragraph.tag ? \'(\' + $ctrl.paragraph.tag +  \')\' : \'\' }}\n                <button type="button"\n                        class="btn btn-xs btn-default"\n                        ng-click="$ctrl.editTag()"\n                        ng-show="!$ctrl.isTagEditable()">\n                    {{ \'Edit\' | translate }}\n                </button>\n            </h1>\n        </div>\n\n        <div ng-if="!!$ctrl.isTagEditable()">\n            <h2>{{ \'Visible sections\' | translate }}</h2>\n            <selectable-list entries="$ctrl.visibleSections"></selectable-list>\n\n            <h2>{{ \'Tag\' | translate }}</h2>\n            <input id="inputTag" type="text" class="form-control" ng-model="$ctrl.paragraph.tag">\n            <br>\n\n            <button type="button" class="btn btn-default"\n                    aria-label="{{ \'Back\' | translate}}"\n                    title="{{ \'Back\' | translate}}"\n                    ng-click="$ctrl.abortTagChanges()">\n                {{ \'Back\' | translate }}\n            </button>\n            <button type="button" class="btn btn-primary"\n                    aria-label="{{ \'Save changes\' | translate }}"\n                    title="{{ \'Save changes\' | translate }}"\n                    ng-click="$ctrl.saveTagChanges()">{{ \'Save\' | translate }}</button>\n        </div>\n\n        <div ng-if="!$ctrl.isTagEditable()">\n            <description game-id="$ctrl.game.id" paragraph="$ctrl.paragraph">\n            </description>\n\n            <goto game-id="$ctrl.game.id" paragraph="$ctrl.paragraph">\n            </goto>\n\n            <collapse ng-if="$ctrl.isMapAvailable()" title="{{ \'Map\' | translate }}" flag="game.map">\n                <nodes game-id="$ctrl.game.id" adventure-id="$ctrl.adventureId" root-paragraph-nr="$ctrl.paragraph.paragraphNr"></nodes>\n            </collapse>\n\n            <collapse ng-if="$ctrl.isCharactersAvailable()" title="{{ \'Characters\' | translate }}" flag="game.characters">\n                <characters-deprecated game-id="$ctrl.game.id"></characters-deprecated>\n                <characters game-id="$ctrl.game.id"></characters>\n            </collapse>\n\n            <collapse ng-if="$ctrl.isDicesAvailable()" title="{{ \'Dices\' | translate }}" flag="game.dices">\n                <dices ng-if="$ctrl.isDicesAvailable() && !$ctrl.dicesCollapsed()" game-id="{{$ctrl.game.id}}"></dices>\n            </collapse>\n\n            <div ng-repeat="list in $ctrl.adventure.lists.keys">\n                <collapse ng-if="$ctrl.isEntriesAvailable(list)" title="{{ list }}" flag="game.{{list}}">\n                    <list entries="$ctrl.game.lists[list]" on-save="$ctrl.onSubListSave(list, entries)"></list>\n                </collapse>\n            </div>\n\n            <back-button></back-button>\n\n            <button type="button"\n                    class="btn btn-default"\n                    ng-if="$ctrl.isGameRulesAvailable()"\n                    ng-click="$ctrl.goToGameRulesParagraph()">\n                {{ "Game\'s rules" | translate }}\n            </button>\n        </div>\n    </div>\n</main>\n<footnote></footnote>\n';
},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r,i,s,o,l,c,u){a(this,e),this.$location=t,this.constants=n,this.$stateParams=r,this.gamePersistenceService=i,this.adventurePersistenceService=s,this.$translate=o,this.messagesService=l,this.$filter=c,this.$window=u,this.stats=[],this.initData()}return e.$inject=["$location","constants","$stateParams","gamePersistenceService","adventurePersistenceService","$translate","messagesService","$filter","$window"],n(e,[{key:"initData",value:function(){this.game=this.gamePersistenceService.getGame(decodeURIComponent(this.$stateParams.gameId)),this.game.stats&&(this.stats=this.stats.concat(this.game.stats)),this.adventureId=this.$stateParams.adventureId,this.paragraph=this.adventurePersistenceService.getOrCreateParagraph(this.adventureId,this.$stateParams.paragraphNr),this.adventure=this.adventurePersistenceService.getAdventure(this.adventureId),this.visibleSections=this.adventurePersistenceService.getOrCreateVisibleSections(this.adventureId,this.paragraph.tag),this.checkAvailableAdventure()}},{key:"checkAvailableAdventure",value:function(){this.adventure||this.messagesService.errorMessage("The adventure is not available",!1)}},{key:"goToGameRulesParagraph",value:function(){this.gamePersistenceService.setCurrentParagraphNrOfGame(this.game.id,this.paragraph.paragraphNr,this.adventure.gameRulesParagraphId);var e=this.gamePersistenceService.getUrlOfGame(this.game.id);this.$location.url(e)}},{key:"isMapAvailable",value:function(){return!!this.adventure.toggles.map&&!!this.visibleSections.Map.checked}},{key:"isDicesAvailable",value:function(){return!!this.adventure.toggles.dices&&!!this.visibleSections.Dices.checked}},{key:"isCharactersAvailable",value:function(){return!!this.adventure.toggles.characters&&!!this.visibleSections.Characters.checked}},{key:"isEntriesAvailable",value:function(e){return!this.visibleSections[e]||!!this.visibleSections[e].checked}},{key:"isGameRulesAvailable",value:function(){return!!this.adventure.gameRulesParagraphId}},{key:"editDescription",value:function(){this.descriptionEditable=!0,this.originalDescription=this.paragraph.description}},{key:"isDescriptionEditable",value:function(){return this.descriptionEditable}},{key:"saveDescriptionChanges",value:function(){this.originalDescription=null,this.descriptionEditable=!1,this.adventurePersistenceService.updateParagraph(this.adventureId,this.paragraph)}},{key:"abortDescriptionChanges",value:function(){this.paragraph.description=this.originalDescription,this.originalDescription=null,this.descriptionEditable=!1}},{key:"editTag",value:function(){this.tagEditable=!0,this.originalTag=this.paragraph.tag,this.originalVisibileSections=JSON.parse(JSON.stringify(this.visibleSections))}},{key:"isTagEditable",value:function(){return this.tagEditable}},{key:"saveTagChanges",value:function(){this.adventurePersistenceService.updateVisibleSectionsAndParagrahTag(this.adventure.id,this.paragraph,this.visibleSections,this.originalTag),this.originalTag=null,this.tagEditable=!1}},{key:"abortTagChanges",value:function(){this.paragraph.tag=this.originalTag,this.originalTag=null,this.tagEditable=!1,this.visibleSections=this.originalVisibileSections}},{key:"onSubListSave",value:function(e,t){this.game.lists[e]=t,this.gamePersistenceService.updateGame(this.game)}},{key:"now",value:function e(){var e=new Date;return this.$filter("date")(e,"dd.MM.yyyy HH:mm")}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(5),o=n(s),l=a(77),c=n(l),u=a(78),d=n(u),p=i.default.module("app.components.gui.screen.administration",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,a){t.otherwise("/"),e.state("administration",{url:a.url.administration,template:"<administration></administration>"})}]).component("administration",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\n<main>\n    <div class="container bg-white" role="contentinfo">\n        <h2>{{ \'Administration\' | translate }}</h2>\n        <div class="col-md-12">\n            <form>\n                <div>\n                    <div class="form-group">\n                        <label for="appVersion">{{ "Application\'s version" | translate }}</label>\n                        <div id="appVersion">{{ $ctrl.appVersion }}</div>\n                    </div>\n                    <div class="form-group">\n                        <label for="usedLocalStorageInPercent">{{ "Used Local\'s Storage in Percent" | translate }}</label>\n                        <input type="text" class="form-control" id="usedLocalStorageInPercent" value="{{ $ctrl.usedLocalStorageInPercent | number : 2}}%">\n                    </div>\n                    <div class="form-group">\n                        <label for="usedLocalStorage">{{ "Used Local\'s Storage" | translate }}</label>\n                        <input type="text" class="form-control" id="usedLocalStorage" value="{{$ctrl.usedLocalStorage / 1024 | number : 2 }}kb">\n                    </div>\n                    <div class="form-group">\n                        <label for="remainingCapacity">{{ "Remaining Local\'s Storage" | translate }}</label>\n                        <input type="text" class="form-control" id="remainingCapacity" value="{{$ctrl.remainingCapacity / 1024 | number : 2 }}kb">\n                    </div>\n                    <div class="form-group">\n                        <label for="applicationData">{{ "Application\'s data" | translate }}</label>\n                        <input type="text" class="form-control" id="applicationData" ng-model="$ctrl.applicationData">\n                    </div>\n                    <div class="form-group">\n                        <label for="importData">{{ "Paste the application\'s data copied from another browser" | translate }}</label>\n                        <input type="text" class="form-control" ng-model="$ctrl.importData" id="importData" placeholder="{{ \'Imported data\' | translate }}">\n                    </div>\n                    <div class="form-group">\n                        <button class="btn btn-danger" ng-click="$ctrl.showPopupConfirmImportData()" aria-label="{{ \'Import\' | translate }}">{{ \'Import\' | translate }}</button>\n                    </div>\n                </div>\n                <div>\n                    <div class="form-group">\n                        <button class="btn btn-danger" ng-click="$ctrl.showPopupConfirmDeleteApplicationData()" aria-label="{{ \'Delete application\\\'s data\' | translate }}">{{ "Delete application\'s data" | translate }}</button>\n                    </div>\n                </div>\n                <back-button></back-button>\n            </form>\n\n            <popup config="{{ $ctrl.popupConfirmImportApplicationDataConfig }}"></popup>\n            <popup config="{{ $ctrl.popupConfirmDeleteApplicationDataConfig }}"></popup>\n        </div>\n    </div>\n</main>\n<footnote></footnote>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r,i,s){a(this,e),this.persistenceService=t,this.adventurePersistenceService=n,this.constants=r,this.popupService=i,this.initData(),this.$window=s,this.popupConfirmImportApplicationDataConfig={id:"popupConfirmImportApplicationData",text:"All existing application's data will be erased during the import. Are you sure to import the application data?",choices:[r.choices.yes,r.choices.no]},this.popupConfirmDeleteApplicationDataConfig={id:"popupConfirmDeleteApplicationData",text:"Are you sure to clear the application data?",choices:[r.choices.yes,r.choices.no]}}return e.$inject=["persistenceService","adventurePersistenceService","constants","popupService","$window"],n(e,[{key:"initData",value:function(){this.appVersion=this.constants.version,this.applicationData=this.persistenceService.export(),this.computeLocalStorageCapacities()}},{key:"computeLocalStorageCapacities",value:function(){this.usedLocalStorage=this.persistenceService.getUsedCapacity(),this.remainingCapacity=this.persistenceService.getRemainingCapacity(),this.usedLocalStorageInPercent=this.persistenceService.getUsedCapacityInPercent()}},{key:"showPopupConfirmImportData",value:function(){var e=this;this.popupService.show(this.popupConfirmImportApplicationDataConfig.id,function(t,a){a===e.constants.choices.yes&&(e.persistenceService.import(e.importData),e.$window.location.reload())})}},{key:"showPopupConfirmDeleteApplicationData",value:function(){var e=this;this.popupService.show(this.popupConfirmDeleteApplicationDataConfig.id,function(t,a){a===e.constants.choices.yes&&(e.persistenceService.cleanAllData(),e.$window.location.reload())})}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(5),o=n(s),l=a(80),c=n(l),u=a(81),d=n(u),p=i.default.module("app.components.gui.screen.credits",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,a){t.otherwise("/"),e.state("credits",{url:a.url.credits,template:"<credits></credits>"})}]).component("credits",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\n<main>\n    <div class="container bg-white" role="main">\n        <h1>{{ \'Credits\' | translate }}</h1>\n        <div class="text-muted">{{ \'sorted alphabetically\' | translate }}</div>\n\n        <ul>\n            <li ng-repeat="credit in $ctrl.credits">\n                <a href="{{ credit.url }}" target="_blank">{{ credit.resourceName }}</a>\n                <ng-if ng-if="!!credit.author">{{ \'by\' | translate }} {{ credit.author }}</ng-if>\n                <ng-if ng-if="!!credit.description">({{ credit.description | translate }})</ng-if>\n            </li>\n        </ul>\n\n        <back-button></back-button>\n    </div>\n</main>\n<footnote></footnote>\n'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(){a(this,e);var t=[{resourceName:"JavaScript",author:"Brendan Eich",url:"https://en.wikipedia.org/wiki/JavaScript",description:"credit_description_javascript"},{resourceName:"Image",author:"Ravenmore",url:"//opengameart.org/content/fantasy-icon-pack-by-ravenmore-0",description:"credit_description_map_image"},{resourceName:"ESTA Web/JS",author:"Schweizerische Bundesbahnen",url:"https://github.com/SchweizerischeBundesbahnen/esta-webjs",description:"credit_description_estawebjs"},{resourceName:"AngularJS1",author:"Google",url:"https://angularjs.org/",description:"credit_description_angularjs"},{resourceName:"Bootstrap",author:"Twitter",url:"http://getbootstrap.com/",description:"credit_description_bootstrap"},{resourceName:"Webpack",url:"https://webpack.github.io/docs/",description:"credit_description_webpack"},{resourceName:"Gulp",url:"http://gulpjs.com/",description:"credit_description_gulp"},{resourceName:"npm",url:"https://www.npmjs.com/",description:"credit_description_npm"},{resourceName:"node.js",url:"https://nodejs.org/en/",description:"credit_description_nodejs"},{resourceName:"Browsersync",url:"https://www.browsersync.io/",description:"credit_description_browsersync"},{resourceName:"angular translate",url:"https://github.com/angular-translate/angular-translate",description:"credit_description_angular-translate"},{resourceName:"AngularUI Router",url:"https://github.com/angular-ui/ui-router",description:"credit_description_angular-ui-router"},{resourceName:"Babel",url:"https://babeljs.io/",description:"credit_description_babel"},{resourceName:"RealFaviconGenerator",url:"https://realfavicongenerator.net/",description:"credit_description_realfavicongenerator"},{resourceName:"GitHub",url:"https://github.com/",description:"credit_description_github"},{resourceName:"Modern Clean CSS “Sticky Footer”",author:"Rizqy Hidayat",url:"http://mystrd.at/modern-clean-css-sticky-footer/",description:"credit_description_article_sticky_footer"},{resourceName:"Responsive Navigation Patterns",author:"Brad Frost",url:"http://bradfrost.com/blog/web/responsive-nav-patterns/",description:"credit_description_article_responsive_navigation_patterns"}];this.credits=this.sort(t)}return n(e,[{key:"sort",value:function(e){return e.sort(this.compareCredit)}},{key:"compareCredit",value:function(e,t){return e||t?e?t?e.resourceName.localeCompare(t.resourceName):-1:1:0}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(83),o=n(s),l=i.default.module("app.components.gui.screens.adventures",[o.default.name]);t.default=l},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(5),o=n(s),l=a(84),c=n(l),u=a(85),d=n(u),p=i.default.module("app.components.gui.screen.adventures.detail",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,a){t.otherwise("/"),e.state("adventure-detail",{url:a.url.adventureDetail+"/{adventureId}",template:"<adventure-detail></adventure-detail>"})}]).component("adventureDetail",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\n<main>\n    <div class="container bg-white" role="main">\n        <h2>{{ $ctrl.adventure.name }}</h2>\n        <div class="col-md-12">\n            <form name="adventureTableForm" novalidate="novalidate" ng-submit="$ctrl.save()">\n                <h2>{{ \'General\' | translate }}</h2>\n                <div>\n                    <div class="form-group" ng-if="!$ctrl.adventure.id">\n                        <label for="name">{{ \'Name\' | translate }}</label>\n                        <input type="text" class="form-control" id="name" ng-model="$ctrl.adventure.name" required>\n                    </div>\n                    <div class="form-group">\n                        <label for="serie">{{ \'Serie\' | translate }}</label>\n                        <input type="text" class="form-control" id="serie" ng-model="$ctrl.adventure.serie">\n                    </div>\n                    <div class="form-group">\n                        <label for="authors">{{ \'Author(s)\' | translate }}</label>\n                        <input type="text" class="form-control" id="authors" ng-model="$ctrl.adventure.authors" required>\n                    </div>\n                    <div class="form-group">\n                        <label for="description">{{ \'Description\' | translate }}</label>\n                        <textarea id="description" class="form-control" ng-model="$ctrl.adventure.description"></textarea>\n                    </div>\n                    <div class="form-group">\n                        <label for="version">{{ \'Version\' | translate }}</label>\n                        <input type="text" class="form-control" id="version" ng-model="$ctrl.adventure.version" required>\n                    </div>\n                    <div class="form-group">\n                        <label for="language">{{ \'Language\' | translate }}</label>\n                        <input type="text" class="form-control" id="language" ng-model="$ctrl.adventure.language" required>\n                    </div>\n                    <div class="form-group">\n                        <label for="homepage">{{ \'Homepage\' | translate }}</label>\n                        <input type="text" class="form-control" id="homepage" ng-model="$ctrl.adventure.homepage">\n                    </div>\n                    <div class="form-group">\n                        <label for="isbn">{{ \'ISBN\' | translate }}</label>\n                        <input type="text" class="form-control" id="isbn" ng-model="$ctrl.adventure.isbn">\n                    </div>\n                    <div class="form-group">\n                        <label for="startParagraphId">{{ \'First paragraph\' | translate }}</label>\n                        <input type="text" class="form-control" id="startParagraphId" ng-model="$ctrl.adventure.startParagraphId" required>\n                    </div>\n                    <div class="form-group">\n                        <label for="gameRulesParagraphId">{{ "Game\'s rules paragraph" | translate }}</label>\n                        <input type="text" class="form-control" id="gameRulesParagraphId" ng-model="$ctrl.adventure.gameRulesParagraphId">\n                    </div>\n                    <div class="form-group">\n                        <label for="homepage">{{ \'Download URL\' | translate }}</label>\n                        <input type="text" class="form-control" id="homepage" ng-model="$ctrl.adventure.downloadUrl">\n                    </div>\n                </div>\n\n                <h2>{{ \'Features\' | translate }}</h2>\n\n                <div>\n                    <div class="form-group">\n                        <label>\n                            <input type="checkbox" value="" ng-model="$ctrl.adventure.toggles.characters">\n                            {{ \'Enable characters with stats\' | translate }}\n                        </label>\n                    </div>\n                    <div class="form-group">\n                        <label>\n                            <input type="checkbox" value="" ng-model="$ctrl.adventure.toggles.dices">\n                            {{ \'Enable dices\' | translate }}\n                        </label>\n                    </div>\n                    <div class="form-group">\n                        <label>\n                            <input type="checkbox" value="" ng-model="$ctrl.adventure.toggles.goto">\n                            {{ \'Enable Go to paragraph\' | translate }}\n                        </label>\n                    </div>\n                    <div class="form-group">\n                        <label>\n                            <input type="checkbox" value="" ng-model="$ctrl.adventure.toggles.map">\n                            {{ \'Enable map\' | translate }}\n                        </label>\n                    </div>\n                </div>\n\n                <div ng-if="$ctrl.adventure.toggles.dices">\n                    <h2>{{ \'Dices\' | translate }}</h2>\n                    <div>\n                        <div class="form-group">\n                            <label for="diceMin">{{ "Minimal dice\'s value" | translate }}</label>\n                            <input type="number" class="form-control" id="diceMin" ng-model="$ctrl.adventure.dice.min"\n                                   ng-required="$ctrl.adventure.toggles.dices">\n                        </div>\n                        <div class="form-group">\n                            <label for="diceMax">{{ "Maximal dice\'s value" | translate }}</label>\n                            <input type="number" class="form-control" id="diceMax" ng-model="$ctrl.adventure.dice.max"\n                                   ng-required="$ctrl.adventure.toggles.dices">\n                        </div>\n                    </div>\n                </div>\n\n                <h2>{{ \'Lists\' | translate }}</h2>\n                <list entries="$ctrl.adventure.lists.keys" on-save="$ctrl.onListSave(entries)"></list>\n\n                <div ng-repeat="list in $ctrl.adventure.lists.keys">\n                    <h2>{{ list }}</h2>\n                    <list entries="$ctrl.adventure.lists.values[list]" on-save="$ctrl.onSubListSave(list, entries)"></list>\n\n                    <label>\n                        <input type="checkbox" value="" ng-model="$ctrl.adventure.lists.keepOnRestart[list]">\n                        {{ \'Keep on restart\' | translate }}\n                    </label>\n                </div>\n            </form>\n        </div>\n        <back-button></back-button>\n        <button type="button" class="btn btn-primary"\n                aria-label="{{ \'Save changes\' | translate }}"\n                title="{{ \'Save changes\' | translate }}"\n                ng-click="$ctrl.save(adventureTableForm)">{{ \'Save\' | translate }}</button>\n    </div>\n</main>\n<footnote></footnote>'},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r,i,s,o,l,c,u,d,p,h){a(this,e),this.persistenceService=t,this.adventurePersistenceService=n,this.$stateParams=r,this.$location=i,this.constants=s,this.popupService=o,this.messagesService=l,this.$timeout=c,this.$window=u,this.formHelperService=d,this.$translate=p,this.$log=h,this.initData(),this.setInitialFocus()}return e.$inject=["persistenceService","adventurePersistenceService","$stateParams","$location","constants","popupService","messagesService","$timeout","$window","formHelperService","$translate","$log"],n(e,[{key:"initData",value:function(){var e=encodeURIComponent(this.$stateParams.adventureId);e&&("create"===e?(this.adventure={toggles:{battle:!0,dices:!0,goto:!0,characters:!0,map:!0}},this.mode="create"):(this.adventure=this.adventurePersistenceService.getAdventure(e),this.mode="edit"),this.adventure.lists||(this.adventure.lists={values:{}}))}},{key:"setInitialFocus",value:function(){var e=this;this.$timeout(function(){var t=void 0;t="create"===e.mode?e.$window.document.getElementById("name"):e.$window.document.getElementById("authors"),t&&t.focus()})}},{key:"save",value:function(e){if(this.formHelperService.setErrorFieldsAsDirty(e,!0),!e.$invalid){this.adventure.toggles.dices||delete this.adventure.dice;try{this.adventurePersistenceService.updateAdventureWithoutParagraphs(this.adventure),this.$location.url(this.constants.url.games)}catch(e){this.$log.warn(e)}}}},{key:"onListSave",value:function(e){if(this.adventure.lists.keys)for(var t=0;t<this.adventure.lists.keys.length;t++){var a=this.adventure.lists.keys[t];e.indexOf(a)===-1&&delete this.adventure.lists.values[a]}this.adventure.lists.keys=e}},{key:"onSubListSave",value:function(e,t){this.adventure.lists.values[e]=t}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(5),o=n(s),l=a(87),c=n(l),u=a(88),d=n(u),p=i.default.module("app.components.gui.screen.library-import",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,a){t.otherwise("/"),e.state("libraryImport",{url:a.url.libraryImport+"?import",template:"<library-import></library-import>"})}]).component("libraryImport",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports="<messages></messages>\n<main>\n</main>\n<footnote></footnote>\n"},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r,i,s){a(this,e),this.constants=n,this.$location=t,this.libraryPersistenceService=i,this.messagesService=r,this.$stateParams=s,s.import?this.downloadLibrary(s.import):this.displayAdventures()}return e.$inject=["$location","constants","messagesService","libraryPersistenceService","$stateParams"],n(e,[{key:"downloadLibrary",value:function(e){var t=this,a=this.libraryPersistenceService.downloadLibrary(e);a.then(function(e){t.displayAdventures()},function(e){t.messagesService.errorMessage(e,!1)})}},{key:"displayAdventures",value:function(){this.$location.url(this.constants.url.games)}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(90),o=n(s),l=a(100),c=n(l),u=a(102),d=n(u),p=a(104),h=n(p),v=a(106),f=n(v),g=i.default.module("app.components.services",[o.default.name,c.default.name,d.default.name,h.default.name,f.default.name]);t.default=g},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(91),o=n(s),l=a(93),c=n(l),u=a(95),d=n(u),p=a(97),h=n(p),v=a(98),f=n(v),g=i.default.module("app.components.services.persistence",[o.default.name,c.default.name,d.default.name,f.default.name]).service("persistenceService",h.default);t.default=g},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(92),o=n(s),l=i.default.module("app.components.services.persistence.game",[]).service("gamePersistenceService",o.default);t.default=l},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(){function e(t,n,r,i,s,o,l){a(this,e),this.persistenceService=n,this.adventurePersistenceService=r,this.constants=t,this.messagesService=i,this.$q=s,this.remoteJsonRetrieverService=o,this.$translate=l}return e.$inject=["constants","persistenceService","adventurePersistenceService","messagesService","$q","remoteJsonRetrieverService","$translate"],r(e,[{key:"downloadGame",value:function(e){var t=this,a=this.$q.defer(),n=this.remoteJsonRetrieverService.retrieveJson(e);return n.then(function(e){t.importGame(JSON.stringify(e)),a.resolve("Success")},function(e){t.messagesService.errorMessage(e,!1),a.reject(e)}),a.promise}},{key:"getSelectedLanguage",value:function(){return this.persistenceService.get(this.constants.data.selectedLanguage)}},{key:"setSelectedLanguage",value:function(e){this.persistenceService.save(this.constants.data.selectedLanguage,e)}},{key:"addGame",value:function(e){var t={id:this.newGameId(),name:e.name,adventureId:e.adventureId,currentParagraphNr:e.currentParagraphNr};return e.lists&&(t.lists=e.lists),t.characters=[],this.updateGame(t),t}},{key:"exportGame",value:function(e){var t=this.getGame(e);if(t.characters)for(var a=0;a<t.characters.length;a++)if(delete t.characters[a].$$hashKey,t.characters[a].stats)for(var n=0;n<t.characters[a].stats.length;n++)delete t.characters[a].stats[n].$$hashKey;return this.sortObjectKeys(t)}},{key:"sortObjectKeys",value:function(e){var t=e;if(e)if(Array.isArray(e)){t=[];for(var a=0;a<e.length;a++)t.push(this.sortObjectKeys(e[a]))}else if("object"===("undefined"==typeof e?"undefined":n(e))){var r=Object.keys(e);if(r&&r.length>0){r=r.sort(),t={};for(var i=0;i<r.length;i++){var s=e[r[i]];s=this.sortObjectKeys(s),t[r[i]]=s}}}return t}},{key:"importGame",value:function(e){try{var t=JSON.parse(e),a=[];t.id||(t.id=this.newGameId()),t.adventureId||a.push("adventureId"),t.currentParagraphNr||a.push("currentParagraphNr"),a.length>0?this.messagesService.errorMessage(this.$translate.instant("ImportGameFailedMissingFields",{missingMandatoryFields:a.join(", ")}),!1):this.getGame(t.id)?this.messagesService.errorMessage(this.$translate.instant("GameAlreadyExists",{gameId:t.id}),!1):this.updateGame(t)}catch(e){this.messagesService.errorMessage(this.$translate.instant("Cannot import game"),!1)}}},{key:"updateGame",value:function(e){if(e){e=JSON.parse(JSON.stringify(e)),e.time=this.adventurePersistenceService.now();var t=this.getGamePersistenceKey(e.id);this.persistenceService.save(t,e)}}},{key:"deleteGame",value:function(e){var t=this.getGamePersistenceKey(e);localStorage.removeItem(t)}},{key:"newGameId",value:function(){return(new Date).getTime().toString()}},{key:"getUrlOfGame",value:function(e,t){var a=this.getGame(e);t||(t=a.currentParagraphNr);var n="/"+encodeURIComponent(a.adventureId)+"/"+encodeURIComponent(t)+"/game/"+encodeURIComponent(a.id);return n}},{key:"getGame",value:function(e){var t=this.getGamePersistenceKey(e);return this.persistenceService.get(t)}},{key:"getGamePersistenceKeys",value:function(){return this.persistenceService.findKeysWithPrefix(this.constants.data.game)}},{key:"getGamePersistenceKey",value:function(e){var t=e;return 0!==t.indexOf(this.constants.data.game)&&(t=this.constants.data.game+"."+t),t}},{key:"setCurrentParagraphNrOfGame",value:function(e,t,a){var n=this.getGame(e);if(t){var r=n.choosenParagraphs;r||(r=[],n.choosenParagraphs=r),r.indexOf(a)===-1&&r.push(a)}n.currentParagraphNr=a,n.path||(n.path=[]),n.path.push(a),this.updateGame(n)}},{key:"getChoosenChoices",value:function(e,t){var a=this.getGame(e),n=a.choosenParagraphs;if(n){var r=this.adventurePersistenceService.getParagraph(a.adventureId,t),i=[],s=this.adventurePersistenceService.getParagraphChoices(r);if(s)for(var o=0;o<s.length;o++)n.indexOf(s[o])!==-1&&i.push(""+s[o]);return i}return[]}},{key:"getGames",value:function(e){for(var t=this.getGamePersistenceKeys(),a=[],n=0;n<t.length;n++){var r=this.getGame(t[n]);r.adventureId===e&&a.push(r)}return a}},{key:"startGame",value:function(e,t){var a=this.adventurePersistenceService.getAdventure(e),n={name:t,adventureId:a.id};if(a.lists&&a.lists.keys){n.lists={};for(var r=0;r<a.lists.keys.length;r++)n.lists[a.lists.keys[r]]=[];for(var i=Object.keys(a.lists.values),s=0;s<i.length;s++)n.lists[i[s]]=a.lists.values[i[s]]}return n=this.addGame(n),this.setCurrentParagraphNrOfGame(n.id,null,a.startParagraphId),n}},{key:"restart",value:function(e){var t=this.getGame(e),a=this.adventurePersistenceService.getAdventure(t.adventureId);if(t.path=[],t.characters)for(var n=0;n<t.characters.length;n++)if(t.characters[n].stats)for(var r=0;r<t.characters[n].stats.length;r++)t.characters[n].stats[r].current=t.characters[n].stats[r].initial;if(a.lists&&a.lists.keys)for(var i=0;i<a.lists.keys.length;i++){var s=a.lists.keys[i],o=!!a.lists.keepOnRestart&&!!a.lists.keepOnRestart[s];if(!o&&t.lists&&delete t.lists[s],a.lists.values&&a.lists.values[s]){t.lists[s]||(t.lists[s]=[]);for(var l=0;l<a.lists.values[s].length;l++){var c=a.lists.values[s][l];t.lists[s].indexOf(c)===-1&&t.lists[s].push(c)}}}this.updateGame(t),this.setCurrentParagraphNrOfGame(e,null,a.startParagraphId);
}}]),e}();t.default=i},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(94),o=n(s),l=i.default.module("app.components.services.persistence.adventure",[]).service("adventurePersistenceService",o.default);t.default=l},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(){function e(t,n,r,i,s,o,l){a(this,e),this.constants=t,this.persistenceService=n,this.messagesService=r,this.$translate=i,this.$q=s,this.remoteJsonRetrieverService=o,this.$filter=l}return e.$inject=["constants","persistenceService","messagesService","$translate","$q","remoteJsonRetrieverService","$filter"],r(e,[{key:"downloadAdventureWithId",value:function(e){var t=this.getAdventure(e);return this.downloadAdventure(t,t.downloadUrl)}},{key:"downloadAdventure",value:function(e,t){var a=this,n=this.$q.defer(),r=this.remoteJsonRetrieverService.retrieveJson(t);return r.then(function(t){e?t.id=e.id:t.id=a.getAdventureIdFromAdventureName(t.name),a.import(t),a.messagesService.successMessage(a.$translate.instant("AdventureDownloaded",{adventure:t.name}),!1),n.resolve("Success")},function(e){a.messagesService.errorMessage(e,!1),n.reject(e)}),n.promise}},{key:"now",value:function e(){var e=new Date;return this.$filter("date")(e,"dd.MM.yyyy HH:mm")}},{key:"updateDownloadableAdventures",value:function(e){if(e)for(var t=0;t<e.length;t++)this.updateDownloadableAdventure(e[t])}},{key:"updateDownloadableAdventure",value:function(e){var t=this.getAdventure(e.id);t&&t.downloaded||this.updateAdventureWithoutParagraphs(e)}},{key:"getAdventuresOverview",value:function(){for(var e=this.getAdventurePersistenceKeys(),t=[],a=0;a<e.length;a++){var n=this.persistenceService.get(e[a]);t.push({id:n.id,name:n.name,numberOfParagraphs:n.numberOfParagraphs,language:n.language,version:n.version,authors:n.authors,serie:n.serie,downloadUrl:n.downloadUrl,downloadHistory:n.downloadHistory,downloaded:n.downloaded})}return t}},{key:"getAdventurePersistenceKeys",value:function(){for(var e=Object.keys(localStorage),t=[],a=0;a<e.length;a++)0===e[a].indexOf(this.constants.data.adventure)&&e[a].indexOf("paragraph.")===-1&&e[a].indexOf(".choosen")===-1&&t.push(e[a]);return t}},{key:"getAdventure",value:function(e){return this.persistenceService.get(this.getAdventurePersistenceKey(e))}},{key:"importAdventure",value:function(e){try{var t=JSON.parse(e,!0);this.import(t)}catch(e){this.messagesService.errorMessage(this.$translate.instant("Cannot import adventure"),!1)}}},{key:"import",value:function(e,t){try{var a=[];if(e.id||a.push("id"),e.name||a.push("name"),e.authors||a.push("authors"),e.version||a.push("version"),e.language||a.push("language"),e.startParagraphId||a.push("startParagraphId"),a.length>0)this.messagesService.errorMessage(this.$translate.instant("ImportGameFailedMissingFields",{missingMandatoryFields:a.join(", ")}),!1);else if(t&&this.getAdventure(e.id))this.messagesService.errorMessage(this.$translate.instant("AdventureAlreadyExists",{adventure:e.id}),!1);else if(e.paragraphs&&(e.numberOfParagraphs=e.paragraphs.length),e.downloadUrl&&(e.downloaded=!0),this.updateAdventureWithoutParagraphs(e),e.paragraphs)for(var n=0;n<e.paragraphs.length;n++)this.setParagraph(e.id,e.paragraphs[n],t)}catch(e){this.messagesService.errorMessage(this.$translate.instant("Cannot import adventure"),!1)}}},{key:"updateVisibleSectionsAndParagrahTag",value:function(e,t,a,n){t.tag||delete t.tag,this.updateParagraph(e,t),this.updateVisibleSections(e,t,a,n)}},{key:"updateVisibleSections",value:function(e,t,a,n){n=this.getTag(n);var r=this.getTag(t.tag),i=this.getOrCreateVisibleSections(e,r);n!==r&&this.deleteVisibleSectionsIfUnused(e,n);for(var s=Object.keys(a),o=0;o<s.length;o++){var l=s[o];i[l]=a[l]}this.saveVisibleSections(e,i,r)}},{key:"deleteVisibleSectionsIfUnused",value:function(e,t){var a=!1,n=this.getParagraphs(e);if(n)for(var r=0;r<n.length;r++){var i=n[r];if(i.tag&&t===i.tag){a=!0;break}}if(!a){var s=this.getAdventure(e);delete s.visibleSections[t],this.updateAdventureWithoutParagraphs(s)}}},{key:"getOrCreateVisibleSections",value:function(e,t){t=this.getTag(t);var a=this.getAdventure(e);a.visibleSections||(a.visibleSections={});var n=a.visibleSections[t];if(!n){if(n={},a.toggles.map&&(n.Map={value:this.$translate.instant("Map"),checked:!0}),a.toggles.characters&&(n.Characters={value:this.$translate.instant("Characters"),checked:!0}),a.toggles.dices&&(n.Dices={value:this.$translate.instant("Dices"),checked:!0}),a.lists)for(var r=0;r<a.lists.keys.length;r++)n[a.lists.keys[r]]={value:a.lists.keys[r],checked:!0};this.saveVisibleSections(a.id,n,t)}return n}},{key:"saveVisibleSections",value:function(e,t,a){var n=this.getAdventure(e);n.visibleSections||(n.visibleSections={}),n.visibleSections[a]=t,this.updateAdventureWithoutParagraphs(n)}},{key:"getTag",value:function(e){return e||(e="withoutTag"),e}},{key:"updateAdventureWithoutParagraphs",value:function(e){var t=this.getAdventureIdFromAdventureName(e.name);if(!e.id){e.id=t;var a=this.getAdventure(t);if(a)throw this.messagesService.errorMessage(this.$translate.instant("AdventureAlreadyExists",{adventure:t}),!1),this.constants.errors.adventureAlreadyExist}for(var n={},r=Object.keys(e),i=0;i<r.length;i++)"paragraphs"!==r[i]&&(n[r[i]]=e[r[i]]);this.persistenceService.save(this.constants.data.adventure+"."+e.id,n)}},{key:"getAdventureIdFromAdventureName",value:function(e){return encodeURIComponent(e.replace(/\s+/g,"-").toLowerCase())}},{key:"deleteAdventureAndParagraphs",value:function(e){this.persistenceService.remove(this.getAdventurePersistenceKey(e));for(var t=this.getAdventureParagraphKeys(e),a=0;a<t.length;a++)this.persistenceService.remove(t[a])}},{key:"setParagraph",value:function(e,t,a){var n=this.getParagraphPersistenceKey(e,t.paragraphNr);if(a){var r=this.persistenceService.get(n);if(r)return void this.messagesService.errorMessage(this.$translate.instant("DupplicateParagraph",{paragraphNr:t.paragraphNr}),!0)}this.persistenceService.save(n,t)}},{key:"getOrCreateParagraph",value:function(e,t){var a=this.getParagraph(e,t);if(a)return a;var n={version:this.constants.version,adventureId:e,paragraphNr:t,description:""},r=this.getAdventure(e);return r.numberOfParagraphs||(r.numberOfParagraphs=0),r.numberOfParagraphs=r.numberOfParagraphs+1,this.updateAdventureWithoutParagraphs(r),this.updateParagraph(e,n),n}},{key:"getParagraph",value:function(e,t){var a=this.getParagraphPersistenceKey(e,t);return this.persistenceService.get(a)}},{key:"updateParagraph",value:function(e,t){if(t){t=JSON.parse(JSON.stringify(t));var a=this.getParagraphPersistenceKey(e,t.paragraphNr);this.persistenceService.save(a,t)}}},{key:"getParagraphChoices",value:function(e){var t=this.getDescriptionParagraphs(e.description),a=[];if(t)for(var n=0;n<t.length;n++)for(var r=t[n],i=0;i<r.length;i++){var s=r[i];s.choice&&a.push(s.text)}return a}},{key:"getDescriptionParagraphs",value:function(e){for(var t=this.getLines(e),a=[],n=0;n<t.length;n++){for(var r=t[n],i=[];this.hasChoice(r);){var s=r.indexOf("§"),o=r.indexOf("§",s+1),l=r.slice(0,s);l&&l.trim().length>0&&i.push({choice:!1,text:l});var c=r.slice(s+1,o);c&&c.trim().length>0&&i.push({choice:!0,text:c}),r=r.substr(o+1)}i.push({choice:!1,text:r}),a.push(i)}return a}},{key:"getLines",value:function(e){var t=[];if(e)for(var a=e.split("\n"),n=0;n<a.length;n++){var r=a[n];t.push(r)}return t}},{key:"hasChoice",value:function(e){var t=e.indexOf("§"),a=e.indexOf("§",t+1);return t!==-1&&a!==-1}},{key:"getAdventureParagraphKeys",value:function(e){for(var t=[],a=Object.keys(localStorage),n=this.constants.data.adventure+"."+e,r=0;r<a.length;r++)if(0===a[r].indexOf(this.constants.data.adventure)&&a[r].indexOf("paragraph.")!==-1){var i=a[r].substring(0,a[r].indexOf(".paragraph"));i===n&&t.push(a[r])}return t}},{key:"getParagraphPersistenceKey",value:function(e,t){return this.getAdventurePersistenceKey(e)+".paragraph."+t}},{key:"getAdventurePersistenceKey",value:function(e){var t=e;return 0!==t.indexOf(this.constants.data.adventure+".")&&(t=this.constants.data.adventure+"."+t),t}},{key:"exportAdventure",value:function(e){var t=this.getAdventure(e);if(t.stats)for(var a=0;a<t.stats.length;a++)delete t.stats[a].$$hashKey;t.downloadUrl,delete t.numberOfParagraphs,t=this.sortObjectKeys(t);var n=t.stats;delete t.stats;var r=t.items;return delete t.items,delete t.downloaded,t.items=r,t.stats=n,t.paragraphs=this.getParagraphs(e),t}},{key:"getParagraphs",value:function(e){for(var t=[],a=Object.keys(localStorage),n=this.constants.data.adventure+"."+e,r=0;r<a.length;r++)if(0===a[r].indexOf(n+".paragraph")){var i=a[r].substring(0,a[r].indexOf(".paragraph"));if(i===n){var s=this.persistenceService.get(a[r]);s&&(delete s.version,delete s.adventureId,s.notes&&0===s.notes.length&&delete s.notes,t.push(this.sortObjectKeys(s)))}}return t=this.sortParagraphs(t)}},{key:"sortObjectKeys",value:function(e){var t=void 0;if(null==e)t=e;else if(Array.isArray(e)){t=[];for(var a=0;a<e.length;a++)t.push(this.sortObjectKeys(e[a]))}else if("object"===("undefined"==typeof e?"undefined":n(e))){var r=Object.keys(e);if(r&&r.length>0){r=r.sort(),t={};for(var i=0;i<r.length;i++){var s=e[r[i]];s=this.sortObjectKeys(s),t[r[i]]=s}}else t=e}else t=e;return t}},{key:"sortParagraphs",value:function(e){return e.sort(this.compareParagraph)}},{key:"compareParagraph",value:function(e,t){return e||t?e?t?e.paragraphNr-t.paragraphNr:-1:1:0}}]),e}();t.default=i},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(96),o=n(s),l=i.default.module("app.components.services.persistence.library",[]).service("libraryPersistenceService",o.default);t.default=l},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r){a(this,e),this.remoteJsonRetrieverService=t,this.$q=n,this.adventurePersistenceService=r}return e.$inject=["remoteJsonRetrieverService","$q","adventurePersistenceService"],n(e,[{key:"downloadLibrary",value:function(e){var t=this,a=this.$q.defer(),n=this.remoteJsonRetrieverService.retrieveJson(e);return n.then(function(e){t.adventurePersistenceService.updateDownloadableAdventures(e),a.resolve("Success")},function(e){a.reject(e)}),a.promise}}]),e}();t.default=r},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t){a(this,e),this.messagesService=t,this.checkLocalStorageSupported()}return e.$inject=["messagesService"],n(e,[{key:"checkLocalStorageSupported",value:function(){this.isLocalStorageSupported=!0,this.testLocalStorageSupported()||(this.isLocalStorageSupported=!1,this.messagesService.errorMessage("The application cannot be used because the version of the browser is too old or because it is not possible to save data in 'localStorage'.",!0))}},{key:"testLocalStorageSupported",value:function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}}},{key:"findKeysWithPrefix",value:function(e){if(!this.isLocalStorageSupported)return null;for(var t=Object.keys(localStorage),a=[],n=0;n<t.length;n++)0===t[n].indexOf(e)&&a.push(t[n]);return a}},{key:"get",value:function(e){if(!this.isLocalStorageSupported)return null;var t=localStorage.getItem(e);if(null===t||"undefined"===t||void 0===t)return null;try{return JSON.parse(t)}catch(e){return t}}},{key:"save",value:function(e,t){this.isLocalStorageSupported&&("string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t)))}},{key:"remove",value:function(e){this.isLocalStorageSupported&&localStorage.removeItem(e)}},{key:"import",value:function(e){if(this.isLocalStorageSupported){this.cleanAllData();for(var t=JSON.parse(e),a=Object.keys(t),n=0;n<a.length;n++)this.save(a[n],t[a[n]])}}},{key:"export",value:function(){return JSON.stringify(localStorage)}},{key:"cleanAllData",value:function(){this.isLocalStorageSupported&&localStorage.clear()}},{key:"getUsedCapacity",value:function(){return this.isLocalStorageSupported?unescape(encodeURIComponent(JSON.stringify(localStorage))).length:0}},{key:"getRemainingCapacity",value:function(){for(var e="0123456789",t=this.repeat(e,10),a=this.repeat(t,10),n=this.repeat(a,10),r=this.repeat(n,10),i=this.repeat(r,10),s=[i,r,n,a,t,e],o=0;o<s.length;o++)for(;this.setLocalStorageWithoutError(s[o]););var l=this.getUsedCapacity();return delete localStorage.test,l}},{key:"getUsedCapacityInPercent",value:function(){var e=this.getUsedCapacity(),t=this.getRemainingCapacity(),a=e+t;return e/a*100}},{key:"setLocalStorageWithoutError",value:function(e){try{return localStorage.test=localStorage.test+e,!0}catch(e){return!1}}},{key:"repeat",value:function(e,t){for(var a=[];t--;)a.push(e);return a.join("")}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(99),o=n(s),l=i.default.module("app.components.services.persistence.map",[]).service("mapPersistenceService",o.default);t.default=l},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n){a(this,e),this.adventurePersistenceService=t,this.gamePersistenceService=n,this.nodeSequence=1}return e.$inject=["adventurePersistenceService","gamePersistenceService"],n(e,[{key:"getMap",value:function(e,t){var a=this.adventurePersistenceService.exportAdventure(e),n=this.getKnownNodes(e),r=this.createNodeRecursively(a.paragraphs,t,[],n);return r}},{key:"getKnownNodes",value:function(e){for(var t=this.gamePersistenceService.getGames(e),a=[],n=0;n<t.length;n++)for(var r=t[n],i=0;i<r.path.length;i++)a[r.path[i]]=!0;return a}},{key:"findParagraph",value:function(e,t){for(var a=0;a<e.length;a++)if(t==e[a].paragraphNr)return e[a];return null}},{key:"createNodeRecursively",value:function(e,t,a,n){var r=this.findParagraph(e,t);if(r&&n[t]){var i=a[r.paragraphNr],s=void 0;if(i)s=this.createNodeLink(r.paragraphNr,i);else{s=this.createNode(r),a[r.paragraphNr]=s.id;var o=this.adventurePersistenceService.getParagraphChoices(r);if(o){s.children=[];for(var l=0;l<o.length;l++)s.children.push(this.createNodeRecursively(e,o[l],a,n))}}return s}return this.createUnknownNode(t)}},{key:"createNode",value:function(e){var t={id:this.newNodeId(),name:e.paragraphNr};return e.notes&&(t.notes=e.notes),e.label&&(t.label=e.label),e.tag&&(t.tag=e.tag),t}},{key:"createNodeLink",value:function(e,t){var a={id:this.newNodeId(),name:e,linkNodeId:t};return a}},{key:"createUnknownNode",value:function(e){var t={id:this.newNodeId(),name:e,unknown:!0};return t}},{key:"newNodeId",value:function(){return this.nodeSequence++}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(101),o=n(s),l=i.default.module("app.components.services.dices",[]).service("dicesService",o.default);t.default=l},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(){a(this,e)}return n(e,[{key:"rollDices",value:function(e,t,a){for(var n=0,r=0;r<e;r++)n+=this.randomIntInclusive(t,a);return n}},{key:"randomIntInclusive",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(103),o=n(s),l=i.default.module("app.components.services.form-helper",[]).service("formHelperService",o.default);t.default=l},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t){a(this,e),this.messagesService=t}return e.$inject=["messagesService"],n(e,[{key:"setErrorFieldsAsDirty",value:function(e,t){e.$invalid&&(t&&this.messagesService.errorMessage("Please complete mandatory fields",!1),angular.forEach(e.$error,function(e){angular.forEach(e,function(e){e.$setDirty()})}))}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(105),o=n(s),l=i.default.module("app.components.services.remote-json-retriever",[]).service("remoteJsonRetrieverService",o.default);t.default=l},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n){a(this,e),this.$http=t,this.$q=n}return e.$inject=["$http","$q"],n(e,[{key:"retrieveJson",value:function(e){var t=this.$q.defer();return this.$http.get(e).then(function(a){a&&a.data?t.resolve(a.data):t.reject("Cannot get data from "+e)},function(a){t.reject("Cannot get data from "+e)}),t.promise}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=a(107),o=n(s),l=i.default.module("app.components.gui.components.language-picker",[]).service("languagePickerService",o.default);t.default=l},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(){function e(t,n,r){a(this,e),this.gamePersistenceService=t,this.$translate=n,this.constants=r,this.supportedLanguages=this.initSupportedLanguages()}return e.$inject=["gamePersistenceService","$translate","constants"],n(e,[{key:"initSupportedLanguages",value:function(){for(var e=[],t=0;t<this.constants.supportedLanguages.length;t++)e.push({code:this.constants.supportedLanguages[t]});return e}},{key:"getSupportedLanguages",value:function(){return this.supportedLanguages}},{key:"getSelectedLanguage",value:function(){var e=this.gamePersistenceService.getSelectedLanguage();if(e)return e;if(navigator.language){var t=void 0;for(t=0;t<this.constants.supportedLanguages.length;t++)if(this.constants.supportedLanguages[t]===navigator.language)return this.constants.supportedLanguages[t];for(t=0;t<this.constants.supportedLanguages.length;t++)if(0===navigator.language.indexOf(this.constants.supportedLanguages[t]))return this.constants.supportedLanguages[t]}return this.constants.supportedLanguages[0]}},{key:"changeLanguage",value:function(e){this.$translate.use(e),this.gamePersistenceService.setSelectedLanguage(e);for(var t=0;t<this.supportedLanguages.length;t++)this.supportedLanguages[t].selected=this.supportedLanguages[t].code===e}}]),e}();t.default=r},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),s=i.default.module("app.components.constants",[]).constant("constants",{version:"20171106",supportedLanguages:["en","fr"],data:{selectedLanguage:"selectedLanguage",adventure:"adventure",game:"game",library:"library"},url:{administration:"/administration",games:"/games",gameDetail:"/{adventureId}/{paragraphNr}/game/{gameId}",credits:"/credits",adventureDetail:"/adventures",libraryImport:"/library-import"},choices:{yes:"Yes",no:"No",ok:"Ok",cancel:"Cancel",display:"Display",continue:"Continue",remove:"Remove",export:"Export",download:"Download",adventure:"Adventure",game:"Game",restart:"Restart",createGame:"Create a game"},errors:{adventureAlreadyExist:"error.adventureAlreadyExist",missingMandatoryFields:"error.missingMandatoryFields"}});t.default=s},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(110),i=n(r);a(111);var s=function(){return{template:i.default,restrict:"E"}};t.default=s},function(e,t){e.exports="<div ui-view></div>"},function(e,t,a){var n=a(112);"string"==typeof n&&(n=[[e.id,n,""]]);a(38)(n,{});n.locals&&(e.exports=n.locals)},function(e,t,a){t=e.exports=a(37)(),t.push([e.id,".ng-invalid.ng-dirty:required{background-color:#f99!important}.error{color:#f99}.modal{display:none;position:fixed;z-index:9999;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,.4)}.modal-content{background-color:#fefefe;margin:15% auto;padding:20px;border:1px solid #888;width:30%}.close{float:right}.close:focus,.close:hover{color:#000;text-decoration:none;cursor:pointer}",""])}]);
//# sourceMappingURL=bundle.js.map