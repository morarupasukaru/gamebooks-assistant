<form name="itemsTableForm" novalidate="novalidate">
    <table class="table table-striped">
        <col style="width:10%">
        <col style="width:75%">
        <col style="width:5%">
        <col style="width:5%">
        <col style="width:5%">
        <thead>
        <tr>
            <th>{{ 'Quantity' | translate }}</th>
            <th>{{ 'Item' | translate }}</th>
            <th></th>
            <th></th>
            <th>
                <button type="button"
                        class="btn btn-default"
                        aria-label="{{ 'Add item' | translate}}"
                        title="{{ 'Add item' | translate}}"
                        ng-show="!$ctrl.hasEditedRow()"
                        ng-click="$ctrl.addRow()">
                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                </button>
            </th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="row in $ctrl.rows">
            <td ng-if="!$ctrl.isRowEdited(row)">
                {{ row.quantity }}
            </td>
            <td ng-if="$ctrl.isRowEdited(row)">
                <input required name="quantity" type="number" class="form-control" ng-model="row.quantity">
                <div class="error" ng-show="!row.quantity">
                    <!-- check error only on field -->
                    {{ 'Please fill the quantity' | translate }}
                </div>
            </td>

            <td ng-if="!$ctrl.isRowEdited(row)">
                {{ row.description | translate }}
            </td>
            <td ng-if="$ctrl.isRowEdited(row)">
                <input required name="description" type="text" class="form-control description" ng-model="row.description">
                <div class="error" ng-show="!row.description">
                    <!-- check error only on field -->
                    {{ 'Please fill the description' | translate }}
                </div>
            </td>

            <td>
                <button type="button" class="btn btn-success"
                        aria-label="{{ 'Save item changes' | translate}}"
                        title="{{ 'Save item changes' | translate}}"
                        ng-click="$ctrl.saveRowChanges(notesTableForm.$invalid)"
                        ng-show="$ctrl.isRowEdited(row)">
                    <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                </button>
            </td>

            <td>
                <button type="button" class="btn btn-danger"
                        aria-label="{{ 'Abort item changes' | translate}}"
                        title="{{ 'Abort item changes' | translate}}"
                        ng-click="$ctrl.abortRowChanges()"
                        ng-show="$ctrl.isRowEdited(row)">
                    <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span>
                </button>
            </td>

            <td>
                <button type="button" class="btn btn-default"
                        aria-label="{{ 'Edit item' | translate }} '{{ row.description | translate }}'"
                        title="{{ 'Edit item' | translate }} '{{ row.description | translate }}'"
                        ng-click="$ctrl.editRow(row)"
                        ng-show="!$ctrl.hasEditedRow()">
                    <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                </button>
                <button type="button" class="btn btn-danger"
                        aria-label="{{ 'Remove item' | translate }} '{{ row.description | translate }}'"
                        title="{{ 'Remove item' | translate }} '{{ row.description | translate }}'"
                        ng-click="$ctrl.displayRemovePopup(row)"
                        ng-disabled="$ctrl.addedRow"
                        ng-show="$ctrl.isRowEdited(row)">
                    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                </button>
            </td>
        </tr>
        </tbody>
    </table>
</form>

<popup config="{{ $ctrl.popupDeleteItemConfig }}"></popup>
