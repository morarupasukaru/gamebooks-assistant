<navbar></navbar>
<messages></messages>
<main>
    <div class="container bg-white" role="main">
        <div class="page-header">
            <h1>{{ 'Battle' | translate }}</h1>
        </div>

        <form name="battleTableForm" novalidate="novalidate">
            <table class="table">
                <col style="width:10%">
                <col style="width:10%">
                <col style="width:10%">
                <col style="width:5%">
                <col style="width:5%">
                <col style="width:60%">
                <thead>
                <tr>
                    <th></th>
                    <th>{{ 'Skill' | translate }}</th>
                    <th>{{ 'Stamina' | translate }}</th>
                    <th>
                        <button type="button" class="btn btn-default"
                                aria-label="{{ 'Add enemy' | translate}}"
                                title="{{ 'Add enemy' | translate}}"
                                ng-show="!$ctrl.hasEditedRow()"
                                ng-click="$ctrl.addRow()">
                            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                        </button>
                    </th>
                    <th></th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="row in $ctrl.rows">

                    <td ng-if="!$ctrl.isRowEdited(row)">
                        {{ row.name }}
                    </td>
                    <td ng-if="$ctrl.isRowEdited(row)">
                        <input required type="text" class="form-control" ng-model="row.name">
                        <div class="error" ng-show="!row.name">
                            {{ 'Please fill the name' | translate }}
                        </div>
                    </td>

                    <td ng-if="!$ctrl.isRowEdited(row)">
                        {{ row.skill }}
                    </td>
                    <td ng-if="$ctrl.isRowEdited(row)">
                        <input required type="number" class="form-control" ng-model="row.skill">
                        <div class="error" ng-show="!row.skill">
                            {{ 'Please fill the skill' | translate }}
                        </div>
                    </td>

                    <td ng-if="!$ctrl.isRowEdited(row)">
                        {{ row.stamina }}
                    </td>
                    <td ng-if="$ctrl.isRowEdited(row)">
                        <input required type="number" class="form-control" ng-model="row.stamina">
                        <div class="error" ng-show="!row.stamina">
                            {{ 'Please fill the stamina' | translate }}
                        </div>
                    </td>

                    <td>
                        <button type="button" class="btn btn-default"
                                aria-label="{{ 'Increment' | translate }} {{ 'Stamina' | translate }}"
                                title="{{ 'Increment' | translate }} {{ 'Stamina' | translate }}"
                                ng-click="$ctrl.increment(row)"
                                ng-show="!$ctrl.hasEditedRow()">
                            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                        </button>
                        <button type="button" class="btn btn-success"
                                aria-label="{{ 'Save enemy changes' | translate}}"
                                title="{{ 'Save enemy changes' | translate}}"
                                ng-click="$ctrl.saveRowChanges(notesTableForm.$invalid)"
                                ng-show="$ctrl.isRowEdited(row)">
                            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                        </button>
                    </td>

                    <td>
                        <button type="button" class="btn btn-default"
                                aria-label="{{ 'Decrement' | translate }} {{ 'Stamina' | translate }}"
                                title="{{ 'Decrement' | translate }} {{ 'Stamina' | translate }}"
                                ng-click="$ctrl.decrement(row)"
                                ng-show="!$ctrl.hasEditedRow()">
                            <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
                        </button>
                        <button type="button" class="btn btn-danger"
                                aria-label="{{ 'Abort enemy changes' | translate}}"
                                title="{{ 'Abort enemy changes' | translate}}"
                                ng-click="$ctrl.abortRowChanges()"
                                ng-show="$ctrl.isRowEdited(row)">
                            <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span>
                        </button>
                    </td>

                    <td>
                        <button type="button" class="btn btn-default"
                                aria-label="{{ 'Edit enemy' | translate }} '{{ row.name | translate }}'"
                                title="{{ 'Edit enemy' | translate }} '{{ row.name | translate }}'"
                                ng-click="$ctrl.editRow(row)"
                                ng-show="!$ctrl.hasEditedRow() && $ctrl.isEnemy(row)">
                            <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                        </button>
                        <button type="button" class="btn btn-danger"
                                aria-label="{{ 'Remove enemy' | translate }} {{ row.name | translate }}"
                                title="{{ 'Remove enemy' | translate }} '{{ row.name | translate }}'"
                                ng-click="$ctrl.displayRemovePopup(row)"
                                ng-disabled="$ctrl.addedRow"
                                ng-show="$ctrl.isRowEdited(row)">
                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                        </button>
                    </td>

                    <td></td>
                </tr>
                </tbody>
            </table>
        </form>

        <dices></dices>

        <popup config="{{ $ctrl.popupDeleteEnemyConfig }}"></popup>
</main>