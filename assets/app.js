!function(){"use strict";String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e})}(),function(e){"use strict";e._=e._||{};var t=e._;t.config=t.config||{};var n=t.config;n.storageKeys={savedLanguage:"savedLanguage",gamebooksList:"gamebooksList",adminEnabled:"adminEnabled",currentScreenId:"currentScreenId"},n.languages={default:"en",supported:["fr","en"]},n.texts={errorFeatureNotImplemented:"error-feature-not-implemented",errorLocalstorageUnavailable:"error-localstorage-unavailable",modalTitlePrefix:"modal-title-",modalTitleError:"modal-title-error",fr:"Francais",en:"English"},n.translatedTexts={en:{},fr:{}},n.translatedTexts.en[n.texts.errorLocalstorageUnavailable]="LocalStorage is required by the application but is unavailable.",n.translatedTexts.fr[n.texts.errorLocalstorageUnavailable]="LocalStorage est requis à l'application mais n'est pas disponible.",n.translatedTexts.en[n.texts.errorFeatureNotImplemented]="Functionality is not yet implemented.",n.translatedTexts.fr[n.texts.errorFeatureNotImplemented]="La fonctionnalité n'est pas encore implémentée.",n.translatedTexts.en[n.texts.modalTitleError]="ERROR",n.translatedTexts.fr[n.texts.modalTitleError]="ERREUR"}(this),function(e){"use strict";e._=e._||{};var t=e._;t.dom=t.dom||{};var n=t.dom;n.appendHtml=function(e,t){var n=document.createElement("div");for(n.innerHTML=t;n.children.length>0;)e.appendChild(n.children[0])},n.display=function(e){var t=document.getElementById(e);return!!t&&(t.classList.remove("hidden"),!0)},n.hide=function(e){var t=document.getElementById(e);return!!t&&(t.classList.add("hidden"),!0)},n.displayAllByCssSelector=function(e){var t=document.querySelectorAll(e);if(t)for(var n=0;n<t.length;n++)t[n].classList.remove("hidden")},n.hideAllByCssSelector=function(e){var t=document.querySelectorAll(e);if(t)for(var n=0;n<t.length;n++)t[n].classList.add("hidden")}}(this),function(e){"use strict";e._=e._||{};var t=e._;t.msg=t.msg||{};var n=t.msg;n.ids={modal:"modal",title:"modal-title",text:"modal-text"},n.errorUnsupportedFeature=function(){throw t.config.texts.errorFeatureNotImplemented},n.error=function(e){this._displayMessage("error",e)},n._displayMessage=function(e,n){var a=t.i18n.currentLanguage,o=t.config.translatedTexts[a][n];o||(o=n);var r=t.config.translatedTexts[a][t.config.texts.modalTitlePrefix+e];window.document.getElementById(this.ids.title).innerText=r,window.document.getElementById(this.ids.text).innerText=o,window.document.getElementById(this.ids.modal).style.display="block"},n.closeModal=function(){window.document.getElementById(this.ids.modal).style.display="none"},e.addEventListener&&e.addEventListener("error",function(e){t.msg.error(e.error.toString())})}(this),function(e){"use strict";e._=e._||{};var t=e._;t.data=t.data||{};var n=t.data,a=function(){void 0===n.isLocalStorageAvailable&&(n.isLocalStorageAvailable=function(){try{var t=e.localStorage,n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return!1}}())};n.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})};var o=function(e){if(a(),!n.isLocalStorageAvailable)return null;var t=localStorage.getItem(e);if(null==t||"undefined"===t)return null;try{return JSON.parse(t)}catch(e){return t}};n.getAllData=function(){var e={},t=Object.keys(localStorage);t=t.sort();for(var n=0;n<t.length;n++){var a=t[n];e[a]=o(a)}return e};var r=function(e,t){a(),n.isLocalStorageAvailable&&("string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t)))};n.getLanguage=function(){return o(t.config.storageKeys.savedLanguage)},n.setLanguage=function(e){r(t.config.storageKeys.savedLanguage,e)},n.getGamebooksList=function(){return o(t.config.storageKeys.gamebooksList)},n.setGamebooksList=function(e){r(t.config.storageKeys.gamebooksList,e)},n.isAdminEnabled=function(){return o(t.config.storageKeys.adminEnabled)},n.setAdminEnabled=function(e){r(t.config.storageKeys.adminEnabled,e)},n.getCurrentScreenId=function(){return o(t.config.storageKeys.currentScreenId)},n.setCurrentScreenId=function(e){r(t.config.storageKeys.currentScreenId,e)};var i=!1;n.initialize=function(){if(!i){if(a(),!n.isLocalStorageAvailable)throw t.config.texts.errorLocalstorageUnavailable;i=!0}}}(this),function(e){"use strict";e._=e._||{};var t=e._;t.ajax=t.ajax||{},t.ajax.loadJson=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=JSON.parse(this.responseText);t(e)}},n.open("GET",e,!0),n.send()}}(this),function(e){"use strict";e._=e._||{};var t=e._;t.i18n=t.i18n||{};var n=t.i18n;n.setLanguage=function(e){if(this.currentLanguage!==e){this.currentLanguage=e,t.data.setLanguage(e),document.getElementsByTagName("html")[0].lang=e,document.getElementById("footer-lang-"+e).classList.add("hidden");for(var n=0;n<t.config.languages.supported.length;n++)e!==t.config.languages.supported[n]&&document.getElementById("footer-lang-"+t.config.languages.supported[n]).classList.remove("hidden");this._forceReloadStylesheetIfNeeded(e)}},n._forceReloadStylesheetIfNeeded=function(e){var t=document.getElementById("i18n-testDiv"),n=window.getComputedStyle(t,":before").getPropertyValue("content");n&&n==='"'+e+'"'||this._forceReloadStylesheet(e)},n._forceReloadStylesheet=function(e){var n="forceReloadStylesheets",a=document.getElementById(n),o=n+".css?"+e;a?a.href=o:t.dom.appendHtml(document.getElementsByTagName("head")[0],'<link id="'+n+'" rel="stylesheet" href="'+o+'">')};var a=!1;n.initialize=function(){if(!a){if(!t.config)throw"config is unavailable";if(!t.data)throw"data is unavailable";var e=t.data.getLanguage();if(e)this.setLanguage(e);else{for(var n,o=navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage,r=0;r<t.config.languages.supported.length;r++){var i=t.config.languages.supported[r];if(o===i||o.startsWith(i+"-")){n=i;break}}n||(n=this.defaultLanguage),this.setLanguage(n)}a=!0}}}(this),function(e,t){"use strict";var n=e._;n.footer=n.footer||{};for(var a=n.footer,o=function(e,t){var n=document.getElementById("footer-language"),a=document.createElement("a");a.setAttribute("id","footer-lang-"+e),a.setAttribute("hreflang",e),a.setAttribute("onClick","_.i18n.setLanguage('"+e+"');"),a.innerHTML='<span class="icon icon-globe"></span><span class="spanLang">&nbsp;'+t+"&nbsp;</span>";var o=n.firstChild;n.insertBefore(a,o)},r=n.config.languages.supported,i=0;i<r.length;i++)o(r[i],n.config.texts[r[i]]);a.displayHomepageFooter=function(){n.dom.display("footer-githubLink"),n.dom.hide("footer-lefttext"),n.dom.hide("footer-homeLink")},a.displayChildFooter=function(){n.dom.display("footer-lefttext"),n.dom.display("footer-homeLink"),n.dom.hide("footer-githubLink")};var s=!1;a.initialize=function(){s||(document.getElementById("footer-homeLink").setAttribute("href",n.route.getHomeUrl()),s=!0)}}(this),function(e){"use strict";e._=e._||{};var t=e._,n=!1;t.screens=t.screens||[],t.screens.push({id:"home",routeUrl:null,initialize:function(){n||(document.getElementById("screen-home-showDataBtn").href=t.route.getScreenUrl("dataOfApplication"),n=!0)},display:function(){t.dom.display("screen-homepage")&&t.footer.displayHomepageFooter()},hide:function(){t.dom.hide("screen-homepage")}})}(this),function(e){"use strict";e._=e._||{};var t=e._,n=!1;t.screens=t.screens||[],t.screens.push({id:"pageNotFound",routeUrl:"404",initialize:function(){n||(document.getElementById("screen-pageNotFound-backToHomeBtn").setAttribute("href",t.route.getHomeUrl()),n=!0)},display:function(){t.dom.display("screen-pageNotFound")&&t.footer.displayChildFooter()},hide:function(){t.dom.hide("screen-pageNotFound")}})}(this),function(e){"use strict";e._=e._||{};var t=e._,n=function(){t.dom.display("screen-localStorageData")&&t.footer.displayChildFooter()},a=function(){t.dom.hide("screen-localStorageData")},o=!1,r=function(){o||(o=!0)},i=function(e){document.getElementById("screen-localStorageData-code").innerHTML=e},s=function(e,t,n){var a=document.getElementById(e);a.setAttribute("data-fr",t),a.setAttribute("data-en",n)};t.screens=t.screens||[],t.screens.push({id:"dataOfGamebooks",routeUrl:"data-gamebooks",initialize:function(){r(),s("screen-localStorageData-title","Données de la liste des livres-jeux","Gamebooks list data"),s("screen-localStorageData-backToHomeBtn","Retour à la liste des livres-jeux","Back to gamebooks list"),i(JSON.stringify(t.data.getGamebooksList(),null,"\t"));var e=document.getElementById("screen-localStorageData-backToHomeBtn"),n=t.route.getScreenUrl("gamebooks");e.setAttribute("href",n)},display:n,hide:a}),t.screens.push({id:"dataOfApplication",routeUrl:"data-application",initialize:function(){r(),s("screen-localStorageData-title","Données de l'application","Data of the application"),s("screen-localStorageData-backToHomeBtn","Retour à l'acceuil","Back to home"),i(JSON.stringify(t.data.getAllData(),null,"\t"));var e=document.getElementById("screen-localStorageData-backToHomeBtn"),n=t.route.getHomeUrl();e.setAttribute("href",n)},display:n,hide:a})}(this),function(e){"use strict";e._=e._||{};var t=e._;t.screens=t.screens||[],t.screens.push({id:"gamebook",routeUrl:"gamebook",initialize:function(){},display:function(){t.dom.display("screen-gamebook")&&t.footer.displayChildFooter()},hide:function(){t.dom.hide("screen-gamebook")}})}(this),function(e){"use strict";e._=e._||{};var t,n=e._,a="screen-gamebooks-chooseAdventureDiv",o=!1;n.screens=n.screens||[],n.screens.push({id:"gamebooks",routeUrl:"gamebooks",initialize:function(){if(document.getElementById(a)){var e=n.data.getGamebooksList();!e||t&&t===e.version||(function(e){if(e){var t,o,r,i=[],s={};for(t=0;t<e.length;t++)r=e[t].serie,-1===i.indexOf(r)&&(i.push(r),s[r]=[]),s[r].push(e[t]);for(i.sort(),t=0;t<i.length;t++){r=i[t],g=r,n.dom.appendHtml(document.getElementById(a),'<div class="pure-u-1"><h2 class="screen-gamebooks-serie">'+g+"</h2></div>");var l=s[r];for(l=l.sort(function(e,t){return e.order-t.order}),o=0;o<l.length;o++)d=l[o],c=l.length,u=void 0,d&&(u=c>2?" pure-u-lg-1-3":c>1?" pure-u-lg-1-2":"",n.dom.appendHtml(document.getElementById(a),'<div class="pure-u-1'+u+'"><div class="margin-right"><a class="button u-full-width screen-gamebooks-book" href="'+n.route.getScreenUrl("gamebook")+'">'+d.name+"</a></div></div>"))}}var d,c,u,g}(e.gamebooks),t=e.version),o||(document.getElementById("screen-gamebooks-showDataBtn").href=n.route.getScreenUrl("dataOfGamebooks"),o=!0)}},display:function(){n.dom.display("screen-gamebooks")&&n.footer.displayChildFooter()},hide:function(){n.dom.hide("screen-gamebooks")}})}(this),function(e){"use strict";e._=e._||{};var t=e._;t.route=t.route||{};var n=t.route,a=function(e){var t={};if(e){e.startsWith("?")&&(e=e.substr(1,e.length));var n,a=e.split("&");if(a)for(n=0;n<a.length;n++){var o=a[n].split("="),r=o[0],i=null;o.length>1&&(i=o[1]),t[r]=i}}return t},o=function(){var t,n,o,r=(t={},e.location&&e.location.search&&(t=a(e.location.search)),t),i=function(){var t={};if(e.location&&e.location.hash){var n=e.location.hash.split("?");n.length>1&&(t=a(n[1]))}return t}();return n=r,o=i,Object.keys(o).forEach(function(e){n[e]=o[e]}),n},r=function(e){var n=".only-visible-by-admin";e?t.dom.displayAllByCssSelector(n):t.dom.hideAllByCssSelector(n)},i={"http://morarupasukaru.github.io":"/gamebooks-assistant#"};n.getHomeUrl=function(){var t=e.location.host,n=i[t];return n||(n="#"),n},n.getScreenUrl=function(e){var a;if(t.screens)for(var o=n.getHomeUrl(),r=0;r<t.screens.length;r++){var i=t.screens[r];if(i.id===e){a=o+i.routeUrl;break}}return a};var s=function(e){if(t.screens)for(var n=0;n<t.screens.length;n++){var a=t.screens[n];if(a.routeUrl===e)return a}return null},l=s("404"),d=function(){var n,a,o,r=s((o=null,e.location&&e.location.hash&&(n=e.location.hash,a=null,n&&-1!==n.indexOf("#")&&(-1!==(a=n.startsWith("#")?n.substring(1):n.split("#")[1]).indexOf("?")&&(a=a.startsWith("?")?null:a.split("?")[0]),a&&-1!==a.indexOf("/")&&(a=a.startsWith("/")?null:a.split("/")[0])),o=a),o));r||(r=l);var i,d=t.data.getCurrentScreenId();d&&(i=function(e){if(t.screens)for(var n=0;n<t.screens.length;n++){var a=t.screens[n];if(a.id===e)return a}return null}(d)),i&&r.id!==i.id?(r.initialize(),i.hide(),r.display()):(r.initialize(),r.display()),t.data.setCurrentScreenId(r.id)},c=function(e){var n,a,i,s,l;n=e,i=o(),s=Object.keys(i),l=!!t.data.isAdminEnabled(),-1!==s.indexOf("adminEnabled")?(a=!0,t.data.setAdminEnabled(a)):-1!==s.indexOf("adminDisabled")&&(a=!1,t.data.setAdminEnabled(a)),(n||void 0!==a)&&r(void 0!==a&&l!==a?!!a:l),d()};e.onhashchange=function(){c()};var u=!1;n.initialize=function(){u||(c(!0),u=!0)}}(this),function(e){"use strict";var t=e._;t.i18n.initialize(),t.data.initialize(),t.footer.initialize(),t.route.initialize()}(this);