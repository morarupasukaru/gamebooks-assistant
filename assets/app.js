!function(){"use strict";String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e})}(),function(e){"use strict";e._=e._||{};var t=e._;t.config=t.config||{};var n=t.config;n.languages={default:"en",supported:["fr","en"]},n.texts={fr:"Francais",en:"English"}}(this),function(e){"use strict";e._=e._||{};var i=e._;i.dom=i.dom||{};var t=i.dom;t.appendHtml=function(e,t){var n=document.createElement("div");for(n.innerHTML=t;0<n.children.length;)e.appendChild(n.children[0])},t.removeCssClass=function(e,t){var n=document.getElementById(e);return!!n&&(n.classList.remove(t),!0)},t.display=function(e){return t.removeCssClass(e,"hidden")},t.addCssClass=function(e,t){var n=document.getElementById(e);return!!n&&(n.classList.add(t),!0)},t.hide=function(e){return t.addCssClass(e,"hidden")},t.displayAllByCssSelector=function(e){var t=document.querySelectorAll(e);if(t)for(var n=0;n<t.length;n++)t[n].classList.remove("hidden")},t.hideAllByCssSelector=function(e){var t=document.querySelectorAll(e);if(t)for(var n=0;n<t.length;n++)t[n].classList.add("hidden")},t.setPlaceholderText=function(e,t,n){var r=document.getElementById(e);"fr"===i.data.getLanguage()?r.setAttribute("placeholder",t):r.setAttribute("placeholder",n)},t.setText=function(e,t,n){var r=document.getElementById(e);r&&(r.setAttribute("data-fr",t),r.setAttribute("data-en",n))},t.setHrefOfScreen=function(e,t){var n=document.getElementById(e);if(n){var r=i.route.getScreenUrl(t);n.setAttribute("href",r)}}}(this),function(e){"use strict";e._=e._||{};var t=e._;e.addEventListener&&e.addEventListener("error",function(e){t.data.addJavascriptError(e)})}(this),function(r){"use strict";r._=r._||{};var e=r._;e.data=e.data||{};var i=e.data,t=function(e){try{var t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}},n=function(){if(void 0===i.isWebStorageAvailable)try{i.isWebStorageAvailable=t(r.sessionStorage)&&t(r.localStorage)}catch(e){i.isWebStorageAvailable=!1}},o=function(e){return n(),e?sessionStorage:localStorage};i.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})};var a=function(e,t){var n=o(t).getItem(e);if(null==n||"undefined"===n)return null;try{return JSON.parse(n)}catch(e){return n}};i.getAllData=function(e){return function(e){var t={},n=Object.keys(e);n=n.sort();for(var r=0;r<n.length;r++){var i=n[r];t[i]=a(i)}return t}(o(e))};var s=function(e,t,n){var r=o(n);"string"==typeof t?r.setItem(e,t):r.setItem(e,JSON.stringify(t))},d="savedLanguage";i.getLanguage=function(){return a(d)},i.setLanguage=function(e){s(d,e)};var u="gamebooksList";i.getGamebooksList=function(){return a(u)},i.setGamebooksList=function(e){s(u,e)};var c="debugEnabled";i.isDebugEnabled=function(){return a(c)},i.setDebugEnabled=function(e){s(c,e)};var l="currentScreenId";i.getCurrentScreenId=function(){return a(l)},i.setCurrentScreenId=function(e){s(l,e)};var f="javascript-errors";i.getJavascriptErrors=function(){var e=a(f,!0);return e||[]},i.addJavascriptError=function(e){var t=i.getJavascriptErrors(!0),n=e&&e.error?e.error.toString():"error without detail";t.push({date:new Date,url:r.location.href,error:n}),s(f,t,!0)};var g=!(i.clearJavascriptErrors=function(){var e;e=f,o(!0).removeItem(e)});i.initialize=function(){g||(n(),g=!0)}}(this),function(e){"use strict";e._=e._||{};var t=e._;t.ajax=t.ajax||{},t.ajax.loadJson=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=JSON.parse(this.responseText);t(e)}},n.open("GET",e,!0),n.send()}}(this),function(e){"use strict";e._=e._||{};var o=e._;o.i18n=o.i18n||{};var t=o.i18n;t.setLanguage=function(e){if(this.currentLanguage!==e){this.currentLanguage=e,o.data.setLanguage(e),document.getElementsByTagName("html")[0].lang=e,o.dom.hide("footer-lang-"+e+"-id");for(var t=0;t<o.config.languages.supported.length;t++)e!==o.config.languages.supported[t]&&o.dom.display("footer-lang-"+o.config.languages.supported[t]+"-id");this._forceReloadStylesheetIfNeeded(e);var n=o.route.getCurrentScreen();n&&n.onLanguageChange&&n.onLanguageChange(e)}},t._forceReloadStylesheetIfNeeded=function(e){var t=document.getElementById("i18n-test-id"),n=window.getComputedStyle(t,":before").getPropertyValue("content");n&&n==='"'+e+'"'||this._forceReloadStylesheet(e)};var a=!(t._forceReloadStylesheet=function(e){var t="i18n-forcecssreload-id",n=document.getElementById(t),r=t+".css?"+e;n?n.href=r:o.dom.appendHtml(document.getElementsByTagName("head")[0],'<link id="'+t+'" rel="stylesheet" href="'+r+'">')});t.initialize=function(){if(!a){var e=o.data.getLanguage();if(e)this.setLanguage(e);else{for(var t,n=navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage,r=0;r<o.config.languages.supported.length;r++){var i=o.config.languages.supported[r];if(n===i||n.startsWith(i+"-")){t=i;break}}t||(t=this.defaultLanguage),this.setLanguage(t)}a=!0}}}(this),function(e){"use strict";var t=e._;t.footer=t.footer||{};for(var n=t.footer,r=function(e,t){var n=document.getElementById("footer-lang-id"),r=document.createElement("a");r.setAttribute("id","footer-lang-"+e+"-id"),r.setAttribute("hreflang",e),r.setAttribute("onClick","_.i18n.setLanguage('"+e+"');"),r.innerHTML='<span class="icon icon-globe"></span><span class="spanLang">&nbsp;'+t+"&nbsp;</span>";var i=n.firstChild;n.insertBefore(r,i)},i=t.config.languages.supported,o=0;o<i.length;o++)r(i[o],t.config.texts[i[o]]);n.displayHomepageFooter=function(){t.dom.display("footer-github-id"),t.dom.hide("footer-left-id"),t.dom.hide("footer-home-id")};var a=!(n.displayChildFooter=function(){t.dom.display("footer-left-id"),t.dom.display("footer-home-id"),t.dom.hide("footer-github-id")});n.initialize=function(){a||(t.dom.setHrefOfScreen("footer-home-id","home"),t.dom.display("footer-id"),a=!0)}}(this),function(e){"use strict";e._=e._||{};var t=e._,n=!1;t.screens=t.screens||[],t.screens.push({id:"home",routeUrl:[],initialize:function(){n||(t.dom.setHrefOfScreen("home-showdebug-id","debug"),n=!0)},display:function(){t.dom.display("home-id")&&t.footer.displayHomepageFooter()},hide:function(){t.dom.hide("home-id")}})}(this),function(e){"use strict";e._=e._||{};var n=e._,t=!1;n.screens=n.screens||[],n.screens.push({id:"debug",routeUrl:["debug"],initialize:function(){t||(n.dom.setHrefOfScreen("debug-showdata-id","dataOfApplication"),n.dom.setHrefOfScreen("debug-back-id","home"),t=!0)},display:function(){n.dom.display("debug-id")&&n.footer.displayChildFooter();var e=n.data.getJavascriptErrors(),t=e?e.length:0;n.dom.setText("debug-showerrors-id",t+" erreurs javascript",t+" javascript errors"),t?n.dom.addCssClass("debug-showerrors-id","button-primary"):n.dom.removeCssClass("debug-showerrors-id","button-primary")},hide:function(){n.dom.hide("debug-id")}})}(this),function(e){"use strict";e._=e._||{};var t=e._,n=!1;t.screens=t.screens||[],t.screens.push({id:"pageNotFound",routeUrl:["404"],initialize:function(){n||(t.dom.setHrefOfScreen("404-back-id","home"),n=!0)},display:function(){t.dom.display("404-id")&&t.footer.displayChildFooter()},hide:function(){t.dom.hide("404-id")}})}(this),function(e){"use strict";e._=e._||{};var t=e._,n=function(){t.dom.display("data-id")&&t.footer.displayChildFooter()},r=function(){t.dom.hide("data-id")},i=!1,o=function(){i||(i=!0)},a=function(e){document.getElementById("data-code-id").innerHTML=e};t.screens=t.screens||[],t.screens.push({id:"dataOfGamebooks",routeUrl:["data-gamebooks"],initialize:function(){o(),t.dom.setText("data-title-id","Données de la liste des livres-jeux","Gamebooks list data"),t.dom.setText("data-back-id","Retour à la liste des livres-jeux","Back to gamebooks list"),a(JSON.stringify(t.data.getGamebooksList(),null,"\t")),t.dom.setHrefOfScreen("data-back-id","gamebooks")},display:n,hide:r}),t.screens.push({id:"dataOfApplication",routeUrl:["data-application"],initialize:function(){o(),t.dom.setText("data-title-id","Données de l'application","Data of the application"),t.dom.setText("data-back-id","Retour à l'écran de débogage","Back to debug screen"),a(JSON.stringify(t.data.getAllData(),null,"\t")),t.dom.setHrefOfScreen("data-back-id","debug")},display:n,hide:r})}(this),function(e){"use strict";e._=e._||{};var t=e._;t.screens=t.screens||[],t.screens.push({id:"gamebook",routeUrl:["gamebook"],initialize:function(){},display:function(){t.dom.display("book-id")&&t.footer.displayChildFooter()},hide:function(){t.dom.hide("book-id")}})}(this),function(e){"use strict";e._=e._||{};var t,l=e._,f="books-choose-id",n=!1;l.screens=l.screens||[],l.screens.push({id:"gamebooks",routeUrl:["gamebooks"],initialize:function(){if(document.getElementById(f)){var e=l.data.getGamebooksList();!e||t&&t===e.version||(function(e){if(e){var t,n,r,i=[],o={};for(t=0;t<e.length;t++)r=e[t].serie,-1===i.indexOf(r)&&(i.push(r),o[r]=[]),o[r].push(e[t]);for(i.sort(),t=0;t<i.length;t++){r=i[t],c=r,l.dom.appendHtml(document.getElementById(f),'<div class="pure-u-1"><h2 class="books-serie">'+c+"</h2></div>");var a=o[r];for(a=a.sort(function(e,t){return e.order-t.order}),n=0;n<a.length;n++)s=a[n],d=a.length,u=void 0,s&&(u=2<d?" pure-u-lg-1-3":1<d?" pure-u-lg-1-2":"",l.dom.appendHtml(document.getElementById(f),'<div class="pure-u-1'+u+'"><div class="margin-right"><a class="button u-full-width books-book" href="'+l.route.getScreenUrl("gamebook")+'">'+s.name+"</a></div></div>"))}}var s,d,u,c}(e.gamebooks),t=e.version),n||(l.dom.setHrefOfScreen("books-showdata-id","dataOfGamebooks"),l.dom.setHrefOfScreen("books-add-id","newGamebook"),n=!0)}},display:function(){l.dom.display("books-id")&&l.footer.displayChildFooter()},hide:function(){l.dom.hide("books-id")}})}(this),function(e){"use strict";e._=e._||{};var t=e._,n=function(){t.dom.setPlaceholderText("book-new-title-id","Titre du livre-jeu","Title of the gamebook"),t.dom.setPlaceholderText("book-new-serie-id","Serie du livre-jeu","Serie of the gamebook")},r=!1;t.screens=t.screens||[],t.screens.push({id:"newGamebook",routeUrl:["gamebook","new"],initialize:function(){r||(n(),t.dom.setHrefOfScreen("book-new-cancel-id","gamebooks"),r=!0)},display:function(){t.dom.display("book-new-id")&&t.footer.displayChildFooter(),document.getElementById("book-new-title-id").value="",document.getElementById("book-new-serie-id").value="",document.getElementById("book-new-title-id").focus()},hide:function(){t.dom.hide("book-new-id")},onLanguageChange:n,onSubmit:function(){t.route.setCurrentScreenWithId("gamebook")}})}(this),function(a){"use strict";a._=a._||{};var s=a._;s.route=s.route||{};var d=s.route,o=function(e){var t={};if(e){e.startsWith("?")&&(e=e.substr(1,e.length));var n,r=e.split("&");if(r)for(n=0;n<r.length;n++){var i=r[n].split("="),o=i[0],a=null;1<i.length&&(a=i[1]),t[o]=a}}return t},u=function(){var e,t,n,r=(e={},a.location&&a.location.search&&(e=o(a.location.search)),e),i=function(){var e={};if(a.location&&a.location.hash){var t=a.location.hash.split("?");1<t.length&&(e=o(t[1]))}return e}();return t=r,n=i,Object.keys(n).forEach(function(e){t[e]=n[e]}),t},c=function(e){var t=".only-visible-by-debug";e?s.dom.displayAllByCssSelector(t):s.dom.hideAllByCssSelector(t)},n={"http://morarupasukaru.github.io":"/gamebooks-assistant#"};d.getHomeUrl=function(){var e=a.location.host,t=n[e];return t||(t="#"),t},d.getScreenUrl=function(e){var t;if(s.screens)for(var n=d.getHomeUrl(),r=0;r<s.screens.length;r++){var i=s.screens[r];if(i.id===e){t=n+i.routeUrl.join("/");break}}return t};var l=function(e){if(s.screens)for(var t=0;t<s.screens.length;t++){var n=s.screens[t],r=n.routeUrl;if(Array.isArray(r)||(r=[r]),r.length===e.length){for(var i=!0,o=0;o<r.length;o++)if(r[o]!==e[o]){i=!1;break}if(i)return n}}return null},r=function(e){if(s.screens)for(var t=0;t<s.screens.length;t++){var n=s.screens[t];if(n.id===e)return n}return null};d.getCurrentScreen=function(){var e,t=s.data.getCurrentScreenId();return t&&(e=r(t)),e};var f=l(["404"]);d.setCurrentScreen=function(e){var t=d.getCurrentScreen();t&&e.id!==t.id?(e.initialize(),t.hide()):e.initialize(),e.display(),s.data.setCurrentScreenId(e.id)},d.setCurrentScreenWithId=function(e){var t=r(e);t&&(window.location.assign(s.route.getScreenUrl(e)),d.setCurrentScreen(t))};var g=function(){var e,t,n,r,i,o=l((e=[],a.location&&a.location.hash&&(t=a.location.hash,i=[],t&&-1!==t.indexOf("#")&&(r=-1!==(n=t.startsWith("#")?t.substring(1):t.split("#")[1]).indexOf("?")?n.startsWith("?")?null:n.split("?")[0]:n)&&(i=r.split("/")),e=i),e));o||(o=f),d.setCurrentScreen(o)},e=function(e){var t,n,r,i,o;t=e,r=u(),i=Object.keys(r),o=!!s.data.isDebugEnabled(),-1!==i.indexOf("debugEnabled")?(n=!0,s.data.setDebugEnabled(n)):-1!==i.indexOf("debugDisabled")&&(n=!1,s.data.setDebugEnabled(n)),(t||void 0!==n)&&c(void 0!==n&&o!==n?!!n:o),function(){var e=u(),t=Object.keys(e);if(s.data.isDebugEnabled()&&-1!==t.indexOf("error"))throw"error_"+s.data.uuid()}(),g()},t=!(a.onhashchange=function(){e()});d.initialize=function(){t||(e(!0),t=!0)}}(this),function(e){"use strict";e._=e._||{};var t=e._;t.form=t.form||{};var n=t.form;n.onSubmit=function(){var e=t.route.getCurrentScreen();e&&e.onSubmit&&e.onSubmit()},n.submit=function(){document.getElementById("submit-id").click()}}(this),function(e){"use strict";var t=e._;t.dom.hide("nojs-id");t.data.initialize(),t.data.isWebStorageAvailable?(t.i18n.initialize(),t.footer.initialize(),t.route.initialize()):t.dom.display("nostorage-id")}(this);