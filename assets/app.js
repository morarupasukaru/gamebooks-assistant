String.prototype.startsWith||(String.prototype.startsWith=function(e,t){"use strict";return t=t||0,this.substr(t,e.length)===e}),function(e){"use strict";e._=e._||{},e._.dom=e._.dom||{};e._.dom.appendHtml=function(e,t){var a=document.createElement("div");for(a.innerHTML=t;a.children.length>0;)e.appendChild(a.children[0])}}(this),function(e){"use strict";e._=e._||{},e._.msg=e._.msg||{};var t=e._.msg;t.ids={modal:"modal",title:"modalTitle",text:"modalText"},t.error=function(e){this._displayMessage("error",e)},t._displayMessage=function(e,t){var a=_.i18n.currentLanguage,i=_.i18n.texts[a][t],n=_.i18n.texts[a]["modal-title-"+e];window.document.getElementById(this.ids.title).innerText=n;window.document.getElementById(this.ids.text).innerText=i;window.document.getElementById(this.ids.modal).style.display="block"},t.closeModal=function(){window.document.getElementById(this.ids.modal).style.display="none"}}(this),function(e){"use strict";e._=e._||{},e._.data=e._.data||{};var t=e._.data;t.initialized=!1,t.get=function(e){if(this.lazyInitialisation(),!this.isLocalStorageAvailable)return null;var t=localStorage.getItem(e);if(null===t||"undefined"===t||void 0===t)return null;try{return JSON.parse(t)}catch(e){return t}},t.save=function(e,t){this.lazyInitialisation(),this.isLocalStorageAvailable&&("string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t)))};t.ids={language:"gamebooks-assistant.language"},t.lazyInitialisation=function(){this.initialized||(this.isLocalStorageAvailable=function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}}(),this.initialized=!0)},t.initialize=function(){if(this.lazyInitialisation(),!_.msg)throw"msg is unavailable";this.isLocalStorageAvailable&&_.msg.error("error-localstorage-unavailable")}}(this),function(e){"use strict";e._=e._||{},e._.i18n=e._.i18n||{};var t=e._.i18n;t.setLanguage=function(e){if(this.currentLanguage!==e){this.currentLanguage=e,_.data.save(_.data.ids.language,e);document.getElementsByTagName("html")[0].lang=e,document.getElementById("link_"+e).classList.add("hidden");for(var a=0;a<t.supportedLanguages.length;a++)e!==t.supportedLanguages[a]&&document.getElementById("link_"+t.supportedLanguages[a]).classList.remove("hidden");this._forceReloadStylesheetIfNeeded(e)}},t._forceReloadStylesheetIfNeeded=function(e){var t=document.getElementById("test-i18n"),a=window.getComputedStyle(t,":before").getPropertyValue("content");a&&a==='"'+e+'"'||this._forceReloadStylesheet(e)},t._forceReloadStylesheet=function(e){var t="forceReloadStylesheets",a=document.getElementById(t),i=t+".css?"+e;a?a.href=i:_.dom.appendHtml(document.getElementsByTagName("head")[0],'<link id="'+t+'" rel="stylesheet" href="'+i+'">')},t.supportedLanguages=["fr","en"],t.defaultLanguage="en",t.texts={en:{"error-localstorage-unavailable":"LocalStorage is required by the application but is unavailable","modal-title-error":"ERROR"},fr:{"error-localstorage-unavailable":"LocalStorage est requis Ã  l'application mais n'est pas disponible","modal-title-error":"ERREUR"}},t.initialize=function(){if(!_.data)throw"data is unavailable";var e=_.data.get(_.data.ids.language);if(e)this.setLanguage(e);else{for(var a,i=navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage,n=0;n<t.supportedLanguages.length;n++){var s=t.supportedLanguages[n];if(i===s||i.startsWith(s+"-")){a=s;break}}a||(a=this.defaultLanguage),this.setLanguage(a)}}}(this),_.i18n.initialize(),_.data.initialize();