webpackJsonp([0],[function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=r(1),i=a(n),s=r(2),o=a(s),l=r(3),c=a(l),u=r(5),d=a(u),p=r(6),h=a(p),f=r(7),g=a(f),v=r(8),m=a(v),b=r(109),y=a(b);c.default.module("app",[d.default,h.default,g.default,m.default.name]).config(["$translateProvider",function(e){e.translations("en",i.default),e.translations("fr",o.default),e.preferredLanguage("en"),e.useSanitizeValueStrategy("escape"),e.useMissingTranslationHandlerLog()}]).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|file|blob):/)}]).directive("onReadFile",["$parse",function(e){return{restrict:"A",scope:!1,link:function(t,r,a){var n=e(a.onReadFile);r.on("change",function(e){var r=new FileReader;r.onload=function(e){t.$apply(function(){n(t,{$fileContent:e.target.result})})},r.readAsText((e.srcElement||e.target).files[0])})}}}]).directive("app",y.default)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Add:"Add",Administration:"Administration",AdventureAlreadyExists:"The adventure already exists with id '{{ adventure }}'",AdventureDownloaded:"Adventure '{{ adventure }}' is downloaded",Adventure:"Adventure",Adventures:"Adventures","All existing application's data will be erased during the import. Are you sure to import the application data?":"All existing application's data will be erased during the import. Are you sure to import the application data?","Application's data":"Application's data","Application's version":"Application's version","application.description":"ease the resolution of gamebooks","Are you sure to clear the application data?":"Are you sure to clear the application data?","Are you sure to download the selected adventure? Existing games could be non-playable after the update if the new version is not retro-compatible":"Are you sure to download the selected adventure? Existing games could be non-playable after the update if the new version is not retro-compatible","Are you sure to restart the selected game?":"Are you sure to restart the selected game?","Are you sure to remove the character?":"Are you sure to remove the character?","Are you sure to remove the selected adventure?":"Are you sure to remove the selected adventure?","Are you sure to remove the selected game?":"Are you sure to remove the selected game?",attributValueGenerationRule:"{{ dicesQuantity}} dices[{{ min }},{{ max }}] + {{ constant }}","Author(s)":"Author(s)",Back:"Back",Battle:"Battle",Cancel:"Cancel",CannotImportProjectAon:"Cannot import project aon book with url '{{ url }}'","Cannot import adventure":"Cannot import adventure","Cannot import game":"Cannot import game","Change language to en":"Change language to english","Change language to fr":"Changez la langue en français",Characters:"Characters","Choose an action":"Choose an action",Clear:"Clear",Collapse:"Collapse",Constant:"Constant",Continue:"Continue",Create:"Create","Create an adventure":"Create an adventure","Create a game":"Create a game",Credits:"Credits",credit_description_javascript:"language",credit_description_map_image:"map image used as favicon",credit_description_estawebjs:"development stack",credit_description_angularjs:"framework",credit_description_bootstrap:"framework",credit_description_webpack:"module bundler",credit_description_gulp:"build system",credit_description_nodejs:"JavaScript runtime",credit_description_npm:"package manager for nodejs",credit_description_browsersync:"time-saving synchronised browser testing","credit_description_angular-translate":"i18n for AngularJS","credit_description_angular-ui-router":"flexible routing with nested views in AngularJS",credit_description_babel:"JavaScript compiler",credit_description_realfavicongenerator:"favicon generator",credit_description_github:"Online project hosting using Git",credit_description_article_sticky_footer:"article",credit_description_article_responsive_navigation_patterns:"article",Current:"Current","Decrease tree":"Decrease tree",DecrementStatsTitle:"Decrement '{{ stats }}'","Delete application's data":"Delete application's data",Description:"Description","description.syntax":"Surround paragraph number with § to add a choice (e.g. §123§)",Detail:"Detail",Dices:"Dices",dicesQuantity:"Quantity of dices[{{ min }},{{ max }}]",Display:"Display","Display actions":"Display actions","Display more paragraphs":"Display more paragraphs",Download:"Download","Download URL":"Download URL",downloadable_in_list:" (downloadable)",DupplicateParagraph:"The paragraph '{{paragraphNr}}' already exist",Edit:"Edit",en:"English",English:"English","Enable characters with stats":"Enable characters with stats","Enable dices":"Enable dices","Enable map":"Enable map","Enable Go to paragraph":"Enable Go to paragraph",Enemy:"Enemy",Expand:"Expand",Export:"Export",Features:"Features","First paragraph":"First paragraph",fr:"Français","Français":"Français",Game:"Game","Game's rules":"Game's rules","Game's rules paragraph":"Game's rules paragraph",GameAlreadyExists:"The game already exists with id '{{ gameId }}'",General:"General","Go to":"Go to","Go to paragraph":"Go to paragraph",Homepage:"Homepage",Home:"Home",Import:"Import","Imported data":"Imported data",ImportGameFailedMissingFields:"Cannot import game because of missing mandatory fields: '{{ missingMandatoryFields }}'","Increase tree":"Increase tree",IncrementStatsTitle:"Increment '{{ stats }}'",Initial:"Initial",ISBN:"ISBN","Keep on restart":"Keep on restart",Language:"Language",link:"link",Lists:"Lists",Map:"Map","Minimal dice's value":"Minimal dice's value","missing-adventure":"Missing adventure '{{ name }}'","MIT License":"MIT License","Maximal dice's value":"Maximal dice's value",Name:"Name","New character":"New character","New entry":"New entry","New stats":"New stats",Next:"Next",No:"No","No adventure available":"No adventure available","No way further":"No way further",Ok:"Ok",Paragraph:"Paragraph","Paragraph link":"Paragraph link","Paragraph not played yet":"Paragraph not played","Paste the application's data copied from another browser":"Paste the application's data copied from another browser","Please complete mandatory fields":"Please complete mandatory fields","Please fill a value":"Please fill a value","Please fill the name":"Please fill the name","Please fill the name of the stats":"Please fill the name of the stats","Please fill the name of the game":"Please fill the name of the game","Remaining Local's Storage":"Remaining Local's Storage",Remove:"Remove","Remove the character":"Remove the character","Remove the stats":"Remove the stats",Restart:"Restart","Roll dice":"Roll dice",Save:"Save","Save changes":"Save changes",Serie:"Serie","sorted alphabetically":"sorted alphabetically","Sum of dices value":"Sum of dices value",Tag:"Tag","The adventure is not available":"The adventure is not available","The application cannot be used because the version of the browser is too old or because it is not possible to save data in 'localStorage'.":"The application cannot be used because the version of the browser is too old or because it is not possible to save data in 'localStorage'.","Used Local's Storage":"Used Local's Storage","Used Local's Storage in Percent":"Used Local's Storage in Percent",Version:"Version","Visible sections":"Visible sections","What must be imported?":"What must be imported?",Yes:"Yes"};t.default=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Add:"Ajoute",Administration:"Administration",AdventureAlreadyExists:"Une aventure existe déjà avec l'id '{{ adventure }}'",AdventureDownloaded:"L'aventure '{{ adventure }}' est téléchargée",Adventure:"Aventure",Adventures:"Aventures","All existing application's data will be erased during the import. Are you sure to import the application data?":"Toutes les données de l'application seront supprimées durant l'importation. Etes-vous certain(e) de vouloir importer les données?","Application's data":"Données de l'application","Application's version":"Version de l'application","application.description":"facilite la résolution de livres-jeux","Are you sure to clear the application data?":"Etes-vous certain(e) de vouloir supprimer les données de l'application?","Are you sure to download the selected adventure? Existing games could be non-playable after the update if the new version is not retro-compatible":"Etes-vous certain(e) de vouloir télécharger l'aventure sélectionnée? Les parties existantes pourraient ne plus être jouable suite à la mise-à-jour si celle-ci ne supporte pas de retro-compatibilité","Are you sure to restart the selected game?":"Etes-vous certain(e) de vouloir recommencer la partie séléectionnée?","Are you sure to remove the character?":"Etes-vous certain(e) de vouloir supprimer le personnage?","Are you sure to remove the selected adventure?":"Etes-vous certain(e) de vouloir supprimer l'aventure sélectionnée?","Are you sure to remove the selected game?":"Etes-vous certain(e) de vouloir supprimer la partie sélectionnée?",attributValueGenerationRule:"{{ dicesQuantity}} dés[{{ min }},{{ max }}] + {{ constant }}","Author(s)":"Auteur(s)",Back:"Retour",Battle:"Combat",Cancel:"Annule",CannotImportProjectAon:"Impossible d'importer le livre du projet aon à l'adresse '{{ url }}'","Cannot import adventure":"Impossible d'importer l'aventure","Cannot import game":"Impossible d'importer la partie","Change language to en":"Change language to english","Change language to fr":"Changez la langue en français",Characters:"Personnages",ChoiceGame:"Sélectionne  le jeu '{{ adventureName }}' du joueur '{{ playerName }}'","Choose an action":"Choisissez une action",ChoosenGame:"Le jeu '{{ adventureName }}' du joueur '{{ playerName }}' est choisi",Clear:"Efface",Collapse:"Collapse",Constant:"Constant",Continue:"Poursuivre",Create:"Crée","Create an adventure":"Crée une aventure","Create a game":"Crée une partie",Credits:"Crédits",credit_description_javascript:"langage",credit_description_map_image:"image de carte utilisée comme favicon",credit_description_estawebjs:"pile de développement",credit_description_angularjs:"framework",credit_description_bootstrap:"framework",credit_description_webpack:"module bundler",credit_description_gulp:"build system",credit_description_nodejs:"JavaScript runtime",credit_description_npm:"package manager pour nodejs",credit_description_browsersync:"time-saving synchronised browser testing","credit_description_angular-translate":"i18n pour AngularJS","credit_description_angular-ui-router":"flexible routing with nested views in AngularJS",credit_description_babel:"compilateur JavaScript",credit_description_realfavicongenerator:"générateur de favicon",credit_description_github:"Online project hosting using Git",credit_description_article_sticky_footer:"article",credit_description_article_responsive_navigation_patterns:"article",Current:"Actuel","Decrease tree":"Réduit l'arborescence",DecrementStatsTitle:"Décrémente '{{ stats }}'","Delete application's data":"Supprime les données de l'application",Description:"Description","description.syntax":"Délimiter un numéro de paragraphe avec § afin de l'ajouter comme choix (p.ex. §123§)",Detail:"Détail",Dices:"Dés",dicesQuantity:"Quantité de dés[{{ min }},{{ max }}]",Display:"Affiche","Display actions":"Affiche actions","Display more paragraphs":"Affiche plus de paragraphes",Download:"Download","Download URL":"URL de download",downloadable_in_list:" (téléchargeable)",DupplicateParagraph:"Le pagraphe '{{paragraphNr}}' existe déjà",Edit:"Edite",en:"English",English:"English","Enable characters with stats":"Active les personnages avec attributs","Enable dices":"Active les dés","Enable Go to paragraph":"Active les sauts de paragraphe","Enable map":"Active la carte",Enemy:"Enemi",Export:"Exporte",Expand:"Expand",Features:"Fonctionnalitées","First paragraph":"Premier paragraphe",fr:"Français","Français":"Français",Game:"Partie","Game's rules":"Règles de jeu","Game's rules paragraph":"Paragraphe des règles du jeu",GameAlreadyExists:"Le jeu existe déjà avec l'id '{{ gameId }}'",General:"Générale","Go to":"Aller au","Go to paragraph":"Aller au paragraphe",Home:"Accueil",Homepage:"Page d'accueil",Import:"Importe","Imported data":"Données importées",ImportGameFailedMissingFields:"Impossible d'importer le jeu car il manque les champs obligatoires suivants: '{{ missingMandatoryFields }}'","Increase tree":"Augmente l'arborescence",IncrementStatsTitle:"Incrémente '{{ stats }}'",Initial:"Initiale",ISBN:"ISBN","Keep on restart":"Garder lors de recommencement",Language:"Langue",link:"lien",Lists:"Listes",Map:"Carte","Minimal dice's value":"Valeur de dé minimale","missing-adventure":"Aventure '{{ name }}' manquante","MIT License":"License MIT","Maximal dice's value":"Valeur de dé maximale",Name:"Nom","New character":"Nouveau personnage","New entry":"Nouvelle entrée","New stats":"Nouvel attribut",Next:"Suivant",No:"Non","No adventure available":"Aucune aventure disponible","No way further":"Cul-de-sac",Ok:"Ok",Paragraph:"Paragraphe","Paragraph link":"Liens du paragraphe","Paragraph not played yet":"Le paragraphe n'a pas encore été jouée","Paste the application's data copied from another browser":"Collez les données de l'application précédent copié depuis une autre navigateur","Please complete mandatory fields":"Veuilliez compléter les champs obligatoires","Please fill a value":"Veuilliez saisir une valeur","Please fill the name":"Veuilliez saisir le nom","Please fill the quantity of dices used to generate a value for this stats":"Veuilliez saisir la quantié de dés utilisée pour générer la valeu de cet attribut","Please fill the name of the stats":"Veuilliez saisir le nom de cet attribut","Please fill a default value of this stats for characters":"Veuilliez saisir une valeur par défaut pour les personnages","Please do not fill a default value as this stats is not available for characters":"Veuilliez ne pas saisir une valeur par défaut pour les ennemis comme cet attribut n'est pas disponible pour les personnages","Please fill the name of the game":"Veuilliez saisir le nom de la partie","Remaining Local's Storage":"Local's Storage disponible",Remove:"Supprime","Remove the character":"Supprime le caractère","Remove the stats":"Supprime l'attribut",Restart:"Recommence","Roll dice":"Lance un dé",Save:"Sauvegarde","Save changes":"Sauvegarde les changements",Serie:"Série","sorted alphabetically":"triés alphabétiquement","Sum of dices value":"Somme des dés",Tag:"Tag","The adventure is not available":"L'aventure n'est pas disponible","The application cannot be used because the version of the browser is too old or because it is not possible to save data in 'localStorage'.":"L'application ne peut pas être utilisée car la version du navigateur est trop ancien ou qu'il n'est pas possible de sauver dans le 'localStorage'.","Used Local's Storage":"Local's Storage utilisé","Used Local's Storage in Percent":"Local's Storage utilisé en pourcent","Visible sections":"Sections visibles",Version:"Version","What must be imported?":"Qu'est-ce qui doit être importé?",Yes:"Oui"};t.default=r},,,,,function(e,t,r){var a,n;/*!
	 * angular-translate - v2.13.1 - 2016-12-06
	 * 
	 * Copyright (c) 2016 The angular-translate team, Pascal Precht; Licensed MIT
	 */
!function(r,i){a=[],n=function(){return i()}.apply(t,a),!(void 0!==n&&(e.exports=n))}(this,function(){function e(e){"use strict";return function(t){e.warn("Translation for "+t+" doesn't exist")}}return e.$inject=["$log"],angular.module("pascalprecht.translate").factory("$translateMissingTranslationHandlerLog",e),e.displayName="$translateMissingTranslationHandlerLog","pascalprecht.translate"})},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(9),o=a(s),l=r(89),c=a(l),u=r(108),d=a(u),p=i.default.module("app.components",[d.default.name,c.default.name,o.default.name]);t.default=p},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(10),o=a(s),l=r(65),c=a(l),u=i.default.module("app.components.gui",[o.default.name,c.default.name]);t.default=u},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(11),o=a(s),l=r(14),c=a(l),u=r(18),d=a(u),p=r(22),h=a(p),f=r(25),g=a(f),v=r(29),m=a(v),b=r(32),y=a(b),S=r(39),P=a(S),k=r(42),w=a(k),_=r(45),$=a(_),C=r(48),x=a(C),A=r(51),j=a(A),D=r(54),M=a(D),E=r(57),O=a(E),I=r(62),N=a(I),L=i.default.module("app.components.gui.components",[o.default.name,c.default.name,d.default.name,h.default.name,g.default.name,m.default.name,y.default.name,P.default.name,w.default.name,$.default.name,x.default.name,j.default.name,M.default.name,O.default.name,N.default.name]);t.default=L},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(12),o=a(s),l=r(13),c=a(l),u=i.default.module("app.components.gui.components.dices",[]).component("dices",{template:o.default,controller:c.default,bindings:{gameId:"@"}});t.default=u},function(e,t){e.exports='<div class="row">\r\n    <div class="col-lg-12">\r\n        <div class="input-group">\r\n            <span class="input-group-btn">\r\n                <button class="btn btn-default"\r\n                        ng-click="$ctrl.rollDice()"\r\n                        aria-label="{{ \'Roll dice\' | translate }}"\r\n                        title="{{ \'Roll dice\' | translate }}">\r\n                    {{ \'Roll dice\' | translate }} {{ \'[\' + $ctrl.min + \',\' + $ctrl.max + \']\' }}\r\n                </button>\r\n                <button type="button"\r\n                        class="btn btn-default"\r\n                        ng-click="$ctrl.clear()">\r\n                    {{ \'Clear\' | translate }}\r\n                </button>\r\n            </span>\r\n            <label class="form-control" >{{ $ctrl.dicesValue }}</label>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n){r(this,e),this.dicesService=t,this.gamePersistenceService=a,this.adventurePersistenceService=n,this.initData(),this.clear()}return e.$inject=["dicesService","gamePersistenceService","adventurePersistenceService"],a(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(decodeURIComponent(this.gameId)),t=this.adventurePersistenceService.getAdventure(e.adventureId);t.dice&&(this.min=t.dice.min,this.max=t.dice.max)}},{key:"rollDice",value:function(){this.appendToResult(this.dicesService.rollDices(1,this.min,this.max))}},{key:"clear",value:function(){this.dicesValue=""}},{key:"appendToResult",value:function(e){""!==this.dicesValue&&(this.dicesValue=this.dicesValue+","),this.dicesValue=this.dicesValue+e}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(15),o=a(s),l=r(16),c=a(l),u=r(17),d=a(u),p=i.default.module("app.components.gui.components.messages",[]).service("messagesService",o.default).component("messages",{template:c.default,controller:d.default});t.default=p},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a){r(this,e),this.$rootScope=t,this.$translate=a,this.$rootScope.messages||(this.$rootScope.messages=[])}return e.$inject=["$rootScope","$translate"],a(e,[{key:"getMessages",value:function(){return this.$rootScope.messages||[]}},{key:"clearMessages",value:function(){this.$rootScope.messages.forEach(function(e,t,r){e.keepAfterLocationChange||r.splice(t,1)})}},{key:"removeMessage",value:function(e){this.$rootScope.messages.splice(e,1)}},{key:"successMessage",value:function(e,t){this._addMessage(e,"success",t)}},{key:"errorMessage",value:function(e,t){this._addMessage(e,"error",t)}},{key:"infoMessage",value:function(e,t){this._addMessage(e,"info",t)}},{key:"_addMessage",value:function(e,t,r){this._hasMessage(e,t)||this.$rootScope.messages.push({message:e,type:t,keepAfterLocationChange:r})}},{key:"_hasMessage",value:function(e,t){for(var r=!1,a=0;a<this.$rootScope.messages.length;a++)if(this.$rootScope.messages[a].message===e&&this.$rootScope.messages[a].type===t){r=!0;break}return r}}]),e}();t.default=n},function(e,t){e.exports='<div ng-repeat="msg in $ctrl.messages">\r\n    <div class="alert alert-{{ msg.type === \'error\' ? \'danger\' : msg.type }}">\r\n        {{ msg.message }}\r\n        <a class="close" ng-click="$ctrl.removeMessage($index)">&times;</a>\r\n    </div>\r\n</div>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a){var n=this;r(this,e),this.messagesService=t,a.$on("$locationChangeStart",function(){return n.messagesService.clearMessages()}),this.messages=t.getMessages()}return e.$inject=["messagesService","$rootScope"],a(e,[{key:"removeMessage",value:function(e){this.messagesService.removeMessage(e)}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(19),o=a(s),l=r(20),c=a(l),u=r(21),d=a(u),p=i.default.module("app.components.gui.components.popup",[]).component("popup",{template:o.default,controller:c.default,bindings:{config:"@"}}).service("popupService",d.default);t.default=p},function(e,t){e.exports='<div id="{{$ctrl.cfg.id}}" class="modal">\r\n    <div class="modal-content">\r\n        <p>{{ $ctrl.cfg.textToDisplay }}</p>\r\n        <div class="form-group" ng-show="!!$ctrl.cfg.withText">\r\n            <input type="text" class="form-control" id="text" ng-model="$ctrl.text" ng-required="!!$ctrl.cfg.textRequired">\r\n        </div>\r\n        <span ng-repeat="choice in $ctrl.cfg.choices">\r\n            <button type="button" class="btn btn-default" ng-click="$ctrl.select(choice, $ctrl.text)">{{ choice | translate }}</button>&nbsp;\r\n        </span>\r\n    </div>\r\n</div>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n){r(this,e),this.cfg=JSON.parse(this.config),this.constants=n,this.popupService=t,this.cfg.withoutTranslate?this.cfg.textToDisplay=this.cfg.text:this.cfg.textToDisplay=a.instant(this.cfg.text)}return e.$inject=["popupService","$translate","constants"],a(e,[{key:"select",value:function(e,t){this.cfg.withText&&!t&&e!==this.constants.choices.cancel||this.close(e,t)}},{key:"close",value:function(e,t){this.popupService.close(this.cfg.id,e,t)}}]),e}();t.default=n},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(){r(this,e),this.popups={}}return a(e,[{key:"show",value:function(e,t){var r=window.document.getElementById(e);r.style.display="block",this.popups[e]=t}},{key:"close",value:function(e,t,r){var a=window.document.getElementById(e);a.style.display="none";var n=this.popups[e];n&&n(e,t,r),delete this.popups[e]}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(23),o=a(s),l=r(24),c=a(l),u=i.default.module("app.components.gui.components.back-button",[]).component("backButton",{template:o.default,controller:c.default});t.default=u},function(e,t){e.exports='<button type="button"\r\n        class="btn btn-default"\r\n        aria-label="{{ \'Back\' | translate }}"\r\n        title="{{ \'Back\' | translate }}"\r\n        ng-click="$ctrl.back()"\r\n        ng-disabled="$ctrl.isBackDisabled()">\r\n    {{ \'Back\' | translate }}\r\n</button>'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a){r(this,e),this.$location=t,this.constants=a}return e.$inject=["$location","constants"],a(e,[{key:"back",value:function(){this.$location.url(this.constants.url.games)}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(26),o=a(s),l=r(27),c=a(l),u=r(28),d=a(u),p=i.default.module("app.components.gui.components.import-data-popup",[]).component("importDataPopup",{template:o.default,controller:c.default,bindings:{config:"<"}}).service("importDataPopupService",d.default);t.default=p},function(e,t){e.exports='<form name="importDataForm" novalidate="novalidate">\r\n    <div id="{{$ctrl.config.id}}" class="modal">\r\n        <div class="modal-content">\r\n            <div class="form-group">\r\n                <input id="importUpload" type="file" ng-model="$ctrl.uploadFile" on-read-file="$ctrl.showContent($fileContent)" />\r\n            </div>\r\n\r\n            <span ng-repeat="choice in $ctrl.choices">\r\n                <button type="button" class="btn btn-default" ng-click="$ctrl.select(choice, importDataForm)">{{ choice | translate }}</button>&nbsp;\r\n            </span>\r\n        </div>\r\n    </div>\r\n</form>'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n){r(this,e),this.constants=a,this.importDataPopupService=t,this.$window=n,this.choices=[a.choices.cancel,a.choices.ok]}return e.$inject=["importDataPopupService","constants","$window"],a(e,[{key:"select",value:function(e,t){if(e===this.constants.choices.cancel)this.close(e);else if(e===this.constants.choices.ok){var r=this.importUploadData;this.close(e,r),this.importUploadData=null}}},{key:"close",value:function(e,t){this.importDataPopupService.close(this.config.id,e,t)}},{key:"showContent",value:function(e){this.importUploadData=e}}]),e}();t.default=n},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t){r(this,e),this.constants=t,this.popups={}}return e.$inject=["constants"],a(e,[{key:"show",value:function(e,t){var r=window.document.getElementById(e);r.style.display="block",this.popups[e]=t}},{key:"close",value:function(e,t,r){var a=window.document.getElementById(e);a.style.display="none";var n=this.popups[e];n&&t===this.constants.choices.ok&&n(e,r),delete this.popups[e]}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(30),o=a(s),l=r(31),c=a(l),u=i.default.module("app.components.gui.components.nodes",[]).component("nodes",{template:o.default,controller:c.default,bindings:{gameId:"<",adventureId:"<",rootParagraphNr:"<"}});t.default=u},function(e,t){e.exports='<ul>\r\n    <li class="node" ng-if="$ctrl.isDisplayMoreParagraphsButtonAvailable()">\r\n        <button type="button"\r\n                class="btn btn-xs btn-default"\r\n                aria-label="{{ \'Display more paragraphs\' | translate}}"\r\n                title="{{ \'Display more paragraphs\' | translate}}"\r\n                ng-click="$ctrl.displayMoreParagraphs()">\r\n            <span aria-hidden="true">...</span>\r\n        </button>\r\n    </li>\r\n    <li class="node" ng-repeat="path in $ctrl.path">\r\n        <button type="button" class="btn btn-xs btn-default" ng-click="$ctrl.setRootParagraphNr(path.value)">{{ path.value + (!!path.tag ? \' (\' + path.tag + \')\': \'\') }}</button>\r\n    </li>\r\n</ul>\r\n<ul>\r\n    <node data="$ctrl.rootNode" root-node="$ctrl.rootNode"></node>\r\n</ul>\r\n<li class="node">\r\n    <button type="button" class="btn btn-xs btn-default"\r\n            ng-click="$ctrl.increaseTree()">\r\n        <span aria-hidden="true">{{ \'Increase tree\' | translate }}</span>\r\n    </button>\r\n    <button type="button" class="btn btn-xs btn-default"\r\n            ng-click="$ctrl.decreaseTree()">\r\n        <span aria-hidden="true">{{ \'Decrease tree\' | translate }}</span>\r\n    </button>\r\n</li>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n){r(this,e),this.mapPersistenceService=t,this.gamePersistenceService=a,this.adventurePersistenceService=n,this.initData()}return e.$inject=["mapPersistenceService","gamePersistenceService","adventurePersistenceService"],a(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(this.gameId);0===e.expandedTreeLevels||e.expandedTreeLevels?this.expandedTreeLevels=e.expandedTreeLevels:this.expandedTreeLevels=5,this.setRootParagraphNr(this.rootParagraphNr)}},{key:"getExpandedTreeLevels",value:function(){}},{key:"displayMoreParagraphs",value:function(){this.displayedLastParagraphCount=this.displayedLastParagraphCount+3,this.computeDisplayedLastParagraphs()}},{key:"isDisplayMoreParagraphsButtonAvailable",value:function(){return this.lastParagraphCount-2>=this.displayedLastParagraphCount}},{key:"computeDisplayedLastParagraphs",value:function(){var e=this.gamePersistenceService.getGame(this.gameId);if(this.lastParagraphCount=0,e.path&&e.path.length&&(this.lastParagraphCount=e.path.length-1),this.path=[],!!this.lastParagraphCount>0){var t=0,r=e.path.length-2;this.displayedLastParagraphCount<r&&(t=r-this.displayedLastParagraphCount+1);for(var a=t;a<=r;a++){var n={value:e.path[a]},i=this.adventurePersistenceService.getParagraph(this.adventureId,e.path[a]);i.tag&&(n.tag=i.tag),this.path.push(n)}}}},{key:"collapseAll",value:function(e){this.collapse(e,-1)}},{key:"collapse",value:function(e,t){this.setCollapse(e,t,!0)}},{key:"expand",value:function(e,t){this.setCollapse(e,t,!1)}},{key:"setCollapse",value:function(e,t,r){if(e.children&&(e.collapsed=r,0!==t))for(var a=0;a<e.children.length;a++)this.setCollapse(e.children[a],t-1,r)}},{key:"setRootParagraphNr",value:function(e){this.rootParagraphNr=e,this.displayedLastParagraphCount=5,this.computeDisplayedLastParagraphs(),this.rootNode=this.mapPersistenceService.getMap(this.adventureId,this.rootParagraphNr),this.collapseAll(this.rootNode),this.expand(this.rootNode,this.expandedTreeLevels)}},{key:"increaseTree",value:function(){this.expandedTreeLevels=this.expandedTreeLevels+1,this.setRootParagraphNr(this.rootParagraphNr),this.saveExpandedTreeLevel()}},{key:"decreaseTree",value:function(){this.expandedTreeLevels=this.expandedTreeLevels-1,this.expandedTreeLevels<0&&(this.expandedTreeLevels=0),this.setRootParagraphNr(this.rootParagraphNr),this.saveExpandedTreeLevel()}},{key:"saveExpandedTreeLevel",value:function(){var e=this.gamePersistenceService.getGame(this.gameId);e.expandedTreeLevels=this.expandedTreeLevels,this.gamePersistenceService.updateGame(e)}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(33),o=a(s),l=r(34),c=a(l);r(35);var u=i.default.module("app.components.gui.components.node",[]).component("node",{template:o.default,controller:c.default,bindings:{data:"<",rootNode:"<"}});t.default=u},function(e,t){e.exports='<div id="{{$ctrl.data.id}}" ng-click="$ctrl.click()">\r\n    <span>\r\n        {{ $ctrl.data.name + (!!$ctrl.data.tag ? \' (\' + $ctrl.data.tag + \')\': \'\') }}\r\n    </span>\r\n    <span class="glyphicon glyphicon-link"\r\n          aria-label="{{ \'Paragraph link\' | translate }}"\r\n          title="{{ \'Paragraph link\' | translate }}"\r\n          ng-show="!!$ctrl.data.linkNodeId">\r\n    </span>\r\n    <span class="glyphicon glyphicon-question-sign"\r\n          aria-label="{{ \'Paragraph not played yet\' | translate }}"\r\n          title="{{ \'Paragraph not played yet\' | translate }}"\r\n          ng-show="!!$ctrl.data.unknown">\r\n    </span>\r\n    <span class="glyphicon glyphicon-minus-sign"\r\n          aria-label="{{ \'No way further\' | translate }}"\r\n          title="{{ \'No way further\' | translate }}"\r\n          ng-show="!$ctrl.data.children && !!$ctrl.data.linkNodeId && !!$ctrl.data.unknown">\r\n    </span>\r\n    <button type="button"\r\n            class="btn btn-xs btn-default"\r\n            ng-click="$ctrl.toogleCollapse()"\r\n            ng-show="!!$ctrl.data.children">\r\n        {{ (!!$ctrl.data.collapsed ? \'Expand\': \'Collapse\') | translate }}\r\n    </button>\r\n</div>\r\n<div ng-if="!!$ctrl.data.children && !$ctrl.data.collapsed">\r\n    <ul>\r\n        <li class="node" ng-repeat="childNode in $ctrl.data.children">\r\n            <node data="childNode" root-node="$ctrl.rootNode"></node>\r\n        </li>\r\n    </ul>\r\n</div>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(){r(this,e)}return a(e,[{key:"click",value:function(){this.data.children?this.toggleCollapse(this.data):this.data.linkNodeId&&this.expandUpTo(this.data.linkNodeId)}},{key:"expandUpTo",value:function(e){var t=[];this.findNode(this.rootNode,e,t);for(var r=0;r<t.length;r++)t[r].collapsed=!1}},{key:"toggleCollapse",value:function(e){e.children&&(e.collapsed?e.collapsed=!e.collapsed:e.collapsed=!0)}},{key:"findNode",value:function(e,t,r){if(r.push(e),t===e.id)return e;if(e.children)for(var a=0;a<e.children.length;a++){var n=this.findNode(e.children[a],t,r);if(n)return n}var i=r.indexOf(e);return r.splice(i,1),null}}]),e}();t.default=n},function(e,t,r){var a=r(36);"string"==typeof a&&(a=[[e.id,a,""]]);r(38)(a,{});a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(37)(),t.push([e.id,"li.node{display:block}",""])},,,function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(40),o=a(s),l=r(41),c=a(l),u=i.default.module("app.components.gui.components.characters",[]).component("characters",{template:o.default,controller:c.default,bindings:{gameId:"<"}});t.default=u},function(e,t){e.exports='<ul>\r\n    <li ng-repeat="entry in $ctrl.characters">\r\n        <span ng-show="!entry.edited">{{ entry.name }}</span>\r\n        <button type="button"\r\n                class="btn btn-xs btn-default"\r\n                ng-click="$ctrl.editEntry(entry)"\r\n                ng-show="!entry.edited">\r\n            {{ \'Edit\' | translate }}\r\n        </button>\r\n        <form name="formCharacter" ng-show="!!entry.edited">\r\n            <div class="form-group" ng-if="!$ctrl.adventure.id">\r\n                <label for="name">{{ "Name" | translate }}</label>\r\n                <input type="text" class="form-control" id="name" ng-model="entry.name" required>\r\n                <div class="error" ng-show="!entry.name">\r\n                    {{ \'Please fill the name\' | translate }}\r\n                </div>\r\n            </div>\r\n            <div ng-repeat="stats in entry.stats">\r\n                <div class="form-group">\r\n                    <input type="text" class="form-control" ng-model="stats.name" id="{{ stats.name }}" required>\r\n                    <div class="error" ng-show="!stats.name">\r\n                        {{ \'Please fill the name of the stats\' | translate }}\r\n                    </div>\r\n                    <div class="row">\r\n                        <div class="col-lg-12">\r\n                            <div class="input-group">\r\n                                <input type="number" class="form-control" ng-model="stats.current" id="{{ stats.name }}" required>\r\n                              <span class="input-group-addon">\r\n                                <label>/</label>\r\n                              </span>\r\n                                <input type="number" class="form-control" ng-model="stats.initial" required>\r\n                            </div>\r\n                            <div class="error" ng-show="!stats.current || !stats.initial">\r\n                                {{ \'Please fill a value\' | translate }}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <button type="button"\r\n                            class="btn btn-xs btn-danger"\r\n                            aria-label="{{ \'Remove the stats\' | translate }}"\r\n                            title="{{ \'Remove the stats\' | translate }}"\r\n                            ng-click="$ctrl.removeStats(entry, stats)">\r\n                        {{ \'Remove\' | translate }}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </form>\r\n        <button type="button"\r\n                class="btn btn-xs btn-success"\r\n                ng-click="$ctrl.saveChanges(entry, formCharacter)"\r\n                ng-show="!!entry.edited">\r\n            {{ \'Save\' | translate }}\r\n        </button>\r\n        <button type="button"\r\n                class="btn btn-xs btn-danger"\r\n                ng-click="$ctrl.abortChanges(entry)"\r\n                ng-show="!!entry.edited">\r\n            {{ \'Cancel\' | translate }}\r\n        </button>\r\n        <button type="button"\r\n                class="btn btn-xs btn-danger"\r\n                aria-label="{{ \'Remove the character\' | translate }}"\r\n                title="{{ \'Remove the character\' | translate }}"\r\n                ng-click="$ctrl.displayRemovePopup(entry)"\r\n                ng-show="!!entry.edited">\r\n            {{ \'Remove\' | translate }}\r\n        </button>\r\n\r\n        <ul>\r\n            <li ng-repeat="stats in entry.stats">\r\n                {{ stats.name + \' [\' + stats.current + \'/\' + stats.initial + \']\' }}\r\n                <button type="button" class="btn btn-xs btn-default"\r\n                        aria-label="{{ \'IncrementStatsTitle\' | translate: {stats: stats.name} }}"\r\n                        title="{{ \'IncrementStatsTitle\' | translate: {stats: stats.name} }}"\r\n                        ng-click="$ctrl.increment(stats)">\r\n                    <span aria-hidden="true"><b>+</b></span>\r\n                </button>\r\n                <button type="button" class="btn btn-xs btn-default"\r\n                        aria-label="{{ \'DecrementStatsTitle\' | translate: {stats: stats.name} }}"\r\n                        title="{{ \'DecrementStatsTitle\' | translate: {stats: stats.name} }}"\r\n                        ng-click="$ctrl.decrement(stats)">\r\n                    <span aria-hidden="true"><b>-</b></span>\r\n                </button>\r\n            </li>\r\n            <li ng-show="!entry.edited">\r\n                <input id="newStats" type="text" placeholder="{{ \'New stats\' | translate }}" ng-model="entry.newStats"/>\r\n                <button type="button"\r\n                        class="btn btn-xs btn-success"\r\n                        ng-click="$ctrl.addStats(entry)"\r\n                        ng-show="!!entry.newStats">\r\n                    {{ \'Add\' | translate }}\r\n                </button>\r\n            </li>\r\n        </ul>\r\n    </li>\r\n    <li>\r\n        <input id="newEntry" type="text" placeholder="{{ \'New character\' | translate }}" ng-model="$ctrl.newEntry"/>\r\n        <button type="button"\r\n                class="btn btn-xs btn-success"\r\n                ng-click="$ctrl.addEntry()"\r\n                ng-show="!!$ctrl.newEntry">\r\n            {{ \'Add\' | translate }}\r\n        </button>\r\n    </li>\r\n</ul>\r\n\r\n<popup config="{{ $ctrl.popupDeleteCharacterConfig }}"></popup>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n,i){r(this,e),this.gamePersistenceService=t,this.adventurePersistenceService=a,this.popupService=n,this.constants=i,this.initData(),this.popupDeleteCharacterConfig={id:"popupDeleteCharacter",text:"Are you sure to remove the character?",choices:[i.choices.yes,i.choices.no]}}return e.$inject=["gamePersistenceService","adventurePersistenceService","popupService","constants"],a(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(decodeURIComponent(this.gameId));e.characters?this.characters=e.characters:this.characters=[]}},{key:"addEntry",value:function(){var e=this.createCharacter(this.newEntry);this.characters.push(e),this.newEntry=null,this.save(),this.editEntry(e)}},{key:"addStats",value:function(e){e.stats||(e.stats=[]),e.stats.push({name:e.newStats}),this.editEntry(e)}},{key:"createCharacter",value:function(e){var t={name:e};return t.stats=[],t}},{key:"editEntry",value:function(e){e.edited||(e.edited=!0,e.originalValues={},this.copyCharacter(e,e.originalValues))}},{key:"displayRemovePopup",value:function(e){this.rowToBeRemoved=e;var t=this;this.popupService.show(this.popupDeleteCharacterConfig.id,function(e,r){r===t.constants.choices.yes&&t.removeEntry(t.rowToBeRemoved),t.rowToBeRemoved=null})}},{key:"removeEntry",value:function(e){var t=this.characters.indexOf(e);this.characters.splice(t,1),this.save()}},{key:"removeStats",value:function(e,t){var r=e.stats.indexOf(t);e.stats.splice(r,1)}},{key:"saveChanges",value:function(e,t){t.$invalid||(this.clearEdition(e),this.save())}},{key:"abortChanges",value:function(e){if(this.copyCharacter(e.originalValues,e),e.newStats){for(var t=-1,r=0;r<e.stats.length;r++)if(e.newStats==e.stats[r].name){t=r;break}t!==-1&&e.stats.splice(t,1)}this.clearEdition(e)}},{key:"copyCharacter",value:function(e,t){if(t.name=e.name,e.stats){t.stats=[];for(var r=0;r<e.stats.length;r++)t.stats.push({name:e.stats[r].name,current:e.stats[r].current,initial:e.stats[r].initial})}}},{key:"clearEdition",value:function(e){delete e.originalValues,delete e.edited,e.newStats=null}},{key:"increment",value:function(e){e.current=e.current+1,this.save()}},{key:"decrement",value:function(e){e.current=e.current-1,this.save()}},{key:"save",value:function(){var e=this.gamePersistenceService.getGame(decodeURIComponent(this.gameId));e.characters=this.characters,this.gamePersistenceService.updateGame(e)}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(43),o=a(s),l=r(44),c=a(l),u=i.default.module("app.components.gui.components.list",[]).component("list",{template:o.default,controller:c.default,bindings:{entries:"<",onSave:"&"}});t.default=u},function(e,t){e.exports='<ul>\r\n    <li ng-repeat="entry in $ctrl.innerEntries">\r\n        <span ng-show="!entry.edited">{{ entry.value }}</span>\r\n        <input type="text" ng-model="entry.value" ng-show="!!entry.edited"/>\r\n        <button type="button"\r\n                class="btn btn-xs btn-default"\r\n                ng-click="$ctrl.editEntry(entry)"\r\n                ng-show="!entry.edited">\r\n            {{ \'Edit\' | translate }}\r\n        </button>\r\n        <button type="button"\r\n                class="btn btn-xs btn-success"\r\n                ng-click="$ctrl.saveChanges(entry)"\r\n                ng-show="!!entry.edited">\r\n            {{ \'Save\' | translate }}\r\n        </button>\r\n        <button type="button"\r\n                class="btn btn-xs btn-danger"\r\n                ng-click="$ctrl.abortChanges(entry)"\r\n                ng-show="!!entry.edited">\r\n            {{ \'Cancel\' | translate }}\r\n        </button>\r\n        <button type="button"\r\n                class="btn btn-xs btn-danger"\r\n                ng-click="$ctrl.removeEntry(entry)"\r\n                ng-show="!!entry.edited">\r\n            {{ \'Remove\' | translate }}\r\n        </button>\r\n    </li>\r\n    <li>\r\n        <input id="newEntry" type="text" placeholder="{{ \'New entry\' | translate }}" ng-model="$ctrl.newEntry"/>\r\n        <button type="button"\r\n                class="btn btn-xs btn-success"\r\n                ng-click="$ctrl.addEntry()"\r\n                ng-show="!!$ctrl.newEntry">\r\n            {{ \'Add\' | translate }}\r\n        </button>\r\n    </li>\r\n</ul>';
},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(){if(r(this,e),this.innerEntries=[],this.entries)for(var t=0;t<this.entries.length;t++)this.innerEntries.push({value:this.entries[t]})}return a(e,[{key:"addEntry",value:function(){this.innerEntries.push({value:this.newEntry}),this.newEntry=null,this.save()}},{key:"editEntry",value:function(e){e.edited||(e.edited=!0,e.originalValue=e.value)}},{key:"removeEntry",value:function(e){var t=this.innerEntries.indexOf(e);this.innerEntries.splice(t,1),this.save()}},{key:"saveChanges",value:function(e){this.clearEdition(e),this.save()}},{key:"abortChanges",value:function(e){e.value=e.originalValue,this.clearEdition(e)}},{key:"clearEdition",value:function(e){delete e.originalValue,delete e.edited}},{key:"save",value:function(){var e=[];if(this.innerEntries)for(var t=0;t<this.innerEntries.length;t++)e.push(this.innerEntries[t].value);this.onSave({entries:e})}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(46),o=a(s),l=r(47),c=a(l),u=i.default.module("app.components.gui.components.description",[]).component("description",{template:o.default,controller:c.default,bindings:{gameId:"<",paragraph:"<"}});t.default=u},function(e,t){e.exports='<div class="row">\r\n    <div class="col-md-11">\r\n        <textarea id="inputCurrentDescription" class="form-control" ng-model="$ctrl.paragraph.description" ng-if="!!$ctrl.isDescriptionEditable()" title="{{ \'description.syntax\' | translate }}"></textarea>\r\n        <div ng-if="!$ctrl.isDescriptionEditable()">\r\n            <div ng-repeat="paragraph in $ctrl.paragraphs">\r\n                <ng-repeat ng-repeat="paragraphElement in paragraph">\r\n                    <button class="btn btn-xs btn-default" ng-if="!!paragraphElement.choice && !!$ctrl.isAlreadyChoosen(paragraphElement.text)" ng-click="$ctrl.goTo(paragraphElement.text)">\r\n                        {{ paragraphElement.text }}\r\n                    </button>\r\n                    <button class="btn btn-xs btn-default" ng-if="!!paragraphElement.choice && !$ctrl.isAlreadyChoosen(paragraphElement.text)" ng-click="$ctrl.goTo(paragraphElement.text)">\r\n                        <strong>{{ paragraphElement.text }}</strong>\r\n                    </button>\r\n                    <ng-if ng-if="!paragraphElement.choice">\r\n                        {{ paragraphElement.text }}\r\n                    </ng-if>\r\n                    <br ng-if="!paragraphElement.text && !paragraphElement.choice" />\r\n                </ng-repeat>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="col-md-1">\r\n        <button type="button"\r\n                class="btn btn-xs btn-default"\r\n                ng-click="$ctrl.editDescription()"\r\n                ng-show="!$ctrl.isDescriptionEditable()">\r\n            {{ \'Edit\' | translate }}\r\n        </button>\r\n        <button type="button"\r\n                class="btn btn-xs btn-success"\r\n                ng-click="$ctrl.saveDescriptionChanges()"\r\n                ng-show="$ctrl.isDescriptionEditable()">\r\n            {{ \'Save\' | translate }}\r\n        </button>\r\n        <button type="button"\r\n                class="btn btn-xs btn-danger"\r\n                ng-click="$ctrl.abortDescriptionChanges()"\r\n                ng-show="$ctrl.isDescriptionEditable()">\r\n            {{ \'Cancel\' | translate }}\r\n        </button>\r\n    </div>\r\n</div>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n){r(this,e),this.gamePersistenceService=t,this.adventurePersistenceService=a,this.$location=n,this.initData()}return e.$inject=["gamePersistenceService","adventurePersistenceService","$location"],a(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(this.gameId);this.adventureId=e.adventureId,this.descriptionEditable=!1,this.alreadyChoosen=this.gamePersistenceService.getChoosenChoices(this.gameId,this.paragraph.paragraphNr),this.paragraphs=this.adventurePersistenceService.getDescriptionParagraphs(this.paragraph.description)}},{key:"editDescription",value:function(){this.descriptionEditable=!0,this.originalDescription=this.paragraph.description}},{key:"isDescriptionEditable",value:function(){return this.descriptionEditable}},{key:"saveDescriptionChanges",value:function(){this.originalDescription=null,this.descriptionEditable=!1,this.adventurePersistenceService.updateParagraph(this.adventureId,this.paragraph),this.paragraphs=this.adventurePersistenceService.getDescriptionParagraphs(this.paragraph.description)}},{key:"abortDescriptionChanges",value:function(){this.paragraph.description=this.originalDescription,this.originalDescription=null,this.descriptionEditable=!1}},{key:"goTo",value:function(e){this.gamePersistenceService.setCurrentParagraphNrOfGame(this.gameId,this.paragraph.paragraphNr,e);var t=this.gamePersistenceService.getUrlOfGame(this.gameId);this.$location.url(t)}},{key:"isAlreadyChoosen",value:function(e){return this.alreadyChoosen.indexOf(e)!==-1}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(49),o=a(s),l=r(50),c=a(l),u=i.default.module("app.components.gui.components.goto",[]).component("goto",{template:o.default,controller:c.default,bindings:{gameId:"<",paragraph:"<"}});t.default=u},function(e,t){e.exports='<div class="row" ng-if="!!$ctrl.gotoAvailable">\r\n    <div class="col-lg-12">\r\n        <div class="input-group">\r\n            <span class="input-group-btn">\r\n                <button class="btn btn-default"\r\n                        aria-label="{{ \'Go to paragraph\' | translate }}"\r\n                        title="{{ \'Go to paragraph\' | translate }}"\r\n                        ng-click="$ctrl.goTo($ctrl.paragraphNrChoice)"\r\n                        ng-disabled="!$ctrl.paragraphNrChoice">\r\n                    {{ \'Go to paragraph\' | translate }}\r\n                </button>\r\n            </span>\r\n            <input id="goToParagraphNr" type="text" class="form-control" ng-model="$ctrl.paragraphNrChoice">\r\n        </div>\r\n    </div>\r\n</div>'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n){r(this,e),this.gamePersistenceService=t,this.adventurePersistenceService=a,this.$location=n,this.initData()}return e.$inject=["gamePersistenceService","adventurePersistenceService","$location"],a(e,[{key:"initData",value:function(){var e=this.gamePersistenceService.getGame(this.gameId),t=this.adventurePersistenceService.getAdventure(e.adventureId);this.gotoAvailable=!!t.toggles.goto}},{key:"goTo",value:function(e){this.gamePersistenceService.setCurrentParagraphNrOfGame(this.gameId,this.paragraph.paragraphNr,e);var t=this.gamePersistenceService.getUrlOfGame(this.gameId);this.$location.url(t)}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(52),o=a(s),l=r(53),c=a(l),u=i.default.module("app.components.gui.components.collapse",[]).component("collapse",{template:o.default,controller:c.default,transclude:!0,bindings:{title:"@",flag:"@"}});t.default=u},function(e,t){e.exports='<h2>\r\n    {{ $ctrl.title }}\r\n    <button type="button"\r\n            class="btn btn-xs btn-default"\r\n            ng-click="$ctrl.toogleCollapse()">\r\n        {{ (!!$ctrl.collapsed ? \'Expand\': \'Collapse\') | translate }}\r\n    </button>\r\n</h2>\r\n<div ng-if="!$ctrl.collapsed" ng-transclude>\r\n</div>'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n={},i=function(){function e(){r(this,e),n[this.flag]||(n[this.flag]=!1),this.collapsed=!!n[this.flag]}return a(e,[{key:"toogleCollapse",value:function(){this.collapsed=!this.collapsed,n[this.flag]=this.collapsed}}]),e}();t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(55),o=a(s),l=r(56),c=a(l),u=i.default.module("app.components.gui.components.selectable-list",[]).component("selectableList",{template:o.default,controller:c.default,bindings:{entries:"="}});t.default=u},function(e,t){e.exports='<ul class="list-unstyled">\r\n    <li ng-repeat="entry in $ctrl.entries">\r\n        <div class="checkbox">\r\n            <label>\r\n                <input type="checkbox" ng-model="entry.checked">{{ entry.value }}\r\n            </label>\r\n        </div>\r\n    </li>\r\n</ul>'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(){r(this,e)};t.default=a},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(58),o=a(s),l=r(59),c=a(l);r(60);var u=i.default.module("app.components.gui.components.footnote",[]).component("footnote",{template:o.default,controller:c.default});t.default=u},function(e,t){e.exports='<br>\r\n<footer role="contentinfo">\r\n    <div class="container">\r\n        <p class="text-muted">\r\n            <a href="http://morarupasukaru.github.io/gamebooks-assistant/#">\r\n                {{ \'Home\' | translate}}\r\n            </a>\r\n            -\r\n            <a ui-sref="credits">\r\n                {{ \'Credits\' | translate}}\r\n            </a>\r\n            -\r\n            <a href="https://opensource.org/licenses/MIT">\r\n                {{ \'MIT License\' | translate}}\r\n            </a>\r\n            -\r\n            <a ng-repeat="language in $ctrl.supportedLanguages"\r\n               href ng-click="$ctrl.changeLanguage(language.code)"\r\n               aria-label="{{ \'Change language to \' + language.code | translate}}"\r\n               title="{{ \'Change language to \' + language.code | translate}}">\r\n                {{ language.code }}\r\n            </a>\r\n        </p>\r\n    </div>\r\n</footer>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t){r(this,e),this.languagePickerService=t,this.initData()}return e.$inject=["languagePickerService"],a(e,[{key:"initData",value:function(){this.supportedLanguages=this.languagePickerService.getSupportedLanguages(),this.changeLanguage(this.languagePickerService.getSelectedLanguage())}},{key:"changeLanguage",value:function(e){this.language=e,this.languagePickerService.changeLanguage(e)}}]),e}();t.default=n},function(e,t,r){var a=r(61);"string"==typeof a&&(a=[[e.id,a,""]]);r(38)(a,{});a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(37)(),t.push([e.id,"html{position:relative;min-height:100%}body{margin:0 0 100px}footer{position:absolute;left:0;bottom:0;height:100px;width:100%}",""])},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(5),o=(a(s),r(63)),l=a(o),c=r(64),u=a(c),d=i.default.module("app.components.gui.components.about",[]).component("about",{template:l.default,controller:u.default});t.default=d},function(e,t){e.exports='<div class="container bg-white" role="main">\r\n    <h1 class="text-center">Gamebooks Assistant</h1>\r\n    <div class="text-muted text-center">{{ \'application.description\' | translate }}</div>\r\n</div>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function e(){r(this,e)};t.default=a},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(66),o=a(s),l=r(69),c=a(l),u=r(76),d=a(u),p=r(79),h=a(p),f=r(82),g=a(f),v=r(86),m=a(v),b=i.default.module("app.components.gui.screens",[o.default.name,c.default.name,d.default.name,g.default.name,m.default.name,h.default.name]);t.default=b},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(5),o=a(s),l=r(67),c=a(l),u=r(68),d=a(u),p=i.default.module("app.components.gui.screen.home",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,r){t.otherwise("/"),e.state("home",{url:"/",template:"<home></home>"})}]).component("home",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports="<messages></messages>\r\n<main></main>\r\n<footnote></footnote>\r\n"},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=["$location","constants",function e(t,a){r(this,e),t.url(a.url.games)}];t.default=a},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(70),o=a(s),l=r(73),c=a(l),u=i.default.module("app.components.gui.screens.games",[o.default.name,c.default.name]);t.default=u},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(5),o=a(s),l=r(71),c=a(l),u=r(!function(){var e=new Error('Cannot find module "./games-list.controller"');throw e.code="MODULE_NOT_FOUND",e}()),d=a(u),p=i.default.module("app.components.gui.screen.games.list",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,r){t.otherwise("/"),e.state("gamesList",{url:r.url.games+"?importGame&importAdventure",template:"<games-list></games-list>"})}]).component("gamesList",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\r\n<about></about>\r\n<main>\r\n    <div class="container bg-white" role="main">\r\n        <h2>{{ \'Adventures\' | translate }}</h2>\r\n\r\n        <ul>\r\n            <li ng-repeat="adventure in $ctrl.adventures">\r\n                <span>\r\n                    {{ (!!adventure.serie ? adventure.serie + \': \': \'\') +  adventure.name }} {{ ($ctrl.hasAdventureToBeDownloaded(adventure) ? \'downloadable_in_list\' : \'\') | translate }}\r\n                </span>\r\n                <button type="button"\r\n                        class="btn btn-xs btn-default"\r\n                        aria-label="{{ \'Display actions\' | translate}}"\r\n                        title="{{ \'Display actions\' | translate}}"\r\n                        ng-if="!adventure.missingAdventure"\r\n                        ng-click="$ctrl.displaySelectedAdventureActions(adventure)">\r\n                    <span aria-hidden="true">{{ \'Display actions\' | translate }}</span>\r\n                </button>\r\n\r\n                <ul>\r\n                    <li ng-repeat="game in adventure.games">\r\n                        <span>\r\n                            {{ game.name + \' (\' + game.time + \')\' }}\r\n                        </span>\r\n                        <button type="button"\r\n                                class="btn btn-xs btn-default"\r\n                                aria-label="{{ \'Display actions\' | translate}}"\r\n                                title="{{ \'Display actions\' | translate}}"\r\n                                ng-click="$ctrl.displaySelectedGameActions(game)">\r\n                            <span aria-hidden="true">{{ \'Display actions\' | translate }}</span>\r\n                        </button>\r\n                    </li>\r\n                </ul>\r\n            </li>\r\n        </ul>\r\n\r\n        <button type="button" class="btn btn-default"\r\n                aria-label="{{ \'Create an adventure\' | translate }}"\r\n                title="{{ \'Create an adventure\' | translate }}"\r\n                ng-click="$ctrl.createAdventure()">{{ \'Create an adventure\' | translate }}</button>\r\n        <button type="button" class="btn btn-default"\r\n                aria-label="{{ \'Import\' | translate }}"\r\n                title="{{ \'Import\' | translate }}"\r\n                ng-click="$ctrl.displayImportActions()">{{ \'Import\' | translate }}</button>\r\n    </div>\r\n</main>\r\n<footnote></footnote>\r\n\r\n<a id="linkDownloadExportAdventure" ng-show="false" ng-href="{{$ctrl.exportDownloadBlobUrl}}" download="exportAdventure.txt">download adventure (link hidden)</a>\r\n<a id="linkDownloadExportGame" ng-show="false" ng-href="{{$ctrl.exportDownloadBlobUrl}}" download="exportGame.txt">download game (link hidden)</a>\r\n\r\n<popup config="{{ $ctrl.popupDeleteAdventureConfig }}"></popup>\r\n<popup config="{{ $ctrl.popupDownloadAdventureConfig }}"></popup>\r\n<popup config="{{ $ctrl.popupDeleteGameConfig }}"></popup>\r\n<popup config="{{ $ctrl.popupRestartGameConfig }}"></popup>\r\n<popup config="{{ $ctrl.popupDisplaySelectedAdventureActionsConfig }}"></popup>\r\n<popup config="{{ $ctrl.popupDisplaySelectedGameActionsConfig }}"></popup>\r\n<popup config="{{ $ctrl.popupDisplayImportActionsConfig }}"></popup>\r\n<popup config="{{ $ctrl.popupStartGameConfig }}"></popup>\r\n<import-data-popup config="$ctrl.popupImportAdventureConfig"></import-data-popup>\r\n<import-data-popup config="$ctrl.popupImportGameConfig"></import-data-popup>'},,function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(5),o=a(s),l=r(74),c=a(l),u=r(75),d=a(u),p=i.default.module("app.components.gui.screen.games.detail",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,r){t.otherwise("/"),e.state("game-detail",{url:r.url.gameDetail,template:"<game-detail></game-detail>"})}]).component("gameDetail",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\r\n<main>\r\n    <div class="container bg-white" role="main">\r\n        <div class="page-header">\r\n            <h1>\r\n                {{ \'Paragraph\' | translate }} {{ $ctrl.paragraph.paragraphNr }}\r\n                {{ !!$ctrl.paragraph.tag ? \'(\' + $ctrl.paragraph.tag +  \')\' : \'\' }}\r\n                <button type="button"\r\n                        class="btn btn-xs btn-default"\r\n                        ng-click="$ctrl.editTag()"\r\n                        ng-show="!$ctrl.isTagEditable()">\r\n                    {{ \'Edit\' | translate }}\r\n                </button>\r\n            </h1>\r\n        </div>\r\n\r\n        <div ng-if="!!$ctrl.isTagEditable()">\r\n            <h2>{{ \'Visible sections\' | translate }}</h2>\r\n            <selectable-list entries="$ctrl.visibleSections"></selectable-list>\r\n\r\n            <h2>{{ \'Tag\' | translate }}</h2>\r\n            <input id="inputTag" type="text" class="form-control" ng-model="$ctrl.paragraph.tag">\r\n            <br>\r\n\r\n            <button type="button" class="btn btn-default"\r\n                    aria-label="{{ \'Back\' | translate}}"\r\n                    title="{{ \'Back\' | translate}}"\r\n                    ng-click="$ctrl.abortTagChanges()">\r\n                {{ \'Back\' | translate }}\r\n            </button>\r\n            <button type="button" class="btn btn-primary"\r\n                    aria-label="{{ \'Save changes\' | translate }}"\r\n                    title="{{ \'Save changes\' | translate }}"\r\n                    ng-click="$ctrl.saveTagChanges()">{{ \'Save\' | translate }}</button>\r\n        </div>\r\n\r\n        <div ng-if="!$ctrl.isTagEditable()">\r\n            <description game-id="$ctrl.game.id" paragraph="$ctrl.paragraph">\r\n            </description>\r\n\r\n            <goto game-id="$ctrl.game.id" paragraph="$ctrl.paragraph">\r\n            </goto>\r\n\r\n            <collapse ng-if="$ctrl.isMapAvailable()" title="{{ \'Map\' | translate }}" flag="game.map">\r\n                <nodes game-id="$ctrl.game.id" adventure-id="$ctrl.adventureId" root-paragraph-nr="$ctrl.paragraph.paragraphNr"></nodes>\r\n            </collapse>\r\n\r\n            <collapse ng-if="$ctrl.isCharactersAvailable()" title="{{ \'Characters\' | translate }}" flag="game.characters">\r\n                <characters-deprecated game-id="$ctrl.game.id"></characters-deprecated>\r\n                <characters game-id="$ctrl.game.id"></characters>\r\n            </collapse>\r\n\r\n            <collapse ng-if="$ctrl.isDicesAvailable()" title="{{ \'Dices\' | translate }}" flag="game.dices">\r\n                <dices ng-if="$ctrl.isDicesAvailable() && !$ctrl.dicesCollapsed()" game-id="{{$ctrl.game.id}}"></dices>\r\n            </collapse>\r\n\r\n            <div ng-repeat="list in $ctrl.adventure.lists.keys">\r\n                <collapse ng-if="$ctrl.isEntriesAvailable(list)" title="{{ list }}" flag="game.{{list}}">\r\n                    <list entries="$ctrl.game.lists[list]" on-save="$ctrl.onSubListSave(list, entries)"></list>\r\n                </collapse>\r\n            </div>\r\n\r\n            <back-button></back-button>\r\n\r\n            <button type="button"\r\n                    class="btn btn-default"\r\n                    ng-if="$ctrl.isGameRulesAvailable()"\r\n                    ng-click="$ctrl.goToGameRulesParagraph()">\r\n                {{ "Game\'s rules" | translate }}\r\n            </button>\r\n        </div>\r\n    </div>\r\n</main>\r\n<footnote></footnote>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n,i,s,o,l,c,u){r(this,e),this.$location=t,this.constants=a,this.$stateParams=n,this.gamePersistenceService=i,this.adventurePersistenceService=s,this.$translate=o,this.messagesService=l,this.$filter=c,this.$window=u,this.stats=[],this.initData()}return e.$inject=["$location","constants","$stateParams","gamePersistenceService","adventurePersistenceService","$translate","messagesService","$filter","$window"],a(e,[{key:"initData",value:function(){this.game=this.gamePersistenceService.getGame(decodeURIComponent(this.$stateParams.gameId)),this.game.stats&&(this.stats=this.stats.concat(this.game.stats)),this.adventureId=this.$stateParams.adventureId,this.paragraph=this.adventurePersistenceService.getOrCreateParagraph(this.adventureId,this.$stateParams.paragraphNr),this.adventure=this.adventurePersistenceService.getAdventure(this.adventureId),this.visibleSections=this.adventurePersistenceService.getOrCreateVisibleSections(this.adventureId,this.paragraph.tag),this.checkAvailableAdventure()}},{key:"checkAvailableAdventure",value:function(){this.adventure||this.messagesService.errorMessage("The adventure is not available",!1)}},{key:"goToGameRulesParagraph",value:function(){this.gamePersistenceService.setCurrentParagraphNrOfGame(this.game.id,this.paragraph.paragraphNr,this.adventure.gameRulesParagraphId);var e=this.gamePersistenceService.getUrlOfGame(this.game.id);this.$location.url(e)}},{key:"isMapAvailable",value:function(){return!!this.adventure.toggles.map&&!!this.visibleSections.Map.checked}},{key:"isDicesAvailable",value:function(){return!!this.adventure.toggles.dices&&!!this.visibleSections.Dices.checked}},{key:"isCharactersAvailable",value:function(){return!!this.adventure.toggles.characters&&!!this.visibleSections.Characters.checked}},{key:"isEntriesAvailable",value:function(e){return!this.visibleSections[e]||!!this.visibleSections[e].checked}},{key:"isGameRulesAvailable",value:function(){return!!this.adventure.gameRulesParagraphId}},{key:"editDescription",value:function(){this.descriptionEditable=!0,this.originalDescription=this.paragraph.description}},{key:"isDescriptionEditable",value:function(){return this.descriptionEditable}},{key:"saveDescriptionChanges",value:function(){this.originalDescription=null,this.descriptionEditable=!1,this.adventurePersistenceService.updateParagraph(this.adventureId,this.paragraph)}},{key:"abortDescriptionChanges",value:function(){this.paragraph.description=this.originalDescription,this.originalDescription=null,this.descriptionEditable=!1}},{key:"editTag",value:function(){this.tagEditable=!0,this.originalTag=this.paragraph.tag,this.originalVisibileSections=JSON.parse(JSON.stringify(this.visibleSections))}},{key:"isTagEditable",value:function(){return this.tagEditable}},{key:"saveTagChanges",value:function(){this.adventurePersistenceService.updateVisibleSectionsAndParagrahTag(this.adventure.id,this.paragraph,this.visibleSections,this.originalTag),this.originalTag=null,this.tagEditable=!1}},{key:"abortTagChanges",value:function(){this.paragraph.tag=this.originalTag,this.originalTag=null,this.tagEditable=!1,this.visibleSections=this.originalVisibileSections}},{key:"onSubListSave",value:function(e,t){this.game.lists[e]=t,this.gamePersistenceService.updateGame(this.game)}},{key:"now",value:function e(){var e=new Date;return this.$filter("date")(e,"dd.MM.yyyy HH:mm")}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(5),o=a(s),l=r(77),c=a(l),u=r(78),d=a(u),p=i.default.module("app.components.gui.screen.administration",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,r){t.otherwise("/"),e.state("administration",{url:r.url.administration,template:"<administration></administration>"})}]).component("administration",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\r\n<main>\r\n    <div class="container bg-white" role="contentinfo">\r\n        <h2>{{ \'Administration\' | translate }}</h2>\r\n        <div class="col-md-12">\r\n            <form>\r\n                <div>\r\n                    <div class="form-group">\r\n                        <label for="appVersion">{{ "Application\'s version" | translate }}</label>\r\n                        <div id="appVersion">{{ $ctrl.appVersion }}</div>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="usedLocalStorageInPercent">{{ "Used Local\'s Storage in Percent" | translate }}</label>\r\n                        <input type="text" class="form-control" id="usedLocalStorageInPercent" value="{{ $ctrl.usedLocalStorageInPercent | number : 2}}%">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="usedLocalStorage">{{ "Used Local\'s Storage" | translate }}</label>\r\n                        <input type="text" class="form-control" id="usedLocalStorage" value="{{$ctrl.usedLocalStorage / 1024 | number : 2 }}kb">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="remainingCapacity">{{ "Remaining Local\'s Storage" | translate }}</label>\r\n                        <input type="text" class="form-control" id="remainingCapacity" value="{{$ctrl.remainingCapacity / 1024 | number : 2 }}kb">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="applicationData">{{ "Application\'s data" | translate }}</label>\r\n                        <input type="text" class="form-control" id="applicationData" ng-model="$ctrl.applicationData">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="importData">{{ "Paste the application\'s data copied from another browser" | translate }}</label>\r\n                        <input type="text" class="form-control" ng-model="$ctrl.importData" id="importData" placeholder="{{ \'Imported data\' | translate }}">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <button class="btn btn-danger" ng-click="$ctrl.showPopupConfirmImportData()" aria-label="{{ \'Import\' | translate }}">{{ \'Import\' | translate }}</button>\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <div class="form-group">\r\n                        <button class="btn btn-danger" ng-click="$ctrl.showPopupConfirmDeleteApplicationData()" aria-label="{{ \'Delete application\\\'s data\' | translate }}">{{ "Delete application\'s data" | translate }}</button>\r\n                    </div>\r\n                </div>\r\n                <back-button></back-button>\r\n            </form>\r\n\r\n            <popup config="{{ $ctrl.popupConfirmImportApplicationDataConfig }}"></popup>\r\n            <popup config="{{ $ctrl.popupConfirmDeleteApplicationDataConfig }}"></popup>\r\n        </div>\r\n    </div>\r\n</main>\r\n<footnote></footnote>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n,i,s){r(this,e),this.persistenceService=t,this.adventurePersistenceService=a,this.constants=n,this.popupService=i,this.initData(),this.$window=s,this.popupConfirmImportApplicationDataConfig={id:"popupConfirmImportApplicationData",text:"All existing application's data will be erased during the import. Are you sure to import the application data?",choices:[n.choices.yes,n.choices.no]},this.popupConfirmDeleteApplicationDataConfig={id:"popupConfirmDeleteApplicationData",text:"Are you sure to clear the application data?",choices:[n.choices.yes,n.choices.no]}}return e.$inject=["persistenceService","adventurePersistenceService","constants","popupService","$window"],
a(e,[{key:"initData",value:function(){this.appVersion=this.constants.version,this.applicationData=this.persistenceService.export(),this.computeLocalStorageCapacities()}},{key:"computeLocalStorageCapacities",value:function(){this.usedLocalStorage=this.persistenceService.getUsedCapacity(),this.remainingCapacity=this.persistenceService.getRemainingCapacity(),this.usedLocalStorageInPercent=this.persistenceService.getUsedCapacityInPercent()}},{key:"showPopupConfirmImportData",value:function(){var e=this;this.popupService.show(this.popupConfirmImportApplicationDataConfig.id,function(t,r){r===e.constants.choices.yes&&(e.persistenceService.import(e.importData),e.$window.location.reload())})}},{key:"showPopupConfirmDeleteApplicationData",value:function(){var e=this;this.popupService.show(this.popupConfirmDeleteApplicationDataConfig.id,function(t,r){r===e.constants.choices.yes&&(e.persistenceService.cleanAllData(),e.$window.location.reload())})}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(5),o=a(s),l=r(80),c=a(l),u=r(81),d=a(u),p=i.default.module("app.components.gui.screen.credits",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,r){t.otherwise("/"),e.state("credits",{url:r.url.credits,template:"<credits></credits>"})}]).component("credits",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\r\n<main>\r\n    <div class="container bg-white" role="main">\r\n        <h1>{{ \'Credits\' | translate }}</h1>\r\n        <div class="text-muted">{{ \'sorted alphabetically\' | translate }}</div>\r\n\r\n        <ul>\r\n            <li ng-repeat="credit in $ctrl.credits">\r\n                <a href="{{ credit.url }}" target="_blank">{{ credit.resourceName }}</a>\r\n                <ng-if ng-if="!!credit.author">{{ \'by\' | translate }} {{ credit.author }}</ng-if>\r\n                <ng-if ng-if="!!credit.description">({{ credit.description | translate }})</ng-if>\r\n            </li>\r\n        </ul>\r\n\r\n        <back-button></back-button>\r\n    </div>\r\n</main>\r\n<footnote></footnote>\r\n'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(){r(this,e);var t=[{resourceName:"JavaScript",author:"Brendan Eich",url:"https://en.wikipedia.org/wiki/JavaScript",description:"credit_description_javascript"},{resourceName:"Image",author:"Ravenmore",url:"//opengameart.org/content/fantasy-icon-pack-by-ravenmore-0",description:"credit_description_map_image"},{resourceName:"ESTA Web/JS",author:"Schweizerische Bundesbahnen",url:"https://github.com/SchweizerischeBundesbahnen/esta-webjs",description:"credit_description_estawebjs"},{resourceName:"AngularJS1",author:"Google",url:"https://angularjs.org/",description:"credit_description_angularjs"},{resourceName:"Bootstrap",author:"Twitter",url:"http://getbootstrap.com/",description:"credit_description_bootstrap"},{resourceName:"Webpack",url:"https://webpack.github.io/docs/",description:"credit_description_webpack"},{resourceName:"Gulp",url:"http://gulpjs.com/",description:"credit_description_gulp"},{resourceName:"npm",url:"https://www.npmjs.com/",description:"credit_description_npm"},{resourceName:"node.js",url:"https://nodejs.org/en/",description:"credit_description_nodejs"},{resourceName:"Browsersync",url:"https://www.browsersync.io/",description:"credit_description_browsersync"},{resourceName:"angular translate",url:"https://github.com/angular-translate/angular-translate",description:"credit_description_angular-translate"},{resourceName:"AngularUI Router",url:"https://github.com/angular-ui/ui-router",description:"credit_description_angular-ui-router"},{resourceName:"Babel",url:"https://babeljs.io/",description:"credit_description_babel"},{resourceName:"RealFaviconGenerator",url:"https://realfavicongenerator.net/",description:"credit_description_realfavicongenerator"},{resourceName:"GitHub",url:"https://github.com/",description:"credit_description_github"},{resourceName:"Modern Clean CSS “Sticky Footer”",author:"Rizqy Hidayat",url:"http://mystrd.at/modern-clean-css-sticky-footer/",description:"credit_description_article_sticky_footer"},{resourceName:"Responsive Navigation Patterns",author:"Brad Frost",url:"http://bradfrost.com/blog/web/responsive-nav-patterns/",description:"credit_description_article_responsive_navigation_patterns"}];this.credits=this.sort(t)}return a(e,[{key:"sort",value:function(e){return e.sort(this.compareCredit)}},{key:"compareCredit",value:function(e,t){return e||t?e?t?e.resourceName.localeCompare(t.resourceName):-1:1:0}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(83),o=a(s),l=i.default.module("app.components.gui.screens.adventures",[o.default.name]);t.default=l},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(5),o=a(s),l=r(84),c=a(l),u=r(85),d=a(u),p=i.default.module("app.components.gui.screen.adventures.detail",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,r){t.otherwise("/"),e.state("adventure-detail",{url:r.url.adventureDetail+"/{adventureId}",template:"<adventure-detail></adventure-detail>"})}]).component("adventureDetail",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports='<messages></messages>\r\n<main>\r\n    <div class="container bg-white" role="main">\r\n        <h2>{{ $ctrl.adventure.name }}</h2>\r\n        <div class="col-md-12">\r\n            <form name="adventureTableForm" novalidate="novalidate" ng-submit="$ctrl.save()">\r\n                <h2>{{ \'General\' | translate }}</h2>\r\n                <div>\r\n                    <div class="form-group" ng-if="!$ctrl.adventure.id">\r\n                        <label for="name">{{ \'Name\' | translate }}</label>\r\n                        <input type="text" class="form-control" id="name" ng-model="$ctrl.adventure.name" required>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="serie">{{ \'Serie\' | translate }}</label>\r\n                        <input type="text" class="form-control" id="serie" ng-model="$ctrl.adventure.serie">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="authors">{{ \'Author(s)\' | translate }}</label>\r\n                        <input type="text" class="form-control" id="authors" ng-model="$ctrl.adventure.authors" required>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="description">{{ \'Description\' | translate }}</label>\r\n                        <textarea id="description" class="form-control" ng-model="$ctrl.adventure.description"></textarea>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="version">{{ \'Version\' | translate }}</label>\r\n                        <input type="text" class="form-control" id="version" ng-model="$ctrl.adventure.version" required>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="language">{{ \'Language\' | translate }}</label>\r\n                        <input type="text" class="form-control" id="language" ng-model="$ctrl.adventure.language" required>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="homepage">{{ \'Homepage\' | translate }}</label>\r\n                        <input type="text" class="form-control" id="homepage" ng-model="$ctrl.adventure.homepage">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="isbn">{{ \'ISBN\' | translate }}</label>\r\n                        <input type="text" class="form-control" id="isbn" ng-model="$ctrl.adventure.isbn">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="startParagraphId">{{ \'First paragraph\' | translate }}</label>\r\n                        <input type="text" class="form-control" id="startParagraphId" ng-model="$ctrl.adventure.startParagraphId" required>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="gameRulesParagraphId">{{ "Game\'s rules paragraph" | translate }}</label>\r\n                        <input type="text" class="form-control" id="gameRulesParagraphId" ng-model="$ctrl.adventure.gameRulesParagraphId">\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label for="homepage">{{ \'Download URL\' | translate }}</label>\r\n                        <input type="text" class="form-control" id="homepage" ng-model="$ctrl.adventure.downloadUrl">\r\n                    </div>\r\n                </div>\r\n\r\n                <h2>{{ \'Features\' | translate }}</h2>\r\n\r\n                <div>\r\n                    <div class="form-group">\r\n                        <label>\r\n                            <input type="checkbox" value="" ng-model="$ctrl.adventure.toggles.characters">\r\n                            {{ \'Enable characters with stats\' | translate }}\r\n                        </label>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label>\r\n                            <input type="checkbox" value="" ng-model="$ctrl.adventure.toggles.dices">\r\n                            {{ \'Enable dices\' | translate }}\r\n                        </label>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label>\r\n                            <input type="checkbox" value="" ng-model="$ctrl.adventure.toggles.goto">\r\n                            {{ \'Enable Go to paragraph\' | translate }}\r\n                        </label>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <label>\r\n                            <input type="checkbox" value="" ng-model="$ctrl.adventure.toggles.map">\r\n                            {{ \'Enable map\' | translate }}\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n\r\n                <div ng-if="$ctrl.adventure.toggles.dices">\r\n                    <h2>{{ \'Dices\' | translate }}</h2>\r\n                    <div>\r\n                        <div class="form-group">\r\n                            <label for="diceMin">{{ "Minimal dice\'s value" | translate }}</label>\r\n                            <input type="number" class="form-control" id="diceMin" ng-model="$ctrl.adventure.dice.min"\r\n                                   ng-required="$ctrl.adventure.toggles.dices">\r\n                        </div>\r\n                        <div class="form-group">\r\n                            <label for="diceMax">{{ "Maximal dice\'s value" | translate }}</label>\r\n                            <input type="number" class="form-control" id="diceMax" ng-model="$ctrl.adventure.dice.max"\r\n                                   ng-required="$ctrl.adventure.toggles.dices">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <h2>{{ \'Lists\' | translate }}</h2>\r\n                <list entries="$ctrl.adventure.lists.keys" on-save="$ctrl.onListSave(entries)"></list>\r\n\r\n                <div ng-repeat="list in $ctrl.adventure.lists.keys">\r\n                    <h2>{{ list }}</h2>\r\n                    <list entries="$ctrl.adventure.lists.values[list]" on-save="$ctrl.onSubListSave(list, entries)"></list>\r\n\r\n                    <label>\r\n                        <input type="checkbox" value="" ng-model="$ctrl.adventure.lists.keepOnRestart[list]">\r\n                        {{ \'Keep on restart\' | translate }}\r\n                    </label>\r\n                </div>\r\n            </form>\r\n        </div>\r\n        <back-button></back-button>\r\n        <button type="button" class="btn btn-primary"\r\n                aria-label="{{ \'Save changes\' | translate }}"\r\n                title="{{ \'Save changes\' | translate }}"\r\n                ng-click="$ctrl.save(adventureTableForm)">{{ \'Save\' | translate }}</button>\r\n    </div>\r\n</main>\r\n<footnote></footnote>'},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n,i,s,o,l,c,u,d,p,h){r(this,e),this.persistenceService=t,this.adventurePersistenceService=a,this.$stateParams=n,this.$location=i,this.constants=s,this.popupService=o,this.messagesService=l,this.$timeout=c,this.$window=u,this.formHelperService=d,this.$translate=p,this.$log=h,this.initData(),this.setInitialFocus()}return e.$inject=["persistenceService","adventurePersistenceService","$stateParams","$location","constants","popupService","messagesService","$timeout","$window","formHelperService","$translate","$log"],a(e,[{key:"initData",value:function(){var e=encodeURIComponent(this.$stateParams.adventureId);e&&("create"===e?(this.adventure={toggles:{battle:!0,dices:!0,goto:!0,characters:!0,map:!0}},this.mode="create"):(this.adventure=this.adventurePersistenceService.getAdventure(e),this.mode="edit"),this.adventure.lists||(this.adventure.lists={values:{}}))}},{key:"setInitialFocus",value:function(){var e=this;this.$timeout(function(){var t=void 0;t="create"===e.mode?e.$window.document.getElementById("name"):e.$window.document.getElementById("authors"),t&&t.focus()})}},{key:"save",value:function(e){if(this.formHelperService.setErrorFieldsAsDirty(e,!0),!e.$invalid){this.adventure.toggles.dices||delete this.adventure.dice;try{this.adventurePersistenceService.updateAdventureWithoutParagraphs(this.adventure),this.$location.url(this.constants.url.games)}catch(e){this.$log.warn(e)}}}},{key:"onListSave",value:function(e){if(this.adventure.lists.keys)for(var t=0;t<this.adventure.lists.keys.length;t++){var r=this.adventure.lists.keys[t];e.indexOf(r)===-1&&delete this.adventure.lists.values[r]}this.adventure.lists.keys=e}},{key:"onSubListSave",value:function(e,t){this.adventure.lists.values[e]=t}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(5),o=a(s),l=r(87),c=a(l),u=r(88),d=a(u),p=i.default.module("app.components.gui.screen.library-import",[o.default]).config(["$stateProvider","$urlRouterProvider","constants",function(e,t,r){t.otherwise("/"),e.state("libraryImport",{url:r.url.libraryImport+"?import",template:"<library-import></library-import>"})}]).component("libraryImport",{template:c.default,controller:d.default});t.default=p},function(e,t){e.exports="<messages></messages>\r\n<main>\r\n</main>\r\n<footnote></footnote>\r\n"},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n,i,s){r(this,e),this.constants=a,this.$location=t,this.libraryPersistenceService=i,this.messagesService=n,this.$stateParams=s,s.import?this.downloadLibrary(s.import):this.displayAdventures()}return e.$inject=["$location","constants","messagesService","libraryPersistenceService","$stateParams"],a(e,[{key:"downloadLibrary",value:function(e){var t=this,r=this.libraryPersistenceService.downloadLibrary(e);r.then(function(e){t.displayAdventures()},function(e){t.messagesService.errorMessage(e,!1)})}},{key:"displayAdventures",value:function(){this.$location.url(this.constants.url.games)}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(90),o=a(s),l=r(100),c=a(l),u=r(102),d=a(u),p=r(104),h=a(p),f=r(106),g=a(f),v=i.default.module("app.components.services",[o.default.name,c.default.name,d.default.name,h.default.name,g.default.name]);t.default=v},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(91),o=a(s),l=r(93),c=a(l),u=r(95),d=a(u),p=r(97),h=a(p),f=r(98),g=a(f),v=i.default.module("app.components.services.persistence",[o.default.name,c.default.name,d.default.name,g.default.name]).service("persistenceService",h.default);t.default=v},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(92),o=a(s),l=i.default.module("app.components.services.persistence.game",[]).service("gamePersistenceService",o.default);t.default=l},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=function(){function e(t,a,n,i,s,o,l){r(this,e),this.persistenceService=a,this.adventurePersistenceService=n,this.constants=t,this.messagesService=i,this.$q=s,this.remoteJsonRetrieverService=o,this.$translate=l}return e.$inject=["constants","persistenceService","adventurePersistenceService","messagesService","$q","remoteJsonRetrieverService","$translate"],n(e,[{key:"downloadGame",value:function(e){var t=this,r=this.$q.defer(),a=this.remoteJsonRetrieverService.retrieveJson(e);return a.then(function(e){t.importGame(JSON.stringify(e)),r.resolve("Success")},function(e){t.messagesService.errorMessage(e,!1),r.reject(e)}),r.promise}},{key:"getSelectedLanguage",value:function(){return this.persistenceService.get(this.constants.data.selectedLanguage)}},{key:"setSelectedLanguage",value:function(e){this.persistenceService.save(this.constants.data.selectedLanguage,e)}},{key:"addGame",value:function(e){var t={id:this.newGameId(),name:e.name,adventureId:e.adventureId,currentParagraphNr:e.currentParagraphNr};return e.lists&&(t.lists=e.lists),t.characters=[],this.updateGame(t),t}},{key:"exportGame",value:function(e){var t=this.getGame(e);if(t.characters)for(var r=0;r<t.characters.length;r++)if(delete t.characters[r].$$hashKey,t.characters[r].stats)for(var a=0;a<t.characters[r].stats.length;a++)delete t.characters[r].stats[a].$$hashKey;return this.sortObjectKeys(t)}},{key:"sortObjectKeys",value:function(e){var t=e;if(e)if(Array.isArray(e)){t=[];for(var r=0;r<e.length;r++)t.push(this.sortObjectKeys(e[r]))}else if("object"===("undefined"==typeof e?"undefined":a(e))){var n=Object.keys(e);if(n&&n.length>0){n=n.sort(),t={};for(var i=0;i<n.length;i++){var s=e[n[i]];s=this.sortObjectKeys(s),t[n[i]]=s}}}return t}},{key:"importGame",value:function(e){try{var t=JSON.parse(e),r=[];t.id||(t.id=this.newGameId()),t.adventureId||r.push("adventureId"),t.currentParagraphNr||r.push("currentParagraphNr"),r.length>0?this.messagesService.errorMessage(this.$translate.instant("ImportGameFailedMissingFields",{missingMandatoryFields:r.join(", ")}),!1):this.getGame(t.id)?this.messagesService.errorMessage(this.$translate.instant("GameAlreadyExists",{gameId:t.id}),!1):this.updateGame(t)}catch(e){this.messagesService.errorMessage(this.$translate.instant("Cannot import game"),!1)}}},{key:"updateGame",value:function(e){if(e){e=JSON.parse(JSON.stringify(e)),e.time=this.adventurePersistenceService.now();var t=this.getGamePersistenceKey(e.id);this.persistenceService.save(t,e)}}},{key:"deleteGame",value:function(e){var t=this.getGamePersistenceKey(e);localStorage.removeItem(t)}},{key:"newGameId",value:function(){return(new Date).getTime().toString()}},{key:"getUrlOfGame",value:function(e,t){var r=this.getGame(e);t||(t=r.currentParagraphNr);var a="/"+encodeURIComponent(r.adventureId)+"/"+encodeURIComponent(t)+"/game/"+encodeURIComponent(r.id);return a}},{key:"getGame",value:function(e){var t=this.getGamePersistenceKey(e);return this.persistenceService.get(t)}},{key:"getGamePersistenceKeys",value:function(){return this.persistenceService.findKeysWithPrefix(this.constants.data.game)}},{key:"getGamePersistenceKey",value:function(e){var t=e;return 0!==t.indexOf(this.constants.data.game)&&(t=this.constants.data.game+"."+t),t}},{key:"setCurrentParagraphNrOfGame",value:function(e,t,r){var a=this.getGame(e);if(t){var n=a.choosenParagraphs;n||(n=[],a.choosenParagraphs=n),n.indexOf(r)===-1&&n.push(r)}a.currentParagraphNr=r,a.path||(a.path=[]),a.path.push(r),this.updateGame(a)}},{key:"getChoosenChoices",value:function(e,t){var r=this.getGame(e),a=r.choosenParagraphs;if(a){var n=this.adventurePersistenceService.getParagraph(r.adventureId,t),i=[],s=this.adventurePersistenceService.getParagraphChoices(n);if(s)for(var o=0;o<s.length;o++)a.indexOf(s[o])!==-1&&i.push(""+s[o]);return i}return[]}},{key:"getGames",value:function(e){for(var t=this.getGamePersistenceKeys(),r=[],a=0;a<t.length;a++){var n=this.getGame(t[a]);n.adventureId===e&&r.push(n)}return r}},{key:"startGame",value:function(e,t){var r=this.adventurePersistenceService.getAdventure(e),a={name:t,adventureId:r.id};if(r.lists&&r.lists.keys){a.lists={};for(var n=0;n<r.lists.keys.length;n++)a.lists[r.lists.keys[n]]=[];for(var i=Object.keys(r.lists.values),s=0;s<i.length;s++)a.lists[i[s]]=r.lists.values[i[s]]}return a=this.addGame(a),this.setCurrentParagraphNrOfGame(a.id,null,r.startParagraphId),a}},{key:"restart",value:function(e){var t=this.getGame(e),r=this.adventurePersistenceService.getAdventure(t.adventureId);if(t.path=[],t.characters)for(var a=0;a<t.characters.length;a++)if(t.characters[a].stats)for(var n=0;n<t.characters[a].stats.length;n++)t.characters[a].stats[n].current=t.characters[a].stats[n].initial;if(r.lists&&r.lists.keys)for(var i=0;i<r.lists.keys.length;i++){var s=r.lists.keys[i],o=!!r.lists.keepOnRestart&&!!r.lists.keepOnRestart[s];if(!o&&t.lists&&delete t.lists[s],r.lists.values&&r.lists.values[s]){t.lists[s]||(t.lists[s]=[]);for(var l=0;l<r.lists.values[s].length;l++){var c=r.lists.values[s][l];t.lists[s].indexOf(c)===-1&&t.lists[s].push(c)}}}this.updateGame(t),this.setCurrentParagraphNrOfGame(e,null,r.startParagraphId)}}]),e}();t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(94),o=a(s),l=i.default.module("app.components.services.persistence.adventure",[]).service("adventurePersistenceService",o.default);t.default=l},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=function(){function e(t,a,n,i,s,o,l){r(this,e),this.constants=t,this.persistenceService=a,this.messagesService=n,this.$translate=i,this.$q=s,this.remoteJsonRetrieverService=o,this.$filter=l}return e.$inject=["constants","persistenceService","messagesService","$translate","$q","remoteJsonRetrieverService","$filter"],n(e,[{key:"downloadAdventureWithId",value:function(e){var t=this.getAdventure(e);return this.downloadAdventure(t,t.downloadUrl)}},{key:"downloadAdventure",value:function(e,t){var r=this,a=this.$q.defer(),n=this.remoteJsonRetrieverService.retrieveJson(t);return n.then(function(t){e?t.id=e.id:t.id=r.getAdventureIdFromAdventureName(t.name),r.import(t),r.messagesService.successMessage(r.$translate.instant("AdventureDownloaded",{adventure:t.name}),!1),a.resolve("Success")},function(e){r.messagesService.errorMessage(e,!1),a.reject(e)}),a.promise}},{key:"now",value:function e(){var e=new Date;return this.$filter("date")(e,"dd.MM.yyyy HH:mm")}},{key:"updateDownloadableAdventures",value:function(e){if(e)for(var t=0;t<e.length;t++)this.updateDownloadableAdventure(e[t])}},{key:"updateDownloadableAdventure",value:function(e){var t=this.getAdventure(e.id);t&&t.downloaded||this.updateAdventureWithoutParagraphs(e)}},{key:"getAdventuresOverview",value:function(){for(var e=this.getAdventurePersistenceKeys(),t=[],r=0;r<e.length;r++){var a=this.persistenceService.get(e[r]);t.push({id:a.id,name:a.name,numberOfParagraphs:a.numberOfParagraphs,language:a.language,version:a.version,authors:a.authors,serie:a.serie,downloadUrl:a.downloadUrl,downloadHistory:a.downloadHistory,downloaded:a.downloaded})}return t}},{key:"getAdventurePersistenceKeys",value:function(){for(var e=Object.keys(localStorage),t=[],r=0;r<e.length;r++)0===e[r].indexOf(this.constants.data.adventure)&&e[r].indexOf("paragraph.")===-1&&e[r].indexOf(".choosen")===-1&&t.push(e[r]);return t}},{key:"getAdventure",value:function(e){return this.persistenceService.get(this.getAdventurePersistenceKey(e))}},{key:"importAdventure",value:function(e){try{var t=JSON.parse(e,!0);this.import(t)}catch(e){this.messagesService.errorMessage(this.$translate.instant("Cannot import adventure"),!1)}}},{key:"import",value:function(e,t){try{var r=[];if(e.id||r.push("id"),e.name||r.push("name"),e.authors||r.push("authors"),e.version||r.push("version"),e.language||r.push("language"),e.startParagraphId||r.push("startParagraphId"),r.length>0)this.messagesService.errorMessage(this.$translate.instant("ImportGameFailedMissingFields",{missingMandatoryFields:r.join(", ")}),!1);else if(t&&this.getAdventure(e.id))this.messagesService.errorMessage(this.$translate.instant("AdventureAlreadyExists",{adventure:e.id}),!1);else if(e.paragraphs&&(e.numberOfParagraphs=e.paragraphs.length),e.downloadUrl&&(e.downloaded=!0),this.updateAdventureWithoutParagraphs(e),e.paragraphs)for(var a=0;a<e.paragraphs.length;a++)this.setParagraph(e.id,e.paragraphs[a],t)}catch(e){this.messagesService.errorMessage(this.$translate.instant("Cannot import adventure"),!1)}}},{key:"updateVisibleSectionsAndParagrahTag",value:function(e,t,r,a){t.tag||delete t.tag,this.updateParagraph(e,t),this.updateVisibleSections(e,t,r,a)}},{key:"updateVisibleSections",value:function(e,t,r,a){a=this.getTag(a);var n=this.getTag(t.tag),i=this.getOrCreateVisibleSections(e,n);a!==n&&this.deleteVisibleSectionsIfUnused(e,a);for(var s=Object.keys(r),o=0;o<s.length;o++){var l=s[o];i[l]=r[l]}this.saveVisibleSections(e,i,n)}},{key:"deleteVisibleSectionsIfUnused",value:function(e,t){var r=!1,a=this.getParagraphs(e);if(a)for(var n=0;n<a.length;n++){var i=a[n];if(i.tag&&t===i.tag){r=!0;break}}if(!r){var s=this.getAdventure(e);delete s.visibleSections[t],this.updateAdventureWithoutParagraphs(s)}}},{key:"getOrCreateVisibleSections",value:function(e,t){t=this.getTag(t);var r=this.getAdventure(e);r.visibleSections||(r.visibleSections={});var a=r.visibleSections[t];if(!a){if(a={},r.toggles.map&&(a.Map={value:this.$translate.instant("Map"),checked:!0}),r.toggles.characters&&(a.Characters={value:this.$translate.instant("Characters"),checked:!0}),r.toggles.dices&&(a.Dices={value:this.$translate.instant("Dices"),checked:!0}),r.lists)for(var n=0;n<r.lists.keys.length;n++)a[r.lists.keys[n]]={value:r.lists.keys[n],checked:!0};this.saveVisibleSections(r.id,a,t)}return a}},{key:"saveVisibleSections",value:function(e,t,r){var a=this.getAdventure(e);a.visibleSections||(a.visibleSections={}),a.visibleSections[r]=t,this.updateAdventureWithoutParagraphs(a)}},{key:"getTag",value:function(e){return e||(e="withoutTag"),e}},{key:"updateAdventureWithoutParagraphs",value:function(e){var t=this.getAdventureIdFromAdventureName(e.name);if(!e.id){e.id=t;var r=this.getAdventure(t);if(r)throw this.messagesService.errorMessage(this.$translate.instant("AdventureAlreadyExists",{adventure:t}),!1),this.constants.errors.adventureAlreadyExist}for(var a={},n=Object.keys(e),i=0;i<n.length;i++)"paragraphs"!==n[i]&&(a[n[i]]=e[n[i]]);this.persistenceService.save(this.constants.data.adventure+"."+e.id,a)}},{key:"getAdventureIdFromAdventureName",value:function(e){return encodeURIComponent(e.replace(/\s+/g,"-").toLowerCase())}},{key:"deleteAdventureAndParagraphs",value:function(e){this.persistenceService.remove(this.getAdventurePersistenceKey(e));for(var t=this.getAdventureParagraphKeys(e),r=0;r<t.length;r++)this.persistenceService.remove(t[r])}},{key:"setParagraph",value:function(e,t,r){var a=this.getParagraphPersistenceKey(e,t.paragraphNr);if(r){var n=this.persistenceService.get(a);if(n)return void this.messagesService.errorMessage(this.$translate.instant("DupplicateParagraph",{paragraphNr:t.paragraphNr}),!0)}this.persistenceService.save(a,t)}},{key:"getOrCreateParagraph",value:function(e,t){var r=this.getParagraph(e,t);if(r)return r;var a={version:this.constants.version,adventureId:e,paragraphNr:t,description:""},n=this.getAdventure(e);return n.numberOfParagraphs||(n.numberOfParagraphs=0),n.numberOfParagraphs=n.numberOfParagraphs+1,this.updateAdventureWithoutParagraphs(n),this.updateParagraph(e,a),a}},{key:"getParagraph",value:function(e,t){var r=this.getParagraphPersistenceKey(e,t);return this.persistenceService.get(r)}},{key:"updateParagraph",value:function(e,t){if(t){t=JSON.parse(JSON.stringify(t));var r=this.getParagraphPersistenceKey(e,t.paragraphNr);this.persistenceService.save(r,t)}}},{key:"getParagraphChoices",value:function(e){var t=this.getDescriptionParagraphs(e.description),r=[];if(t)for(var a=0;a<t.length;a++)for(var n=t[a],i=0;i<n.length;i++){var s=n[i];s.choice&&r.push(s.text)}return r}},{key:"getDescriptionParagraphs",value:function(e){for(var t=this.getLines(e),r=[],a=0;a<t.length;a++){for(var n=t[a],i=[];this.hasChoice(n);){var s=n.indexOf("§"),o=n.indexOf("§",s+1),l=n.slice(0,s);l&&l.trim().length>0&&i.push({choice:!1,text:l});var c=n.slice(s+1,o);c&&c.trim().length>0&&i.push({choice:!0,text:c}),n=n.substr(o+1)}i.push({choice:!1,text:n}),r.push(i)}return r}},{key:"getLines",value:function(e){var t=[];if(e)for(var r=e.split("\n"),a=0;a<r.length;a++){var n=r[a];t.push(n)}return t}},{key:"hasChoice",value:function(e){var t=e.indexOf("§"),r=e.indexOf("§",t+1);return t!==-1&&r!==-1}},{key:"getAdventureParagraphKeys",value:function(e){for(var t=[],r=Object.keys(localStorage),a=this.constants.data.adventure+"."+e,n=0;n<r.length;n++)if(0===r[n].indexOf(this.constants.data.adventure)&&r[n].indexOf("paragraph.")!==-1){
var i=r[n].substring(0,r[n].indexOf(".paragraph"));i===a&&t.push(r[n])}return t}},{key:"getParagraphPersistenceKey",value:function(e,t){return this.getAdventurePersistenceKey(e)+".paragraph."+t}},{key:"getAdventurePersistenceKey",value:function(e){var t=e;return 0!==t.indexOf(this.constants.data.adventure+".")&&(t=this.constants.data.adventure+"."+t),t}},{key:"exportAdventure",value:function(e){var t=this.getAdventure(e);if(t.stats)for(var r=0;r<t.stats.length;r++)delete t.stats[r].$$hashKey;t.downloadUrl,delete t.numberOfParagraphs,t=this.sortObjectKeys(t);var a=t.stats;delete t.stats;var n=t.items;return delete t.items,delete t.downloaded,t.items=n,t.stats=a,t.paragraphs=this.getParagraphs(e),t}},{key:"getParagraphs",value:function(e){for(var t=[],r=Object.keys(localStorage),a=this.constants.data.adventure+"."+e,n=0;n<r.length;n++)if(0===r[n].indexOf(a+".paragraph")){var i=r[n].substring(0,r[n].indexOf(".paragraph"));if(i===a){var s=this.persistenceService.get(r[n]);s&&(delete s.version,delete s.adventureId,s.notes&&0===s.notes.length&&delete s.notes,t.push(this.sortObjectKeys(s)))}}return t=this.sortParagraphs(t)}},{key:"sortObjectKeys",value:function(e){var t=void 0;if(null==e)t=e;else if(Array.isArray(e)){t=[];for(var r=0;r<e.length;r++)t.push(this.sortObjectKeys(e[r]))}else if("object"===("undefined"==typeof e?"undefined":a(e))){var n=Object.keys(e);if(n&&n.length>0){n=n.sort(),t={};for(var i=0;i<n.length;i++){var s=e[n[i]];s=this.sortObjectKeys(s),t[n[i]]=s}}else t=e}else t=e;return t}},{key:"sortParagraphs",value:function(e){return e.sort(this.compareParagraph)}},{key:"compareParagraph",value:function(e,t){return e||t?e?t?e.paragraphNr-t.paragraphNr:-1:1:0}}]),e}();t.default=i},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(96),o=a(s),l=i.default.module("app.components.services.persistence.library",[]).service("libraryPersistenceService",o.default);t.default=l},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n){r(this,e),this.remoteJsonRetrieverService=t,this.$q=a,this.adventurePersistenceService=n}return e.$inject=["remoteJsonRetrieverService","$q","adventurePersistenceService"],a(e,[{key:"downloadLibrary",value:function(e){var t=this,r=this.$q.defer(),a=this.remoteJsonRetrieverService.retrieveJson(e);return a.then(function(e){t.adventurePersistenceService.updateDownloadableAdventures(e),r.resolve("Success")},function(e){r.reject(e)}),r.promise}}]),e}();t.default=n},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t){r(this,e),this.messagesService=t,this.checkLocalStorageSupported()}return e.$inject=["messagesService"],a(e,[{key:"checkLocalStorageSupported",value:function(){this.isLocalStorageSupported=!0,this.testLocalStorageSupported()||(this.isLocalStorageSupported=!1,this.messagesService.errorMessage("The application cannot be used because the version of the browser is too old or because it is not possible to save data in 'localStorage'.",!0))}},{key:"testLocalStorageSupported",value:function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}}},{key:"findKeysWithPrefix",value:function(e){if(!this.isLocalStorageSupported)return null;for(var t=Object.keys(localStorage),r=[],a=0;a<t.length;a++)0===t[a].indexOf(e)&&r.push(t[a]);return r}},{key:"get",value:function(e){if(!this.isLocalStorageSupported)return null;var t=localStorage.getItem(e);if(null===t||"undefined"===t||void 0===t)return null;try{return JSON.parse(t)}catch(e){return t}}},{key:"save",value:function(e,t){this.isLocalStorageSupported&&("string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t)))}},{key:"remove",value:function(e){this.isLocalStorageSupported&&localStorage.removeItem(e)}},{key:"import",value:function(e){if(this.isLocalStorageSupported){this.cleanAllData();for(var t=JSON.parse(e),r=Object.keys(t),a=0;a<r.length;a++)this.save(r[a],t[r[a]])}}},{key:"export",value:function(){return JSON.stringify(localStorage)}},{key:"cleanAllData",value:function(){this.isLocalStorageSupported&&localStorage.clear()}},{key:"getUsedCapacity",value:function(){return this.isLocalStorageSupported?unescape(encodeURIComponent(JSON.stringify(localStorage))).length:0}},{key:"getRemainingCapacity",value:function(){for(var e="0123456789",t=this.repeat(e,10),r=this.repeat(t,10),a=this.repeat(r,10),n=this.repeat(a,10),i=this.repeat(n,10),s=[i,n,a,r,t,e],o=0;o<s.length;o++)for(;this.setLocalStorageWithoutError(s[o]););var l=this.getUsedCapacity();return delete localStorage.test,l}},{key:"getUsedCapacityInPercent",value:function(){var e=this.getUsedCapacity(),t=this.getRemainingCapacity(),r=e+t;return e/r*100}},{key:"setLocalStorageWithoutError",value:function(e){try{return localStorage.test=localStorage.test+e,!0}catch(e){return!1}}},{key:"repeat",value:function(e,t){for(var r=[];t--;)r.push(e);return r.join("")}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(99),o=a(s),l=i.default.module("app.components.services.persistence.map",[]).service("mapPersistenceService",o.default);t.default=l},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a){r(this,e),this.adventurePersistenceService=t,this.gamePersistenceService=a,this.nodeSequence=1}return e.$inject=["adventurePersistenceService","gamePersistenceService"],a(e,[{key:"getMap",value:function(e,t){var r=this.adventurePersistenceService.exportAdventure(e),a=this.getKnownNodes(e),n=this.createNodeRecursively(r.paragraphs,t,[],a);return n}},{key:"getKnownNodes",value:function(e){for(var t=this.gamePersistenceService.getGames(e),r=[],a=0;a<t.length;a++)for(var n=t[a],i=0;i<n.path.length;i++)r[n.path[i]]=!0;return r}},{key:"findParagraph",value:function(e,t){for(var r=0;r<e.length;r++)if(t==e[r].paragraphNr)return e[r];return null}},{key:"createNodeRecursively",value:function(e,t,r,a){var n=this.findParagraph(e,t);if(n&&a[t]){var i=r[n.paragraphNr],s=void 0;if(i)s=this.createNodeLink(n.paragraphNr,i);else{s=this.createNode(n),r[n.paragraphNr]=s.id;var o=this.adventurePersistenceService.getParagraphChoices(n);if(o){s.children=[];for(var l=0;l<o.length;l++)s.children.push(this.createNodeRecursively(e,o[l],r,a))}}return s}return this.createUnknownNode(t)}},{key:"createNode",value:function(e){var t={id:this.newNodeId(),name:e.paragraphNr};return e.notes&&(t.notes=e.notes),e.label&&(t.label=e.label),e.tag&&(t.tag=e.tag),t}},{key:"createNodeLink",value:function(e,t){var r={id:this.newNodeId(),name:e,linkNodeId:t};return r}},{key:"createUnknownNode",value:function(e){var t={id:this.newNodeId(),name:e,unknown:!0};return t}},{key:"newNodeId",value:function(){return this.nodeSequence++}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(101),o=a(s),l=i.default.module("app.components.services.dices",[]).service("dicesService",o.default);t.default=l},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(){r(this,e)}return a(e,[{key:"rollDices",value:function(e,t,r){for(var a=0,n=0;n<e;n++)a+=this.randomIntInclusive(t,r);return a}},{key:"randomIntInclusive",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(103),o=a(s),l=i.default.module("app.components.services.form-helper",[]).service("formHelperService",o.default);t.default=l},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t){r(this,e),this.messagesService=t}return e.$inject=["messagesService"],a(e,[{key:"setErrorFieldsAsDirty",value:function(e,t){e.$invalid&&(t&&this.messagesService.errorMessage("Please complete mandatory fields",!1),angular.forEach(e.$error,function(e){angular.forEach(e,function(e){e.$setDirty()})}))}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(105),o=a(s),l=i.default.module("app.components.services.remote-json-retriever",[]).service("remoteJsonRetrieverService",o.default);t.default=l},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a){r(this,e),this.$http=t,this.$q=a}return e.$inject=["$http","$q"],a(e,[{key:"retrieveJson",value:function(e){var t=this.$q.defer();return this.$http.get(e).then(function(r){r&&r.data?t.resolve(r.data):t.reject("Cannot get data from "+e)},function(r){t.reject("Cannot get data from "+e)}),t.promise}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=r(107),o=a(s),l=i.default.module("app.components.gui.components.language-picker",[]).service("languagePickerService",o.default);t.default=l},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,a,n){r(this,e),this.gamePersistenceService=t,this.$translate=a,this.constants=n,this.supportedLanguages=this.initSupportedLanguages()}return e.$inject=["gamePersistenceService","$translate","constants"],a(e,[{key:"initSupportedLanguages",value:function(){for(var e=[],t=0;t<this.constants.supportedLanguages.length;t++)e.push({code:this.constants.supportedLanguages[t]});return e}},{key:"getSupportedLanguages",value:function(){return this.supportedLanguages}},{key:"getSelectedLanguage",value:function(){var e=this.gamePersistenceService.getSelectedLanguage();if(e)return e;if(navigator.language){var t=void 0;for(t=0;t<this.constants.supportedLanguages.length;t++)if(this.constants.supportedLanguages[t]===navigator.language)return this.constants.supportedLanguages[t];for(t=0;t<this.constants.supportedLanguages.length;t++)if(0===navigator.language.indexOf(this.constants.supportedLanguages[t]))return this.constants.supportedLanguages[t]}return this.constants.supportedLanguages[0]}},{key:"changeLanguage",value:function(e){this.$translate.use(e),this.gamePersistenceService.setSelectedLanguage(e);for(var t=0;t<this.supportedLanguages.length;t++)this.supportedLanguages[t].selected=this.supportedLanguages[t].code===e}}]),e}();t.default=n},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=a(n),s=i.default.module("app.components.constants",[]).constant("constants",{version:"20171106",supportedLanguages:["en","fr"],data:{selectedLanguage:"selectedLanguage",adventure:"adventure",game:"game",library:"library"},url:{administration:"/administration",games:"/games",gameDetail:"/{adventureId}/{paragraphNr}/game/{gameId}",credits:"/credits",adventureDetail:"/adventures",libraryImport:"/library-import"},choices:{yes:"Yes",no:"No",ok:"Ok",cancel:"Cancel",display:"Display",continue:"Continue",remove:"Remove",export:"Export",download:"Download",adventure:"Adventure",game:"Game",restart:"Restart",createGame:"Create a game"},errors:{adventureAlreadyExist:"error.adventureAlreadyExist",missingMandatoryFields:"error.missingMandatoryFields"}});t.default=s},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(110),i=a(n);r(111);var s=function(){return{template:i.default,restrict:"E"}};t.default=s},function(e,t){e.exports="<div ui-view></div>"},function(e,t,r){var a=r(112);"string"==typeof a&&(a=[[e.id,a,""]]);r(38)(a,{});a.locals&&(e.exports=a.locals)},function(e,t,r){t=e.exports=r(37)(),t.push([e.id,".ng-invalid.ng-dirty:required{background-color:#f99!important}.error{color:#f99}.modal{display:none;position:fixed;z-index:9999;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,.4)}.modal-content{background-color:#fefefe;margin:15% auto;padding:20px;border:1px solid #888;width:30%}.close{float:right}.close:focus,.close:hover{color:#000;text-decoration:none;cursor:pointer}",""])}]);
//# sourceMappingURL=bundle.js.map